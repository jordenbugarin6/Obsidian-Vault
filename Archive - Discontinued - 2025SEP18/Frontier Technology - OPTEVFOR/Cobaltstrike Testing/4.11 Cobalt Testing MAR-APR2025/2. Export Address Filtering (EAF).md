#### What is EAF
Export Address Filtering (EAF) is a security mitigation technique used to prevent exploits from resolving function addresses in a process’s Export Address Table (EAT). It is commonly used as part of exploit protection in tools like Microsoft’s Enhanced Mitigation Experience Toolkit (EMET) and Windows Defender Exploit Guard (WDEG).

-------
##### **How EAF Works**
1. **Monitors API Calls**: EAF monitors attempts to read function addresses from the EAT, which attackers often do to resolve key Windows APIs like `VirtualAlloc`, `LoadLibrary`, and `GetProcAddress`.
2. **Blocks Malicious Access**: If a suspicious process or shellcode tries to resolve critical API functions using known attack methods, EAF prevents it.
3. **Targets Common Exploitation Techniques**: Many exploits use Return-Oriented Programming (ROP) or shellcode that dynamically resolves APIs at runtime. EAF disrupts these techniques by blocking access to function pointers.

-----
##### **What EAF Does _Not_ Do**
- **It does NOT block direct API calls.** If a process already knows the function’s address (e.g., hardcoded or obtained through other means), it can still call `VirtualAlloc`.
- **It does NOT prevent syscalls.** Attackers can bypass API calls by using **direct syscalls** instead of going through the Windows API.
- **It does NOT prevent execution outright.** It’s more of a **mitigation technique** to make exploitation harder, rather than a full security barrier.

-------
##### **Bypassing EAF**
Since attackers know about EAF, they use various bypass methods, such as:
1. **Using hardcoded API addresses** instead of resolving them dynamically.
2. **Syscall stubs**: Avoiding API calls altogether by invoking system calls directly.
3. **NtQueryInformationProcess**: Leaking function addresses from a legitimate process.
4. **Handle inheritance**: Injecting into an existing process where function addresses are already resolved.
--------
##### What it actually looks like in Windows 11
- `4.11` added a new function to allow a built in bypass to this method of detection.
- From a `windows 11` perspective this `EAF` can be enabled to specifically target `.exe` files that could be malicious  -  ie i can set a setting to make `beacon_x64.exe` be monito
![[Pasted image 20250325170539.png]]