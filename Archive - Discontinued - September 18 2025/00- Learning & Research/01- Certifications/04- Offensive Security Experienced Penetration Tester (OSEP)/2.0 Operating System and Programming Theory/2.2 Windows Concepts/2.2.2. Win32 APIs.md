# Windows32 APIs
 > #osep #windows-internals #architecture #win32API

 ----------

- the windows operating system, and its various applications are written in a variety of programming languages ranging from assembly to c# but many of those make use of the windows-provided built-in `Application Programming Interfaces`  (or apis).
- these interfaces, known as the `win32 api`, offer developers pre-built functionality. the apis themselves are designed to be invoked from c and are documented with c-style data types but as we will discover throughout this course, they can be used with multiple other languages.\
-  many of the win32 apis are documented by microsoft. one simple example is the `GetUserNamea API` exported by `advapi32.dll` which retrieves the name of the user executing the function.
- the syntax section of the documentation shows the `function prototype` that details the number and type of arguments along with the return type:
```
BOOL GetUserNameA(
  LPSTR   lpBuffer,
  LPDWORD pcbBuffer
);
```
- in this example, the `API` requires two arguments. the first is an output buffer of type `LPSTR` which is the Microsoft term for a `character array`. the second argument is a pointer to a `DWORD` which is a `32-bit unsigned integer`. the return value from the api is a boolean.
- we will make extensive use of various `Win32 APIs` and their associated `Microsoft data types` throughout this course. as we use these apis we must keep in mind two particular details. first, we must determine if the process is `32-bit` or `64-bit` since some arguments and their size depend on the bitness. second, we must distinguish between the use of `ASCII`and `Unicode` (which microsoft sometimes refers to as `UTF-16`). since `ASCII` characters use `one byte` and `Unicode` uses `at least two`, many of the Win32 APIs are available in two distinct versions. 
-  the listing above shows the prototype for `GetUserNameA`, where the suffix`"A"` indicates the ASCII version of the API. the listing below shows the prototype for `GetUserNameW`, in which the `"W"` suffix (for "wide char") indicates Unicode:

```
BOOL GetUserNameW(
  LPWSTR  lpBuffer,
  LPDWORD pcbBuffer
);
```
- the first argument type is now of type `LPWSTR` which is a `UNICODE` character array.
- we will be using the Win32 APIs extensively in this course.