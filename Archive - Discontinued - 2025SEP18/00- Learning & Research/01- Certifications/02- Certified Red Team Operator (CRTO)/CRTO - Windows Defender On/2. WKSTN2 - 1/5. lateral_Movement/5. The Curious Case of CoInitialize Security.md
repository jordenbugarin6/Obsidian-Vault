
*If need to understand this better feel free to look at the CRTO course*

In my understanding for `WMI` uses `cobalt strike's` `beacon` function uses `Beacon Object Files` (BOF's) to execute the  `beacon_inline_exectue` function which essentially just executes the `BOF's`  when a `BOF` is executed the `CoInitializeSecurity`.COM object is called which can only be called once per proces.

The issue lies if one user has already called on `CoInitializeSecurity` by using a BOF, in this case `bfarmer` has already called a `BOF`. Then `ANY` other user may not be able to call anything with `wmi`
This was used on `WKSTN-2 bfarmer` got issue because `DEV\jking` is already utilizing this.
![[Pasted image 20231129121719.png]]
To work around the `WMI execution` process it needs to come from a different process. this can be fixed with the commands `spawn` `spawnas` or `execute-assembly` with the use of `SharpWMI` as shown below

`execute-assembly C:\Tools\SharpWMI\SharpWMI\bin\Release\SharpWMI.exe action=exec computername=web.dev.cyberbotic.io command="C:\Windows\smb_x64.exe`
this command allows execution of `smb_x64.exe` which then i believe we just connect to the process after creating it
![[Pasted image 20231129121906.png]]
not sure how to connect to the process tho. course doesn't show