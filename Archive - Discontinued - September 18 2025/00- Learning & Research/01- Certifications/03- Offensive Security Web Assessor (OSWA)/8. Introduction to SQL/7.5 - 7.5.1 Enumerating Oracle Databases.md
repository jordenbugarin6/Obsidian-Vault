This Learning Unit covers the following Learning Objectives:

1. Understand how to identify the version of an Oracle database
2. Understand how to identify the current user of an Oracle database
3. Understand how to identify other users or schemas in an Oracle database
4. Understand how to identify the tables within a schema in an Oracle database
5. Understand how to identify the column names and data types in a table in an Oracle database

------------------

#### 7.5.1. Oracle Specific Tables

Of the database software we are reviewing in this Learning Module, Oracle DB is perhaps the most different from the others. It uses the same SQL syntax for basic queries, but there are many idiosyncrasies we need to manage when working with functions or data about the database itself.

We can obtain the necessary Oracle database version from the _v$version_ table.

***When executing these queries in the SQL Console, do not include the semicolon at the end of the query.***

Getting the version of an Oracle database
```sql
SQL> select * from v$version;

BANNER
--------------------------------------------------------------------------------
Oracle Database 11g Express Edition Release 11.2 - 64bit Production
PL/SQL Release 11.2 - Production
CORE	11.2 Production
TNS for Linux: Version 11.2 - Production
NLSRTL Version 11.2 - Production

SQL
```
![[Pasted image 20240815214804.png]]
We can obtain the user account currently connected to an Oracle database by selecting the _USER_ function. However, Oracle database requires a FROM clause with any SELECT statement. Oracle databases always include a table named _DUAL_.[1](https://portal.offsec.com/courses/web-200-28380/learning/introduction-to-sql-30959/enumerating-oracle-databases-31297/oracle-specific-tables-31035#fn-local_id_921-1) This table has one column named "DUMMY" and one row with value "X". When working with an Oracle database, and we need to select static values or data from functions, we can include from DUAL to create a syntactically-valid query. As with the other databases we have reviewed, this function will return the user account for the database, which does not necessarily correspond to an OS-level user.

Getting the user connected to an Oracle database
```sql
SQL> select user from dual;

USER
------------------------------
SYSTEM
```
![[Pasted image 20240815214933.png]]
Oracle databases create a schema for each user. In this context, a schema is essentially a set of tables, views, and other database objects. Each schema carries its own set of permissions that can enable users to access data in other schemas.

Since the database creates a schema for each user, we can obtain a list of schemas by querying for the users in the _all_tables_ table.

Getting a list of users or schemas
```sql
SQL> select owner from all_tables group by owner;

OWNER
------------------------------
MDSYS
OUTLN
CTXSYS
HR
FLOWS_FILES
SQLMAP
SYSTEM
APEX_040000
XDB
SYS

10 rows selected.
```
![[Pasted image 20240815215059.png]]
By including GROUP BY owner in our query, we limited our results to a distinct list of user names. This table contains a row for every table in the database. We can query the _table_name_ column on this table with a WHERE clause to retrieve the tables in a particular schema.

Getting a list of tables within a schema
```sql
SQL> select table_name from all_tables where owner = 'SYS' order by table_name;

TABLE_NAME
------------------------------
ACCESS$
ALERT_QT
APPLY$_CHANGE_HANDLERS
APPLY$_CONF_HDLR_COLUMNS
APPLY$_CONSTRAINT_COLUMNS
APPLY$_DEST_OBJ
APPLY$_DEST_OBJ_CMAP
...
MAP_SUBELEMENT$
MENU
METAFILTER$
...
939 rows selected.
```
![[Pasted image 20240815215327.png]]
![[Pasted image 20240815215350.png]]
Oracle databases include many system tables with a dollar sign ($) in their name. However, there is nothing preventing a user from creating their own table with a dollar sign in the table's name. This means we can safely assume that all system tables include a dollar sign, but not all tables with a dollar sign are system tables.

After identifying the tables in a schema, we'll want to identify the column names for the tables we are interested in. The _all_tab_columns_ table contains information about the columns of all tables in the database. We can query this table to learn more about an unknown database.

Getting a list of columns and their data type in a table in Oracle DB
```sql
SQL> select column_name, data_type from all_tab_columns where table_name = 'MENU';

COLUMN_NAME        DATA_TYPE
-----------------------------------------
ID                 NUMBER
NAME               VARCHAR2
DESCRIPTION        VARCHAR2
PRICE              NUMBER
```
![[Pasted image 20240815215539.png]]
The more we know about the column names and _data types_[2](https://portal.offsec.com/courses/web-200-28380/learning/introduction-to-sql-30959/enumerating-oracle-databases-31297/oracle-specific-tables-31035#fn-local_id_921-2) of the table we're attempting to extract, the easier exfiltration will be.

This section is by no means exhaustive, but it offers foundational information needed to enumerate unknown Oracle databases.


(Oracle, 2021), [https://docs.oracle.com/cd/B19306_01/server.102/b14200/queries009.htm](https://docs.oracle.com/cd/B19306_01/server.102/b14200/queries009.htm) [↩︎](https://portal.offsec.com/courses/web-200-28380/learning/introduction-to-sql-30959/enumerating-oracle-databases-31297/oracle-specific-tables-31035#fnref-local_id_921-1)
(Wikipedia, 2021), [https://en.wikipedia.org/wiki/SQL#SQL_data_types](https://en.wikipedia.org/wiki/SQL#SQL_data_types) [↩︎](https://portal.offsec.com/courses/web-200-28380/learning/introduction-to-sql-30959/enumerating-oracle-databases-31297/oracle-specific-tables-31035#fnref-local_id_921-2)

##### Labs
1. `11.2.0.2.0`
![[Pasted image 20240815215752.png]]
```sql
select * from v$version
```
![[Pasted image 20240815214804.png]]

2. `OS{ButItIsHiddenAndSecret!}`
![[Pasted image 20240815220905.png]]
Utilized the `sql query` below with teh help of the exercise follow through to identify that `HIDDENSECRETTABLE` exists 
```sql
select column_name, data_type from all_tab_columns where table_name = 'HIDDENSECRETTABLE'
```
Queried the table
![[Pasted image 20240815220043.png]]
Now we just have to figure out how to grab the flag by identifying the full `path` essentially
```sql
SELECT OWNER, TABLE_NAME from ALL_TABLES
```
![[Pasted image 20240815220317.png]]
`CTRL+F` shows that the `hidden` table that we are looking for is owned by `sys`
![[Pasted image 20240815220411.png]]
So now with the information we no - `user` and `table` name we should be able to grab the flag. I guess in `ORACLE` you only need the table name and user who it is owned by in order to look at the column contents
```sql
SELECT flag FROM SYS.HIDDENSECRETTABLE
```
![[Pasted image 20240815220634.png]]
OR
```sql
SELECT * FROM SYS.HIDDENSECRETTABLE
```
![[Pasted image 20240815220744.png]]