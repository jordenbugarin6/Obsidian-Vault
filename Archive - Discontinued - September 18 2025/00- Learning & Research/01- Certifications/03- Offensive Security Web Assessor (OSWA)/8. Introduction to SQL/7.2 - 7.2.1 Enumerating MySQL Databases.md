This Learning Unit covers the following Learning Objectives:

1. Understand how to identify the version of a MySQL database
2. Understand how to identify the current user of a MySQL database
3. Understand how to identify the schemas within a MySQL database
4. Understand how to identify the tables within a schema in a MySQL database
5. Understand how to identify the column names and data types in a table in a MySQL database

-------------------
#### 7.2.1. MySQL Specific Functions and Tables

While the following commands are specific to MySQL, many of them will also work on _MariaDB_,[1](https://portal.offsec.com/courses/web-200-28380/learning/introduction-to-sql-30959/enumerating-mysql-databases-31312/enumerating-mysql-databases-31487#fn-local_id_198-1) an open-source fork of MySQL.
We can use the `version()` function to retrieve the version of a MySQL database.

```mysql
mysql> select version();
+-----------+
| version() |
+-----------+
| 5.7.28    |
+-----------+
1 row in set (0.00 sec)
```
Getting the version of a MySQL database
![[Pasted image 20240815170616.png]]
We can obtain the user account currently connected to a MySQL database with the `current_user()` or `system_user()` functions. We should keep in mind that this is a user account for the database, and does not necessarily correspond to an OS-level user.
```mysql
mysql> select current_user();
+----------------+
| current_user() |
+----------------+
| user@%         |
+----------------+
1 row in set (0.00 sec)
```
Getting the user connected to a MySQL database
![[Pasted image 20240815170758.png]]
MySQL segments tables into different databases, synonymous with schemas. Databases can be user-defined; however, MySQL stores information about itself in the _information_schema_ database. If we are able to execute arbitrary SQL, we can retrieve the names of the databases by using show databases;.

For cases in which we need to extract information with a SELECT statement, we can query the _tables_ table in the _information_schema_. In this example, we included a GROUP BY clause to return only one record for each unique value in the _table_schema_ column.

```mysql
mysql> select table_schema from information_schema.tables group by table_schema;
+--------------------+
| table_schema       |
+--------------------+
| information_schema |
| app                |
| exercise           |
| mysql              |
| performance_schema |
| sqlmap             |
| sys                |
+--------------------+
7 rows in set (0.00 sec)
```
Getting a list of databases or schemas
![[Pasted image 20240815170916.png]]
We can query the same table to retrieve a list of the tables in a specific database.
```mysql
mysql> select table_name from information_schema.tables where table_schema = 'app';
+------------+
| table_name |
+------------+
| flags      |
| hiddenTable|
| menu       |
| users      |
+------------+
3 rows in set (0.00 sec)
```
Getting a list of tables in a database or schema
![[Pasted image 20240815171111.png]]
If we can execute arbitrary SQL, we can obtain the same information with `SHOW TABLES;`. However, this command will only list the tables in the current schema or database.
![[Pasted image 20240815171237.png]]
The _columns_ table in the _information_schema_ contains information about the columns of all tables in the database. We can query this table to learn more about an unknown database.
```mysql
mysql> select column_name, data_type from information_schema.columns where table_schema = 'app' and table_name = 'menu';
+-------------+-----------+
| column_name | data_type |
+-------------+-----------+
| id          | int       |
| name        | varchar   |
| description | varchar   |
| price       | decimal   |
+-------------+-----------+
4 rows in set (0.00 sec)
```
![[Pasted image 20240815171403.png]]
Although this section is by no means exhaustive, it serves as a foundation for enumerating unknown MySQL and MariaDB databases. Next, we'll explore Microsoft SQL Server enumeration.

(MariaDB Foundation, 2021), [https://mariadb.org/](https://mariadb.org/) [↩︎](https://portal.offsec.com/courses/web-200-28380/learning/introduction-to-sql-30959/enumerating-mysql-databases-31312/mysql-specific-functions-and-tables-30987#fnref-local_id_198-1)

##### Labs
1. `5.7.35`
![[Pasted image 20240815171655.png]]
![[Pasted image 20240815170616.png]]
2. `OS{ooooh_a_hidden_table!}`
![[Pasted image 20240815172156.png]]
```mysql
SELECT * FROM hiddenTable;
```
![[Pasted image 20240815172236.png]]

test')) UNION SELECT flag, NULL, NULL, NULL from secrets --+