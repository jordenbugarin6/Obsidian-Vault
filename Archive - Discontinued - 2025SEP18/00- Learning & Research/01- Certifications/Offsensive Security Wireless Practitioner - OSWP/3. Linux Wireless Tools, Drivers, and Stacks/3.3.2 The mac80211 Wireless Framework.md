As Wi-Fi evolved and became more complex, the mac80211[1](https://portal.offsec.com/courses/pen-210-9545/learning/linux-wireless-tools,-drivers,-and-stacks-15799/wireless-stacks-and-drivers-15860/the-mac80211-wireless-framework-15996#fn-local_id_63-1) framework was introduced. Mac80211 centralizes a lot of the common code, and has been more flexible to handle newer wireless technologies and differences between chipsets.

The mac80211 wireless framework is included in all modern Linux kernels. Under mac80211, most common functions are standardized. This means that the wireless drivers don't need to re-implement them.

Standardizing the functions led to both new improvements and new requirements. Here is a list of some of those changes:

- Support for 802.11n, 802.11ac, and other modes is built-in.
- WEP and WPA support is provided via wpa_supplicant,[2](https://portal.offsec.com/courses/pen-210-9545/learning/linux-wireless-tools,-drivers,-and-stacks-15799/wireless-stacks-and-drivers-15860/the-mac80211-wireless-framework-15996#fn-local_id_63-2) the de-facto tool to connect to wireless networks.
- Common Regulatory Domain with Central Regulatory Domain Agent (CRDA) enforces the different regulations regarding wireless communications in countries around the world (frequencies limitations, output power, and others).
- Master mode (also known as Access Point mode) requires _Host access point daemon_ (hostapd).[3](https://portal.offsec.com/courses/pen-210-9545/learning/linux-wireless-tools,-drivers,-and-stacks-15799/wireless-stacks-and-drivers-15860/the-mac80211-wireless-framework-15996#fn-local_id_63-3)
- The iw command is used to manipulate the wireless interface settings instead of iwconfig, iwpriv, iwlist, and iwspy.
- The process of switching wireless modes is now standardized across all devices/drivers.
- Wireless interfaces have a common naming convention of "wlan" followed by one or two digits.
- All functions for the different modes (managed, master, monitor, mesh, etc.) are available for drivers, but not all chipsets support them.

We can't possibly list all of the changes and features in mac80211 or go into detail here. Refer to the Linux Wireless website[5](https://portal.offsec.com/courses/pen-210-9545/learning/linux-wireless-tools,-drivers,-and-stacks-15799/wireless-stacks-and-drivers-15860/the-mac80211-wireless-framework-15996#fn-local_id_63-5) for more on this topic.

Let's continue our discussion of mac80211 by talking about some of the software libraries[6](https://portal.offsec.com/courses/pen-210-9545/learning/linux-wireless-tools,-drivers,-and-stacks-15799/wireless-stacks-and-drivers-15860/the-mac80211-wireless-framework-15996#fn-local_id_63-6) it interacts with. mac80211 is actually part of a larger group of software libraries that includes nl80211 and cfg80211.

nl80211[7](https://portal.offsec.com/courses/pen-210-9545/learning/linux-wireless-tools,-drivers,-and-stacks-15799/wireless-stacks-and-drivers-15860/the-mac80211-wireless-framework-15996#fn-local_id_63-7) is the NetLink library dedicated for 802.11, and it helps tools such as wpa_supplicant, hostapd, iw, Wireshark, aircrack-ng, and other packet capture tools to communicate and interact with the drivers in the kernel, through cfg80211. We will discuss these tools later on.

cfg80211[8](https://portal.offsec.com/courses/pen-210-9545/learning/linux-wireless-tools,-drivers,-and-stacks-15799/wireless-stacks-and-drivers-15860/the-mac80211-wireless-framework-15996#fn-local_id_63-8) is part of the Linux kernel. It is the configuration API for 802.11 and interacts directly with FullMAC[9](https://portal.offsec.com/courses/pen-210-9545/learning/linux-wireless-tools,-drivers,-and-stacks-15799/wireless-stacks-and-drivers-15860/the-mac80211-wireless-framework-15996#fn-local_id_63-9) drivers and through mac80211 with SoftMAC drivers.

FullMAC drivers are fully integrated wireless chipsets, such as those in smartphones, with many of the wireless functions built-in to the hardware itself. Only a minimal driver is necessary.

SoftMAC on the other hand, are for simple radios and require more complex drivers. cfg80211 also interacts with the regulatory domain, CRDA, which we will discuss later on. Finally, mac80211 implements all the wireless functions needed for the SoftMAC radio to operate the different wireless modes.

The following diagram[10](https://portal.offsec.com/courses/pen-210-9545/learning/linux-wireless-tools,-drivers,-and-stacks-15799/wireless-stacks-and-drivers-15860/the-mac80211-wireless-framework-15996#fn-local_id_63-10) shows how these libraries interact together.

![[Pasted image 20250415173726.png]]
In wireless, we have the MAC Sublayer Management Entity (MLME), which takes care of the following management operations:

- Authentication
- Deauthentication
- Association
- Disassociation
- Reassociation
- Beaconing

FullMAC have all MLME operations (or a subset of the above) done by the wireless hardware itself and its firmware. An advantage of FullMAC is that it improves power consumption, which is critical on mobile chipsets and other low power computing devices. It also gives more control from vendors over what operations can be done using their hardware. It does, however, comes at a cost. Wi-Fi operations are complex and so is their code base. No implementation is exempt from bugs.[13](https://portal.offsec.com/courses/pen-210-9545/learning/linux-wireless-tools,-drivers,-and-stacks-15799/wireless-stacks-and-drivers-15860/the-mac80211-wireless-framework-15996#fn-local_id_63-13)

For SoftMAC devices, everything is implemented in the software of the driver's framework. All SoftMAC drivers using mac80211 will benefit from security fixes, improvements, and other bugs fixed with the framework. With Linux kernel releases or when a Linux distribution releases security fixes, all SoftMAC drivers are updated. FullMAC drivers, on the other hand, require their respective vendors to release fixes.