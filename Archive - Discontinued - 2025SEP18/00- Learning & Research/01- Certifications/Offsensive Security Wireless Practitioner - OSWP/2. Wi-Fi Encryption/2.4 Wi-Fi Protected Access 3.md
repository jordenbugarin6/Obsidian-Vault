
Simultaneous Authentication of Equals (SAE) replaces PSK in WPA personal, which is the same encryption used in mesh networks (802.11s). It is a variant of Dragonfly. In WPA3-only mode, PMF is mandatory. In transition mode, mixed WPA2 and WPA3, PMF is optional in WPA2 and mandatory when establishing a connection in WPA3.

WPA Enterprise gets a 192-bit mode with stronger security protocols. Authentication and encryption will use GCMP-256. Key derivation and confirmation use HMAC-SHA384. Key establishment and authentication use ECDHE and ECDSA using a 384-bit elliptic curve.

WPA3 doesn't use any newer encryption algorithm, but now AES is the only cipher allowed.

Where WPA/WPA2 (as well as Open networks and WEP) has a simple authentication and association phase, before the 4-way handshake, the authentication phase is reworked and this is where the Dragonfly handshake happens.

There are two phases, or exchanges in the authentication phase. First, a commit exchange followed by a confirm exchange.

In the commit exchange, both sides commit to a shared secret. In the confirm exchange, they confirm they both share the same password and then derive a PMK that will be then used in the 4-way exchange.

SAE offers a better way to establish a secure connection by using a Diffie-Hellman (DH) key exchange with an Elliptic Curve or a Prime Modulus.

The following is the list of the different groups for the Diffie-Hellman Exchange:

|Number|Name|
|---|---|
|0|NONE|
|1|768-bit MODP Group|
|2|1024-bit MODP Group|
|3-4|Reserved|
|5|1536-bit MODP Group|
|6-13|Unassigned|
|14|2048-bit MODP Group|
|15|3072-bit MODP Group|
|16|4096-bit MODP Group|
|17|6144-bit MODP Group|
|18|8192-bit MODP Group|
|19|256-bit random ECP group|
|20|384-bit random ECP group|
|21|521-bit random ECP group|
|22|1024-bit MODP Group with 160-bit Prime Order Subgroup|
|23|2048-bit MODP Group with 224-bit Prime Order Subgroup|
|24|2048-bit MODP Group with 256-bit Prime Order Subgroup|
|25|192-bit Random ECP Group|
|26|224-bit Random ECP Group|
|27|brainpoolP224r1|
|28|brainpoolP256r1|
|29|brainpoolP384r1|
|30|brainpoolP512r1|
|31|Curve25519|
|32|Curve448|
|33-1023|Unassigned|
|1024-65535|Reserved for Private Use|

The bare minimum requires all implementations to support group 19.

While all of them could be used, only the groups 15 to 21 are suitable for production due to security reasons. These groups have a prime with 3072 bits and above for FFC and a 256 bits prime and above when it is ECC.

![Figure 14: WPA3 authentication](https://static.offsec.com/offsec-courses/PEN-210/images/Encryption/9ed5c430c3b451f72cb73fa0d6f45196-Picture13.png)

Figure 14: WPA3 authentication

## 2.5. Opportunistic Wireless Encryption