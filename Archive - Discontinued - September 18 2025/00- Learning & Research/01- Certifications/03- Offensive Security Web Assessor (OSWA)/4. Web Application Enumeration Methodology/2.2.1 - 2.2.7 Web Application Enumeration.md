###### Links:
[[02- nmap|02- nmap]]
[[02- nmap|Ping]]
[[03- curl (Banner Grabbing)]]


-----------

- Understand How to Discover Running Services
- Learn How to Discover HTTP Endpoints
- Review Error Messages for Information Disclosure
- Understand How to Identify Outdated Components

Attempt to discover any running services and their software versions. We'll likely spend most of our time exploring the web application. We can use automated tools to crawl the site or manually explore the site in a browser.

During enumeration, we may encounter error messages. These messages can provide additional information about the application, its running state, and the underlying server. As we gather information about the application, we'll also want to check for any outdated components that may contain vulnerabilities.

#### /etc/hosts `enum-sandbox` modification
- utilized `mousepad` tool to add `192.168.187.108` as `enum-sandbox`
![[Pasted image 20240715133431.png]]
got IP address from:
![[Pasted image 20240715161933.png]]
##### Enumeration
`ping enum-sandbox` to ensure that the machine is up
![[Pasted image 20240715162055.png]]
`nmap -Pn enum-sandbox` to skip ICMP host discovery since we did a prior ping to ensure that the box was already up
![[Pasted image 20240715162225.png]]
`nmap -sV enum-sandbox`  for service/version detection
- Nmap identified PostgreSQL running on port 5555 instead of providing a default value of "freeciv"
![[Pasted image 20240715162443.png]]
`nmap -p 80 --script http-methods enum-sandbox`  futilizing NSE scripts (written in LUA) to identify http-methods
![[Pasted image 20240715163258.png]]
##### Labs
![[Pasted image 20240715163528.png]]

![[Pasted image 20240715163434.png]]

We can manually identify services and software versions of exposed ports with [_banner grabbing_](https://csrc.nist.gov/glossary/term/banner_grabbing).

--------------------------------------------------
#### 2.2.3 HTTP Banner grabbing
We can manually identify services and software versions of exposed ports with [_banner grabbing_](https://csrc.nist.gov/glossary/term/banner_grabbing).

`curl -I http://enum-sandbox` manual banner grabbing `HTTP` protocols
- able to identify the version of the server
- When using curl, we can use the **-i** or **--include** options to include response headers in the output. If we only want the headers, we can use **-I** or **--head**.
![[Pasted image 20240715164536.png]]
`-i` presents the longer output
![[Pasted image 20240715164719.png]]
#### Non-HTTP Banner grabbing
`netcat -v enum-sandbox 22` to grab version of ssh running
![[Pasted image 20240715164956.png]]
##### Labs
`curl -i http://enum-sandbox/banners`
![[Pasted image 20240715165445.png]]
![[Pasted image 20240715165403.png]]
`curl -i http://enum-sandbox/bannersExercise`
![[Pasted image 20240715165621.png]]
![[Pasted image 20240715165712.png]]

--------------------------------------------------
#### 2.2.4 Manual HTTP Endpoint Discovery
Exploring a web application is also an important part of enumeration. We need to get a sense of what the web application does and how we can interact with it. We're most interested in [_forms_](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/form) or other ways we can submit information so that the application processes our data. Most web application vulnerabilities occur from mishandling or misinterpreting the data sent by an attacker.

 Web developers use [_robots.txt_](https://developer.mozilla.org/en-US/docs/Glossary/Robots.txt) to instruct [_web crawlers_](https://developer.mozilla.org/en-US/docs/Glossary/Crawler) on what portions of the website they can crawl. [_XML sitemaps_](https://developers.google.com/search/docs/crawling-indexing/sitemaps/build-sitemap#xml) are an alternative to robots.txt and provide additional information about the site, such as the last time a page was modified.

We can think of these files as "Keep Out" signs for web crawlers. As attackers, we should investigate any URLs included in these files to identify potentially sensitive functionality.

##### Labs
![[Pasted image 20240715171531.png]]
- Browsed using `burpsuites` built in browser to identify flag
- Also able to view flag in `GET` request
![[Pasted image 20240715171322.png]]
![[Pasted image 20240715171459.png]]
![[Pasted image 20240715171610.png]]
- Browsed to `http://enum-sandbox/manual/testimonials` - profit
![[Pasted image 20240715171726.png]]
![[Pasted image 20240715171817.png]]

--------------------------------------------------
#### 2.2.5 Automated HTTP Endpoint Discovery
While manually browsing a website allows us to gain an understanding of the site's purpose and functionality, it can take a lot of time to fully explore a large site. We can use automated tools to provide broad coverage and discovery, while leveraging manual exploration to focus on depth.

`echo "http://enum-sandbox" | hakrawler -u` is used as an automated gobuster that is quick, the `-u` option only shows unique instances - not repeated instances.
#hakrawler
We could redirect the output to a file to save the results. We could also run Hakrawler with the **-proxy** option to proxy the requests through another tool.
![[Pasted image 20240715184855.png]]
`dirb http://enum-sandbox` DIRB missed several of the URLs discovered by Hakrawler. However, it found `http://enum-sandbox/server-status`, which Hakrawler didnt find
- its good to run multiple web crawlers
- `dirb`'s default wordlist is **/usr/share/dirb/wordlists/common.txt**
- the `-X` option allows for specific file types
![[Pasted image 20240715185649.png]]
Other locations of word lists `/usr/share/wordlists`
![[Pasted image 20240715185402.png]]
##### Labs
![[Pasted image 20240715190303.png]]
Found from utilizing `dirb http://enum-sandbox/automated/`
![[Pasted image 20240715190409.png]]
![[Pasted image 20240715190448.png]]

--------------------------------------------------
#### 2.2.6 Information Disclosure
As we enumerate a web application, we might encounter error messages as a result of submitting various data. Depending on what information the application returns in error messages, we might be able to learn or infer useful information.

Let's check how the application responds to a failed login attempt. We'll type "foo" in the _Username_ field and "bar" in the _Password_ field, then click _Login_.
![[Pasted image 20240715191828.png]]
Our login failed, as we expected, and the page includes the error message "No matching user found". This login functionality might allow us to enumerate valid usernames if valid and invalid usernames return different responses. We could even leverage information we found while manually exploring to guide our attempts.

In some cases, we might need to [_fuzz_](https://owasp.org/www-community/Fuzzing) the application to generate error messages. Fuzzing typically uses automated tools to generate a large volume of semi-random data and send it to the target application or API. When fuzzing, our goal is to observe how the application responds to the unexpected input. We are trying to identify [_edge cases_](https://www.cs.cmu.edu/~rjsimmon/15122-s13/rec/07.pdf) where the application leaks information or behaves in a way that its developers didn't intend in order to subvert the application's normal logic.

There are several fuzzing tools included in Kali Linux by default, such as [_Wfuzz_](https://www.edge-security.com/wfuzz.php) and [_ffuf_](https://github.com/ffuf/ffuf). These two tools are similar.

When we fuzz applications, we need to be aware of how much noise we're making from a network detection perspective and how we might impact the application. If our fuzzing requests are too fast or frequent, we might cause a [_denial of service_](https://www.cloudflare.com/learning/ddos/glossary/denial-of-service/) (DOS). Similarly, fuzzing login forms with valid usernames and invalid passwords might cause the application to lock out accounts.

In burpsuite navigating to `http://enum-sandbox/auth/login` to identify the `Content-Type` field used to fill out the `FFUF` command

`ffuf -w users.txt -u http://enum-sandbox/auth/login -X POST -d 'username=FUZZ&password=bar' -H 'Content-Type: application/x-www-form-urlencoded'`
![[Pasted image 20240715192949.png]]
##### Labs
- Was unable to complete this lab, pulled credentials from `http://megacorpone.com` and `http://enum-sandbox/manual/about`
![[Pasted image 20240717162751.png]]
Taking credentials from `http://megacorpone.com` website
![[Pasted image 20240715192208.png]]
![[Pasted image 20240715210925.png]]
`http://enum-sandbox/manual/about`
![[Pasted image 20240715212913.png]]
making a wordlist called `users.txt` with the users below:
- joe sheer
- tom hudson
- tanya rivera
- matt smith
- mike carlow
- alan grofield
- roxanne jones
- ernesto freeman
###### users.txt
```bash
foo
tjones
tomjones
tom.jones
t.jones
tom_jones
t_jones
joe
jsheer
joesheer
joe.sheer
j.sheer
joe_sheer
j_sheer
mike
mcarlow
mikecarlow
mike.carlow
m.carlow
mike_carlow
m_carlow
alan
agrofield
alangrofield
alan.grofield
a.grofield
alan_grofield
a_grofield
tom
thudson
tomhudson
tom.hudson
t.hudsom
tom_hudson
t_hudson
tanya
trivera
tanyarivera
t.rivera
tanya_revera
t_rivera
matt
msmith
mattsmith
m.smith
matt_smith
m_smith
roxanne
roxannejones
rjones
r.jones
roxanne_jones
r_jones
ernesto
ernestofreeman
efreeman
e.freeman
ernesto_freeman
e_freeman
```
###### usernames.py
utilized the pattern in the course and `chatgpt` to create a python script to make a script that ingests names and spits out random combinations with `usernames.py`
```python
names = [
    "Ernesto Freeman",
    "Jane Smith",
    "Alice Johnson",
    "joe sheer",
    "tom hudson",
    "tanya rivera",
    "matt smith",
    "mike carlow",
    "alan grofield",
    "roxanne jones",
    "ernesto freeman",
    # Add more names here
]

usernames = []

for name in names:
    first_name, last_name = name.split()
    first_initial = first_name[0].lower()
    last_initial = last_name[0].lower()
    
    usernames.extend([
        first_name.lower(),  # ernesto
        first_name.lower() + last_name.lower(),  # ernestofreeman
        first_initial + last_name.lower(),  # efreeman
        first_initial + '.' + last_name.lower(),  # e.freeman
        first_name.lower() + '_' + last_name.lower(),  # ernesto_freeman
        first_initial + '_' + last_name.lower(),  # e_freeman
        last_name.lower() + first_initial,  # freemane
        last_name.lower() + '.' + first_initial,  # freeman.e
        last_name.lower() + first_name.lower(),  # freemanernesto
        first_name.lower() + '.' + last_name.lower(),  # ernesto.freeman
        first_initial + last_initial,  # ef
        first_initial + '_' + last_initial,  # e_f
        first_name.lower() + last_initial,  # ernestof
        first_name.lower() + '.' + last_initial,  # ernesto.f
        first_name.lower() + '-' + last_name.lower(),  # ernesto-freeman
        first_initial + '-' + last_name.lower(),  # e-freeman
        last_name.lower() + '-' + first_initial,  # freeman-e
        last_name.lower() + '_' + first_initial,  # freeman_e
        first_name.lower() + last_name.lower()[0],  # ernestof
        first_name.lower() + '-' + last_initial,  # ernesto-f
        last_name.lower() + '.' + first_initial,  # freeman.e
        first_initial + last_initial + first_name.lower(),  # ef_ernesto
        first_initial + last_initial + '.' + first_name.lower(),  # ef.ernesto
        last_name.lower() + '_' + first_initial + last_initial,  # freeman_ef
        last_name.lower() + '.' + first_initial + last_initial,  # freeman.ef
        first_name.lower() + last_name.lower(),  # ernestofreeman
        first_initial + last_name.lower(),  # efreeman
        first_name.lower() + '.' + last_name.lower(),  # ernesto.freeman
        first_name.lower() + '-' + last_name.lower(),  # ernesto-freeman
        first_name.lower() + last_initial + '1',  # ernestof1
        first_name.lower() + last_name.lower() + '123',  # ernestofreeman123
    ])

with open("usernames.txt", "w") as f:
    for username in usernames:
        f.write(username + "\n")

```
###### usernames.txt results

```bash
┌──(kali㉿gobots)-[17Jul2024 20:22:47]-[~/SUT/OSWA]
└─$ cat usernames.txt
ernesto
ernestofreeman
efreeman
e.freeman
ernesto_freeman
e_freeman
freemane
freeman.e
freemanernesto
ernesto.freeman
ef
e_f
ernestof
ernesto.f
ernesto-freeman
e-freeman
freeman-e
freeman_e
ernestof
ernesto-f
freeman.e
efernesto
ef.ernesto
freeman_ef
freeman.ef
ernestofreeman
efreeman
ernesto.freeman
ernesto-freeman
ernestof1
ernestofreeman123
jane
janesmith
jsmith
j.smith
jane_smith
j_smith
smithj
smith.j
smithjane
jane.smith
js
j_s
janes
jane.s
jane-smith
j-smith
smith-j
smith_j
janes
jane-s
smith.j
jsjane
js.jane
smith_js
smith.js
janesmith
jsmith
jane.smith
jane-smith
janes1
janesmith123
alice
alicejohnson
ajohnson
a.johnson
alice_johnson
a_johnson
johnsona
johnson.a
johnsonalice
alice.johnson
aj
a_j
alicej
alice.j
alice-johnson
a-johnson
johnson-a
johnson_a
alicej
alice-j
johnson.a
ajalice
aj.alice
johnson_aj
johnson.aj
alicejohnson
ajohnson
alice.johnson
alice-johnson
alicej1
alicejohnson123
joe
joesheer
jsheer
j.sheer
joe_sheer
j_sheer
sheerj
sheer.j
sheerjoe
joe.sheer
js
j_s
joes
joe.s
joe-sheer
j-sheer
sheer-j
sheer_j
joes
joe-s
sheer.j
jsjoe
js.joe
sheer_js
sheer.js
joesheer
jsheer
joe.sheer
joe-sheer
joes1
joesheer123
tom
tomhudson
thudson
t.hudson
tom_hudson
t_hudson
hudsont
hudson.t
hudsontom
tom.hudson
th
t_h
tomh
tom.h
tom-hudson
t-hudson
hudson-t
hudson_t
tomh
tom-h
hudson.t
thtom
th.tom
hudson_th
hudson.th
tomhudson
thudson
tom.hudson
tom-hudson
tomh1
tomhudson123
tanya
tanyarivera
trivera
t.rivera
tanya_rivera
t_rivera
riverat
rivera.t
riveratanya
tanya.rivera
tr
t_r
tanyar
tanya.r
tanya-rivera
t-rivera
rivera-t
rivera_t
tanyar
tanya-r
rivera.t
trtanya
tr.tanya
rivera_tr
rivera.tr
tanyarivera
trivera
tanya.rivera
tanya-rivera
tanyar1
tanyarivera123
matt
mattsmith
msmith
m.smith
matt_smith
m_smith
smithm
smith.m
smithmatt
matt.smith
ms
m_s
matts
matt.s
matt-smith
m-smith
smith-m
smith_m
matts
matt-s
smith.m
msmatt
ms.matt
smith_ms
smith.ms
mattsmith
msmith
matt.smith
matt-smith
matts1
mattsmith123
mike
mikecarlow
mcarlow
m.carlow
mike_carlow
m_carlow
carlowm
carlow.m
carlowmike
mike.carlow
mc
m_c
mikec
mike.c
mike-carlow
m-carlow
carlow-m
carlow_m
mikec
mike-c
carlow.m
mcmike
mc.mike
carlow_mc
carlow.mc
mikecarlow
mcarlow
mike.carlow
mike-carlow
mikec1
mikecarlow123
alan
alangrofield
agrofield
a.grofield
alan_grofield
a_grofield
grofielda
grofield.a
grofieldalan
alan.grofield
ag
a_g
alang
alan.g
alan-grofield
a-grofield
grofield-a
grofield_a
alang
alan-g
grofield.a
agalan
ag.alan
grofield_ag
grofield.ag
alangrofield
agrofield
alan.grofield
alan-grofield
alang1
alangrofield123
roxanne
roxannejones
rjones
r.jones
roxanne_jones
r_jones
jonesr
jones.r
jonesroxanne
roxanne.jones
rj
r_j
roxannej
roxanne.j
roxanne-jones
r-jones
jones-r
jones_r
roxannej
roxanne-j
jones.r
rjroxanne
rj.roxanne
jones_rj
jones.rj
roxannejones
rjones
roxanne.jones
roxanne-jones
roxannej1
roxannejones123
ernesto
ernestofreeman
efreeman
e.freeman
ernesto_freeman
e_freeman
freemane
freeman.e
freemanernesto
ernesto.freeman
ef
e_f
ernestof
ernesto.f
ernesto-freeman
e-freeman
freeman-e
freeman_e
ernestof
ernesto-f
freeman.e
efernesto
ef.ernesto
freeman_ef
freeman.ef
ernestofreeman
efreeman
ernesto.freeman
ernesto-freeman
ernestof1
ernestofreeman123
```
###### ffuf fuzzing 
fuzzing with `usernames.txt` didnt show any errors that showed a successful username.
`ffuf -w usernames.txt -u http://enum-sandbox/auth/login -X POST -d 'username=FUZZ&password=bar' -H 'Content-Type: application/x-www-form-urlencoded'`
![[Pasted image 20240717162147.png]]
Here we can identify that **e.freeman** is the valid username because of the size of the word being 2089, while all others are 2093.
![[Pasted image 20240717183148.png]]
![[Pasted image 20240717183255.png]]
--------------------------------------------------
#### 2.2.7 Components with Vulnerabilities
As we explore web applications, we will likely encounter [_JavaScript frameworks_](https://developer.mozilla.org/en-US/docs/Learn/Tools_and_testing/Client-side_JavaScript_frameworks), such as [_React_](https://react.dev/), [_Angular_](https://angular.io/), and [_jQuery_](https://jquery.com/). Many developers use these frameworks to simplify development. These frameworks can contain vulnerabilities. These vulnerabilities tend to be useful for client-side attacks, such as cross-site scripting (XSS).

##### Tools that can be used to identify vulnerabilities:
- Manually check the versions and vulnerabilities associated
- `Retire.js` as a CLI tool (The command line version requires [_NodeJS_](https://nodejs.org/en) and [_npm_](https://www.npmjs.com/).)
- `Retire.js` as a Burp Suite Pro plugin