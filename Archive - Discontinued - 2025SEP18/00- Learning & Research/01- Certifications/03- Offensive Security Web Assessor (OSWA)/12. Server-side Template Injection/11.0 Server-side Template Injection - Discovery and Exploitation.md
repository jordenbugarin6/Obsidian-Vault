In this Learning Module, we will cover the following Learning Units:

- Templating Engines
- Twig - Discovery and Exploitation
- Apache Freemarker - Discovery and Exploitation
- Pug - Discovery and Exploitation
- Jinja - Discovery and Exploitation
- Mustache and Handlebars - Discovery and Exploitation
- Halo Case Study
- Sprout Forms Case Study
`Server-side Template Injection` (SSTI)[1](https://portal.offsec.com/courses/web-200-28380/learning/server-side-template-injection-discovery-and-exploitation-30963/server-side-template-injection-discovery-and-exploitation-31362#fn-local_id_50-1) is becoming a more common vulnerability in web applications as more developers move to use templating engines. Using templating engines in a web application encourages more distinct layers between how data is processed and how it is rendered in the web browser. This offers much more flexibility when deciding how an application should look and feel. When used properly, a templating engine can also nearly eradicate vulnerabilities such as `Cross-site Scripting` (XSS).[2](https://portal.offsec.com/courses/web-200-28380/learning/server-side-template-injection-discovery-and-exploitation-30963/server-side-template-injection-discovery-and-exploitation-31362#fn-local_id_50-2)

However, when developers misuse a templating engine, they can introduce vulnerabilities that range from XSS to remote code execution. As security experts, it's important for us to understand templating engines, how to discover SSTI, and how to elevate our access beyond the application's intended use.

We'll start by discussing templating engines in a broad sense. Once we understand how templating engines are used, we can then explore discovering injection techniques and exploitation.

When exploiting SSTI vulnerabilities, our first step is to determine which templating engine the target is using. This will be easier if we understand the syntax of some of the more popular templating engines.

In this Learning Module, we'll cover some of the popular templating engines. We'll review their syntax and explore how to discover if they are in use via black box discovery techniques.

Once we've discovered a template engine and determined which engine is in use, our primary goal is to obtain RCE. However, this might not always be possible. For templating engines that are rendered on the client, XSS has the highest level of exploitability. For server-side rendering, we `might` be able to obtain RCE if the templating engine has access to the underlying language. Otherwise, we may be able to read files from the local system or display sensitive variables.

Finally, we'll discover and exploit two real-world applications that were vulnerable to Server Side Template Injection. The first, Halo, will allow us to escalate from an administrative user to remote code execution on the server. The second will exploit a plugin called Sprout Forms in the Craft _Content Management System_ (CMS). This exploit will not require an authenticated user.