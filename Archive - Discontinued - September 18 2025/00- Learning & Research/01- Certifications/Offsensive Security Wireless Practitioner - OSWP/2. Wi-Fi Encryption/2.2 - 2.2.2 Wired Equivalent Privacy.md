
Open networks are susceptible to eavesdropping, as the traffic on them is not encrypted. WEP aims at providing some degree of privacy to data exchanged on the wireless network. It is part of the IEEE 802.11 standard and is a scheme used to secure wireless networks using Rivest Cipher 4 (RC4)[1](https://portal.offsec.com/courses/pen-210-9545/learning/wi-fi-encryption-15794/wired-equivalent-privacy-15861/wired-equivalent-privacy-16022#fn-local_id_80-1)Â to encrypt traffic and performs CRC32 checksums for message integrity.

WEP encryption only uses a 24-bit initialization vector (IV) as when the WEP standard was being drafted, the key size was limited due to US government export restrictions on cryptographic technologies. A 64-bit key was permitted, of which, 24 bits are used for IVs, thus reducing the real key size to 40 bits. Once the export restrictions were lifted, 128-bit WEP (using the same 24-bit IV) was implemented.

-----

### 2.2.1. RC4

RC4 was designed by Ron Rivest from RSA Security and was chosen for wireless encryption due to its simplicity and impressive speed.

RC4 is a symmetric cipher, meaning that the same key is used to both encrypt and decrypt the data. It creates a stream of bits that are XOR'd with plain text to get the encrypted data. To decrypt it, we can simply XOR the encrypted text with the key stream in order to recover the plain text.

RC4 consists of two key elements:

1. **Key Scheduling Algorithm (KSA)**: Initializes the state table with the IV and WEP key
2. **Pseudo-Random Generation Algorithm (PRGA)**: Creates the keystream

Figure 2 illustrates the encryption and decryption of plain text data using the keystream generated above.

![Figure 2: RC4 encryption/decryption overview](https://static.offsec.com/offsec-courses/PEN-210/images/Encryption/ebddd87f3d06c9f6c9e66492b9290927-Picture2.png)

Figure 2: RC4 encryption/decryption overview

Below, in Figure 3, we have a diagram outlining the WEP encryption process.

![Figure 3: The WEP encryption process](https://static.offsec.com/offsec-courses/PEN-210/images/Encryption/1f60bce780b5ec4c5259599800bae4b2-Picture3.png)

Figure 3: The WEP encryption process

A brief outline of the steps involved in WEP encryption is:

1. Concatenate the IV and WEP key, then run KSA and PRGA to get the keystream.
2. Create the Integrity Check Value (ICV) of the message, then concatenate it to the message.
3. XOR the plain text message plus the CRC32 and the keystream to obtain the encrypted text.
4. The packet then contains the following elements:

- IV (Used Previously)
    - Key ID
    - Encrypted Text
    - ICV that is the CRC32 of the plain text

The WEP decryption process flows according to Figure 4 as shown below.

![Figure 4: The WEP decryption process](https://static.offsec.com/offsec-courses/PEN-210/images/Encryption/6cd656cb021e626c072d8ab34429b3cb-Picture4.png)

Figure 4: The WEP decryption process

The steps that take place during the decryption process are as follows:

1. Concatenate the IV and the key corresponding to the key ID, then run KSA and PRGA to obtain the keystream.
2. XOR the encrypted message and the keystream, resulting in the message + ICV.
3. Compare the decrypted ICV with the one received with the packet. If they are the same, the frame is intact and accepted, otherwise, discard the frame, as the packet is fake or corrupted.
----
### 2.2.2. WEP Authentication

WEP can make use of two authentication systems: Open or Shared authentication. Open authentication is trivial and commonly used. Shared authentication, on the other hand, is fairly uncommon and clients will often struggle trying open authentication before switching to shared authentication.

#### Open Authentication

In open authentication, a client does not provide any credentials when authenticating to the Access Point. However, once associated, it must possess the correct key to encrypt and decrypt data frames.

#### Shared Authentication

During authentication, a challenge text is sent to the client. The challenge text must be encrypted with the WEP key by the client and sent back to the AP for verification, which allows the client to prove knowledge of the key. Once the encrypted challenge text is received, the AP attempts to decrypt it. If it is successful and matches the clear text version of the challenge text, the client is allowed to proceed to associate to the access point.