This Learning Unit covers the following Learning Objectives:

1. Develop an understanding of Static File IDOR findings
2. Learn about Database Object Referencing (ID-Based) IDOR

In this Learning Unit, we will discuss a variety of Learning Modules and concepts related to IDOR. More specifically, we will learn the theory behind IDOR-related vulnerabilities.

----------

#### 13.1.1. Static File IDOR
A _Static File_ IDOR finding arises when a target web application uses poorly-formed identification numbers pertaining directly to a data file's object. Successful exploitation of this finding type can lead to the exposure of file contents.

Let's examine the `http://idor-sandbox/docs/?f=1.txt` endpoint in our IDOR Sandbox application.

![[Pasted image 20241105142330.png]]
We find a message from Jason to Jerry stating that a new coffee machine is needed in the break room. This message is shown because of the text file referenced at the end of our endpoint (1.txt). Taking this idea a step further, we might guess that other text documents are present on the target machine.

For example, we can increment the number of our _f_ parameter to "2.txt", and obtain the endpoint http://idor-sandbox/docs/?f=2.txt.

Being able to increment or decrement IDs in this way is a tell-tale sign of Insecure Direct Object Referencing.

Next, let's explore another kind of static file IDOR we might encounter in the wild, which can occur inside a URL, with NodeJS, or parameters known as _Routing_.[1](https://portal.offsec.com/courses/web-200-28380/learning/insecure-direct-object-referencing-36181/introduction-to-idor-36213/static-file-idor-36187#fn-local_id_101-1)

Routing refers to the placement of specific segments in a URL that denote the type of information to be retrieved (such as files, documents, ticket numbers, etc). When a routed parameter is specified in a URL, the segments separated by a delimiter (such as a colon) are then processed by a back-end web technology. We're interested in any values in the URL segments that can be referenced, iterated, or brute-forced to exfiltrate information.

The set of URIs below demonstrate a routed endpoint intended for processing by ExpressJS along with some example URIs that we might observe with sample values. The forward slashes below represent static file paths, and all occurrences of a colon are known as dynamic identifiers for data processing.

```bash
/users/:userIdent/documents/:pdfFile
/trains/:from-:to
/book/:year-:author
```

The above listing shows a few segments for us to consider. The first objects would include user identification followed by a document that corresponds to the user. The second example demonstrates booking a train ticket, including a "from" destination and a "to" destination. Finally, we'll observe processing for book objects using a year and an author.

We'll find the same segments below; however, the values in this case are replaced to more clearly demonstrate how they might appear in the wild.

```bash
/users/18293017/documents/file-15 (PDF Retrieved)
/trains/LVIV-ODESSA               (Ticket File Retrieved)
/book/1996-GeorgeRRMartin         (Book Retrieved)
```

The above URIs show several parameters that act as segments completing a URL; we can leverage these parameters in an attempt to extract various types of information from a target web server.

In the next section, we will cover Database Object Referencing or "ID-Based" IDOR and how it might present itself within a target application.


--------

#### 13.1.2. Database Object Referencing (ID-Based) IDOR

_Insecure Database Object Referencing_ or _"ID-Based" IDOR_ refers to an endpoint that references objects from a database to be rendered on the web page but does so in an insecure fashion.[1](https://portal.offsec.com/courses/web-200-28380/learning/insecure-direct-object-referencing-36181/introduction-to-idor-36213/static-file-idor-36187#fn-local_id_110-1) It's important for us to make incremental checks with regards to these types of findings - if we don't, we might miss a vulnerability that will allow information to be exfiltrated from a database that is meant to be kept secure.

When SQL queries are executed in the back-end of the web application, we would identify an incremental series of numerical parameter values, which we could modify sequentially to exfiltrate data that pertains to an object in the database.

To better understand how this appears, let's review the `http://idor-sandbox:80/customerPage/?custId=1` endpoint.
![[Pasted image 20241105145352.png]]

The URL includes a query string with a _custId_ parameter that has a numeric value. In order to identify that ID-Based object referencing is taking place, we would need to increment this number and either observe the response size in bytes or visually confirm any differences within the web browser between each iteration.

Next, let's cover the _Unique Identifier_ (UID) concept. A UID can be numerical or alphanumeric. We'll explore a few sample scenarios that work directly with a UID.

To start, let's consider the following endpoint: `http://idor-sandbox:80/user/?uid=16327`

![[Pasted image 20241105145415.png]]
More specifically, we'll examine the _uid_ parameter. This identification number determines which profile information is extracted from the database.

The IDOR Sandbox uses a five-digit number to identify users. Real world applications often use more complicated values, such as custom sequences or UUIDs like `userProfile/a8e62d80-42cc-4ac6-bf53-d28a0ff61a82`.

As identifiers become longer and more complex, they become more difficult to brute force. This is not to say that it is impossible, but rather beyond the scope of this course.

Let's examine a few scenarios with unique identifiers. First, let's imagine we are performing an assessment for a large company that works with freight and shipment. It makes sense that we would search for endpoints in the freight system that reference _Stock Keeping Units_ (SKUs). In this case, the SKU would represent our UID.

To exfiltrate sensitive data from the freight web application, we might brute force these SKU numbers. Our goal would be to abuse the application's functionality to reveal the company's private product information.

Let's explore the concept of unique identification or database object referencing ID-Based IDOR a bit further. In this example, we'll suppose we're performing an assessment for a social media platform that allows users to comment. To exfiltrate sensitive information, we would first gather a large list of unique identifiers pertaining to the platform's users, then attempt to re-use these values, iterating through various web parameters with the intent of retrieving sensitive information pertaining to those users.

In the next Learning Unit, we will tackle exploitation within the IDOR Sandbox.

##### Labs
1. `OS{idor_flag_01}`
![[Pasted image 20241105150335.png]]

```bash
http://idor-sandbox/docs/?f=5.txt
```
![[Pasted image 20241105145633.png]]

------------

