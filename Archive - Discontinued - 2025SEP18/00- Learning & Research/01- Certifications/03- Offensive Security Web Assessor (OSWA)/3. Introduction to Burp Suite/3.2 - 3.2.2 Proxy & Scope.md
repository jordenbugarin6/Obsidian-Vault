This Learning Unit covers the following Learning Objectives:

- Understand how to work with Burp Suite's Proxy functionality.
- Understand how to work with Burp Suite's Scope functionality.

In this section, we are going to discuss some theories to better understand what a proxy is, how proxies are used, and how we can leverage them to exploit various services. We should keep in mind that our primary work with proxies will focus on web surfaces.

Proxies are described by [Wikipedia](https://en.wikipedia.org/wiki/Proxy_server) as follows.

Instead of connecting directly to a server that can fulfill a requested resource, such as a file or web page, the client directs the request to the proxy server, which evaluates the request and performs the required network transactions.

Essentially, a _proxy_ is a server application that acts as a man-in-the-middle or _intermediary_ between requests from a client to a server.

On the other hand, during our engagements, we'll also need to know about our target [_scope_](https://portswigger.net/burp/documentation/desktop/tools/target/scope). A target scope is going to incorporate authorized target domains, IP ranges, or specific endpoints into our penetration tests. Fortunately, Burp Suite has a wonderful and powerful tool that works with this concept known as the _Scope_ tool.

In this Learning Unit, we're also going to take some time to discuss the _Scope_ tool with the intent of keeping our engagements more clean, organized, and containing relevant information to our target.

First, however, let's discuss the concept of a proxy.

--------------------------------------------------

#### 3.2.1 Proxy
This section manages the interception of web traffic, which is the core functionality of Burp Suite itself. During our application assessments, we'll switch to this window often to turn the intercept functionality _on_ or _off_.

If the intercept functionality is set to _on_, Burp will pause before forwarding all of the traffic that passes through the browser. However, if it is turned _off_, our requests will still be stored in the _HTTP History_ tab, which we can access later.

![[Pasted image 20240717233726.png]]
When Intercept is on browse to `http://offsecwp/wp-login.php` in firefox where the proxy is setup and it will bring up the option to forward or drop the traffic, the packet can be modified before being forwarded
![[Pasted image 20240717234054.png]]
We have now verified the capture inside of Burp Suite for the initial load of the **http://offsecwp/wp-login.php** URL endpoint.

--------

**wp_login.php** is an important [_WordPress_](https://wordpress.com/) file that sends login information and _also_ processes that information after it's been sent from a login form. We should take a moment to note this file as it will be important later on.

-------
Browsing through the site, we can observe how the _HTTP history_ tab updates accordingly.
![[Pasted image 20240717234627.png]]
Let's click on _Proxy Settings_, marked by a cog icon in the latest version of Burp Suite.

There are two important reasons for us to review this. First, if we ever need to make changes to the local port Burp Suite is bound to, we'll manage that in this new window by clicking the respective _Add_ or _Edit_ buttons.

Second, if we scroll down, we'll find the _Match and Replace_ functionality that we can use when a request is intercepted. This functionality allows Burp Suite to modify requests and responses based on the enabled rules. We can leverage this to render content from the perspective of _Internet Explorer_, _Google Chrome_, or _Firefox_, for example, even mimicking mobile devices.

![[Pasted image 20240718001451.png]]

We could further practice the concepts presented in this section by attempting to load the **http://offsecwp** endpoint and capture the data in the _Proxy_ tab. Clicking around the website and capturing other requests is also good practice.

--------------------------------------------------

#### 3.2.2 Scope
The [Scope](https://portswigger.net/burp/documentation/desktop/tools/target/scope) functionality of Burp Suite is particularly useful in real-world engagements. This functionality allows us to define our own target for relevant results. By doing so, we can effectively view and work with resources solely from that domain.

but let's get to work on understanding exactly what Scope entails. To do that, we're going to need to understand how Burp Suite's _HTTP History_ tab functions. As it stands, with Burp Suite open and _no defined target scope_, Burp Suite will store each and every resource or request that passes through the proxy. In this section, we're going to be viewing the _HTTP History_ tab with both having defined a scope and not having a target scope specified.

First, let's review Burp Suite's _HTTP History_ functionality with _no defined scope_ by browsing a few web pages in the sandbox at **http://offsecwp/** and then reviewing our history.

For best results in this section, we should make sure the history is initially clear. We can do this by clicking _Proxy_ > _HTTP History_. when in the HTTP History tab we can _Right Click_ > _Clear History_.

![[Pasted image 20240718002214.png]]
We should now have a clean history as displayed below.
![[Pasted image 20240718002228.png]]
With our history clear and no scope yet defined, let's use Burp Suite's built-in web browser to load a few web pages. First, we'll browse to **http://offsecwp/**. Then, we'll browse to **https://www.MegaCorpOne.com** and review our _HTTP History_ results.

Even after browsing only two domains, we get a plethora of results. Most of these results are almost always going to be web application resources. These often take the form of JavaScript and CSS files.

**Resources are stored in the yellow highlights**
![[Pasted image 20240718002654.png]]
Clear the History again
In the Settings place **http://offsecwp** into the prefix settings to only allow scope to contain that `URL`
![[Pasted image 20240718003359.png]]
After clicking _OK_, we will be presented with a pop-up box. This box asks us if we want Burp Suite to stop sending out-of-scope (OOS) items to the _HTTP History_ tab. We'll move forward by clicking _Yes_, as we do not want any irrelevant resources in our history.
![[Pasted image 20240718003702.png]]

That's it; we've now _defined_ our own custom target scope and configured Burp Suite to ignore out-of-scope requests. At this point, we can close the settings window.

Let's now do exactly as we did at the beginning of this section by returning to Burp Suite's built-in browser and loading both **http://offsecwp/** and **https://www.MegaCorpOne.com/**. When we're done with that, we'll return to the _HTTP History_ tab and review the results.

Now because only `http://offsecwp` is in scope that is all that is seen
![[Pasted image 20240718004334.png]]
![[Pasted image 20240718005515.png]]

--------------------------------------------------
##### Labs
- Because the only one in scope is `https:://www.MegaCorpOne.com` that is the only one that will show.
![[Pasted image 20240718005600.png]]