new script version that adds an addition of `compress.ps1`
also changes bypass directory to `artifact_kit_bypass_files` and regular `artifact_kit_original_files`
```python
import os
import shutil
import time
import subprocess
import threading
import itertools
import sys

# === CONFIGURATION ===
src_common_dir = "/opt/cobaltstrike/arsenal-kit/kits/artifact/src-common"
resource_kit_target = "/opt/cobaltstrike/arsenal-kit/kits/resource/compress.ps1"

artifact_kit_original_dir = "/opt/cobaltstrike/arsenal-kit/kits/artifact/artifact-kit-AV-switcher/artifact_kit_original_files"
artifact_kit_bypass_dir = "/opt/cobaltstrike/arsenal-kit/kits/artifact/artifact-kit-AV-switcher/artifact_kit_bypass_files"
backup_dir = "/opt/cobaltstrike/arsenal-kit/kits/artifact/artifact-kit-AV-switcher/backups" 

resource_kit_original_dir = "/opt/cobaltstrike/arsenal-kit/kits/artifact/artifact-kit-AV-switcher/resource_kit_original"
resource_kit_bypass_dir = "/opt/cobaltstrike/arsenal-kit/kits/artifact/artifact-kit-AV-switcher/resource_kit_bypass"

build_script_dir = "/opt/cobaltstrike/arsenal-kit"
build_script = os.path.join(build_script_dir, "build_arsenal_kit.sh")

files_to_swap = ["patch.c", "bypass-pipe.c"]
resource_file_name = "compress.ps1"

# === HELPERS ===
def ensure_dirs():
    for d in [artifact_kit_original_dir, artifact_kit_bypass_dir, backup_dir, resource_kit_original_dir, resource_kit_bypass_dir]:
        if not os.path.exists(d):
            os.makedirs(d)
            print(f"ğŸ“ Created directory: {d}")

def timestamp():
    return time.strftime("%Y%m%d-%H%M%S")

def backup_files():
    ensure_dirs()
    ts = timestamp()
    for filename in files_to_swap:
        src = os.path.join(src_common_dir, filename)
        if os.path.exists(src):
            dst = os.path.join(backup_dir, f"{filename}.{ts}.bak")
            shutil.copy2(src, dst)
            print(f"ğŸ“¦ Backed up {filename} â†’ {dst}")
        else:
            print(f"âš  {filename} not found in {src_common_dir}, skipping backup.")

    # Backup compress.ps1
    if os.path.exists(resource_kit_target):
        dst = os.path.join(backup_dir, f"compress.ps1.{ts}.bak")
        shutil.copy2(resource_kit_target, dst)
        print(f"ğŸ“¦ Backed up compress.ps1 â†’ {dst}")
    else:
        print(f"âš  compress.ps1 not found at {resource_kit_target}, skipping backup.")

def switch_files(source_dir, resource_dir):
    print(f"\nğŸ” Swapping artifact files from: {source_dir}")
    backup_files()
    for filename in files_to_swap:
        src = os.path.join(source_dir, filename)
        dst = os.path.join(src_common_dir, filename)
        if os.path.exists(src):
            shutil.copy2(src, dst)
            print(f"âœ… Replaced {filename}")
        else:
            print(f"âŒ {filename} not found in {source_dir}, skipping.")

    # Switch compress.ps1 from resource kit directory
    resource_src = os.path.join(resource_dir, resource_file_name)
    if os.path.exists(resource_src):
        shutil.copy2(resource_src, resource_kit_target)
        print(f"ğŸ§ª Replaced compress.ps1 from: {resource_dir}")
    else:
        print(f"âŒ compress.ps1 not found in {resource_dir}, skipping.")

# === Spider Animation ===
def spider_loader(stop_event):
    spider_frames = ["ğŸ•· ", " ğŸ•·", "  ğŸ•·", "   ğŸ•·", "  ğŸ•·", " ğŸ•·"]
    for frame in itertools.cycle(spider_frames):
        if stop_event.is_set():
            break
        sys.stdout.write(f"\r{frame} Building Arsenal Kit... ")
        sys.stdout.flush()
        time.sleep(0.2)
    sys.stdout.write("\râœ… Arsenal Kit rebuilt successfully.          \n")

def rebuild_artifact_kit():
    stop_event = threading.Event()
    thread = threading.Thread(target=spider_loader, args=(stop_event,))
    thread.start()

    try:
        subprocess.run(["bash", "build_arsenal_kit.sh"], cwd=build_script_dir, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL, check=True)
    except subprocess.CalledProcessError as e:
        stop_event.set()
        thread.join()
        print(f"\nâŒ Build failed: {e}")
        return
    except FileNotFoundError:
        stop_event.set()
        thread.join()
        print(f"\nâŒ Could not find build script at: {build_script}")
        return

    stop_event.set()
    thread.join()

# === Menu ===
def show_menu():
    print("\n==== Artifact Kit Patch Switcher ====")
    print("1. Use ORIGINAL files (no AV bypass)")
    print("2. Use BYPASS files (AV evasion)")
    print("3. Exit")

def main():
    ensure_dirs()
    while True:
        show_menu()
        choice = input("Choose an option (1-3): ").strip()
        if choice == "1":
            switch_files(artifact_kit_original_dir, resource_kit_original_dir)
            rebuild_artifact_kit()
        elif choice == "2":
            switch_files(artifact_kit_bypass_dir, resource_kit_bypass_dir)
            rebuild_artifact_kit()
        elif choice == "3":
            print("ğŸ‘‹ Exiting...")
            break
        else:
            print("âŒ Invalid choice. Try again.")

if __name__ == "__main__":
    main()
```

#### 1st `Test Run` with option `1`
- creates `resource_kit_original` and `resource_kit_bypass`
![[Pasted image 20250407184614.png]]
#### 1st `Test Run` with option `2`
![[Pasted image 20250407184758.png]]

#### arsenal-kit-mod.py
- tested and made sure that `/opt/cobaltstrike/arsenal-kit/kits/resource` is changed depending on options chosen in the script
```python
import os
import shutil
import time
import subprocess
import threading
import itertools
import sys

# === CONFIGURATION ===
src_common_dir = "/opt/cobaltstrike/arsenal-kit/kits/artifact/src-common"
resource_kit_target = "/opt/cobaltstrike/arsenal-kit/kits/resource/compress.ps1"

artifact_kit_original_dir = "/opt/cobaltstrike/arsenal-kit/kits/artifact/artifact-kit-AV-switcher/artifact_kit_original_files"
artifact_kit_bypass_dir = "/opt/cobaltstrike/arsenal-kit/kits/artifact/artifact-kit-AV-switcher/artifact_kit_bypass_files"
backup_dir = "/opt/cobaltstrike/arsenal-kit/kits/artifact/artifact-kit-AV-switcher/backups"

resource_kit_original_dir = "/opt/cobaltstrike/arsenal-kit/kits/artifact/artifact-kit-AV-switcher/resource_kit_original"
resource_kit_bypass_dir = "/opt/cobaltstrike/arsenal-kit/kits/artifact/artifact-kit-AV-switcher/resource_kit_bypass"

build_script_dir = "/opt/cobaltstrike/arsenal-kit"
build_script = os.path.join(build_script_dir, "build_arsenal_kit.sh")

files_to_swap = ["patch.c", "bypass-pipe.c"]
resource_file_name = "compress.ps1"

# === HELPERS ===
def ensure_dirs():
    for d in [artifact_kit_original_dir, artifact_kit_bypass_dir, backup_dir, resource_kit_original_dir, resource_kit_bypass_dir]:
        if not os.path.exists(d):
            os.makedirs(d)
            print(f"ğŸ“ Created directory: {d}")

def timestamp():
    return time.strftime("%Y%m%d-%H%M%S")

def backup_files():
    ensure_dirs()
    ts = timestamp()
    for filename in files_to_swap:
        src = os.path.join(src_common_dir, filename)
        if os.path.exists(src):
            dst = os.path.join(backup_dir, f"{filename}.{ts}.bak")
            shutil.copy2(src, dst)
            print(f"ğŸ“¦ Backed up {filename} â†’ {dst}")
        else:
            print(f"âš  {filename} not found in {src_common_dir}, skipping backup.")

    if os.path.exists(resource_kit_target):
        dst = os.path.join(backup_dir, f"compress.ps1.{ts}.bak")
        shutil.copy2(resource_kit_target, dst)
        print(f"ğŸ“¦ Backed up compress.ps1 â†’ {dst}")
    else:
        print(f"âš  compress.ps1 not found at {resource_kit_target}, skipping backup.")

def switch_files(source_dir, resource_dir):
    print(f"\nğŸ” Swapping artifact files from: {source_dir}")
    backup_files()
    for filename in files_to_swap:
        src = os.path.join(source_dir, filename)
        dst = os.path.join(src_common_dir, filename)
        if os.path.exists(src):
            shutil.copy2(src, dst)
            print(f"âœ… Replaced {filename}")
        else:
            print(f"âŒ {filename} not found in {source_dir}")

    resource_src = os.path.join(resource_dir, resource_file_name)
    if os.path.exists(resource_src):
        shutil.copy2(resource_src, resource_kit_target)
        print(f"âœ… Replaced compress.ps1 from: {resource_dir}")
    else:
        print(f"âŒ compress.ps1 not found in {resource_dir}")

# === Spinner ===
def spider_loader(stop_event):
    spider_frames = [
        "ğŸ•·        ",
        " ğŸ•·       ",
        "  ğŸ•·      ",
        "   ğŸ•·     ",
        "    ğŸ•·    ",
        "     ğŸ•·   ",
        "      ğŸ•·  ",
        "       ğŸ•· ",
        "        ğŸ•·",
        "       ğŸ•· ",
        "      ğŸ•·  ",
        "     ğŸ•·   ",
        "    ğŸ•·    ",
        "   ğŸ•·     ",
        "  ğŸ•·      ",
        " ğŸ•·       ",
        "ğŸ•·        "
    ]
    for frame in itertools.cycle(spider_frames):
        if stop_event.is_set():
            break
        sys.stdout.write(f"\r{frame} Building Arsenal Kit... ")
        sys.stdout.flush()
        time.sleep(0.1)
    sys.stdout.write("\r\033[K")  # Clear line

def rebuild_artifact_kit(mode_label):
    stop_event = threading.Event()
    thread = threading.Thread(target=spider_loader, args=(stop_event,))
    thread.start()

    try:
        subprocess.run(["bash", "build_arsenal_kit.sh"], cwd=build_script_dir, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL, check=True)
    except subprocess.CalledProcessError as e:
        stop_event.set()
        thread.join()
        print(f"\nâŒ Build failed: {e}")
        return
    except FileNotFoundError:
        stop_event.set()
        thread.join()
        print(f"\nâŒ Could not find build script at: {build_script}")
        return

    stop_event.set()
    thread.join()
    print("âœ… Arsenal Kit rebuilt successfully.")
    if mode_label == "original":
        print("ğŸ›¡ï¸ AV Bypass Disabled.")
    elif mode_label == "bypass":
        print("ğŸ§¬ AV Bypass Enabled.")

# === Menu ===
def show_menu():
    print("\n==== Artifact Kit Patch Switcher ====")
    print("1. Use ORIGINAL files (no AV bypass)")
    print("2. Use BYPASS files (AV evasion)")
    print("3. Exit")

def main():
    ensure_dirs()
    show_menu()
    choice = input("Choose an option (1-3): ").strip()
    if choice == "1":
        switch_files(artifact_kit_original_dir, resource_kit_original_dir)
        rebuild_artifact_kit("original")
    elif choice == "2":
        switch_files(artifact_kit_bypass_dir, resource_kit_bypass_dir)
        rebuild_artifact_kit("bypass")
    elif choice == "3":
        print("ğŸ‘‹ Exiting...")
    else:
        print("âŒ Invalid choice. Exiting.")

if __name__ == "__main__":
    main()
```
tomorrow need to see if it works