
This Learning Unit covers the following Learning Objectives:

1. Understand how to use the custom sandbox

This Learning Unit will take approximately 15 minutes to complete.

--------------------------------------------------
#### 4.1.1. Accessing the Sandbox
In this module, we'll use two applications to learn about XSS:

- **XSS Sandbox** - A custom sandbox application with access to a user simulator and various vulnerable websites.
- **Shopizer** - A open source e-commerce platform written in Java.

In order to access these servers, we have created two /etc/hosts file entries on our Kali Linux VM.

![[Pasted image 20240720210801.png]]

--------------------------------------------------
#### 4.1.2 Understanding the Sandbox
In order to exploit XSS vulnerabilities, we'll need a target user to visit the page we have injected into. To accomplish this, we have access to an XSS sandbox with various vulnerable applications. Let's open our browser to `http://xss-sandbox` and review how we might use it to learn about XSS.

![[Pasted image 20240720211510.png]]
The application is split into four sections. The left side is our "hacker" side where we can navigate the various pages and exploit vulnerabilities, which get executed in our browser. The right side is the "user" side. On this side, we can configure the user to conduct various types of actions and, when the _Render_ button is clicked, have the user visit the same page we are visiting.

Let's break up each side further. First, let's investigate the top left navigation bar.

![[Pasted image 20240720211528.png]]

The navigation pane has links to the various vulnerable applications:

- **Info** - This page provides information about the XSS sandbox. It is not vulnerable and will not be targeted. However, we can refer back to it if we need a refresher on how the sandbox works.
- **Eval** - A JavaScript console that the victim will autorun when loaded.
- **Search** - A search application vulnerable to reflected XSS.
- **Blog** - A blogging site vulnerable to stored XSS in multiple locations, some with filtering in place.
- **Survey** - A survey sent to a user vulnerable to DOM XSS.
- **Donate** - A donation link sent to a user to donate to a cause.
- **RSVP** - An application that allows users to RSVP to an event and provide a message to the host.
- **List** - An application that will format data to be shared with other users.
- **ToDo** - A To-Do list application.

We'll use these various applications in our examples later and some will be left as exercises. The pages are displayed in the lower left quadrant of the page. We'll call this our Hacker Browser. Currently, we are on the "Info" page.

![[Pasted image 20240720211706.png]]

This section displays the page in an imitation browser. This side of the page is using our current browser to render the content. That means that if we were to exploit a XSS vulnerability on one of the vulnerable applications, we would be exploiting our browser. Once we have the exploit ready, we can use the control panel found on the top-right quadrant to render the page.

![[Pasted image 20240720214503.png]]

When a page is not being rendered, the control panel lets us configure the simulated browser and its actions. The configurations are:

- **Use HttpOnly Cookie** - Sets an HttpOnly cookie in the browser before the page is loaded.
- **Use Non-HttpOnly Cookie** - Sets a cookie without the HttpOnly flag before the page is loaded.
- **Blindly enter credentials** - Simulates a user being phished. The target user will enter usernames into any text field and passwords into any password field.
- **Used stored password** - Simulates a user's browser where credentials are auto-filled in login boxes after the page has loaded.
- **Simulate keystrokes** - Instructs the target to type anywhere on the page after the page has loaded.
- **Data in Local Storage** - Loads secrets and sensitive data in the local storage before the page is loaded.

Clicking the _Render_ button will make the simulated user browser load the page currently loaded in our hacker browser. Once rendered, a screenshot of the user's browser will be sent back to us. We can disable these screenshots by unchecking the _Refresh Screenshot_ checkbox. The rendered page will be displayed in the lower-right quadrant.

![[Pasted image 20240720215003.png]]

The navigation buttons within the target browser are intentionally not under our control because we are simulating a remote user.

If we clear the render by clicking the _Clear_ button in the control panel, we can go back to changing the settings. Let's check the _Used stored password_ checkbox to simulate a user with a password stored in their password manager. Once checked, we can click _Render_ again and find that the user's browser filled in the credentials.

![[Pasted image 20240720215349.png]]

Being that this site is not vulnerable to XSS, we have no way of knowing what the value of the password is. However, as we'll find in the other applications, we have ways of exfiltrating passwords.

As we'll find with the various types of XSS vulnerabilities, some exploits may contaminate the database and make the application unusable. In these situations, there is a /reset endpoint that will reset the database. If the application does not have a database (like Info), there is no reset endpoint.

In order to inject JavaScript, we must first understand what JavaScript is, what it can do, and some fundamentals that will help us when exploiting XSS.
