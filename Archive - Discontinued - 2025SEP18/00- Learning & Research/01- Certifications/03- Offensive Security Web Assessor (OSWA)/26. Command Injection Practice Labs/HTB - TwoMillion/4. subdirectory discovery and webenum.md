navigating to `10.10.11.221` shows this sub directory - adding this to `/etc/hosts`
![[Pasted image 20250416203534.png]]
main page
![[Pasted image 20250416203921.png]]clicking on `join` shows the `invite page` - looking at the `invite` code shows `inviteapi.min.js` file

![[Pasted image 20250416204338.png]]

![[Pasted image 20250416204212.png]]

now the next question is what are the `function` names - now if we copy and paste this code into the below `URL` and mark it as `packer` we can find the answer
`https://lelinhtinh.github.io/de4js/`

![[Pasted image 20250416205552.png]]
this is what turns out from the website
![[Pasted image 20250416205722.png]]

```js
function verifyInviteCode(code) {
    var formData = {
        "code": code
    };
    $.ajax({
        type: "POST",
        dataType: "json",
        data: formData,
        url: '/api/v1/invite/verify',
        success: function (response) {
            console.log(response)
        },
        error: function (response) {
            console.log(response)
        }
    })
}

function makeInviteCode() {
    $.ajax({
        type: "POST",
        dataType: "json",
        url: '/api/v1/invite/how/to/generate',
        success: function (response) {
            console.log(response)
        },
        error: function (response) {
            console.log(response)
        }
    })
}
```

![[Pasted image 20250416205742.png]]

now that we know the function when we curl to these endpoints  we get a hint with `ROT 13` and we get a hint to check the encryption

```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[17Apr2025 01:09:17]-[/var/www/html/portal]
â””â”€# curl -s -X POST http://2million.htb/api/v1/invite/verify                                                          
{"0":400,"success":0,"error":{"message":"Missing parameter: code"}}                                                  
                                                                    
â”Œâ”€â”€(rootðŸ’€gobots)-[17Apr2025 01:09:29]-[/var/www/html/portal]
â””â”€# curl -s -X POST http://2million.htb/api/v1/invite/how/to/generate
{"0":200,"success":1,"data":{"data":"Va beqre gb trarengr gur vaivgr pbqr, znxr n CBFG erdhrfg gb \/ncv\/i1\/vaivgr\/trarengr","enctype":"ROT13"},"hint":"Data is encrypted ... We should probbably check the encryption type in order to decrypt it..."}                           
```
![[Pasted image 20250416215207.png]]
```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[17Apr2025 01:09:56]-[/var/www/html/portal]
â””â”€# curl -s -X POST http://2million.htb/api/v1/invite/how/to/generate
{"0":200,"success":1,"data":{"data":"Va beqre gb trarengr gur vaivgr pbqr, znxr n CBFG erdhrfg gb \/ncv\/i1\/vaivgr\/trarengr","enctype":"ROT13"},"hint":"Data is encrypted ... We should probbably check the encryption type in order to decrypt it..."}   
```
utilizing `cyberchef` we throw in `ROT13` and the `encoding`
![[Pasted image 20250418181035.png]]
we can see that to `generate` an `invite` code to make a `POST` to `/api/v1/invite/generate` and once we do that we get a code
```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[18Apr2025 22:07:52]-[/var/www/html/portal]
â””â”€# curl -s -X POST http://2million.htb/api/v1/invite/generate       
{"0":200,"success":1,"data":{"code":"NlgxQVUtU1FWRE8tSDU0SDgtREJMSjg=","format":"encoded"}}         
```
however it is `base64` encoded so use `cyberchef` again to `de encode`
![[Pasted image 20250418181436.png]]
and now when we enter the code we can make a login
![[Pasted image 20250418181451.png]]
created user `test@test.local` and logged in
![[Pasted image 20250418181532.png]]
the path that is used when the `connection pack` is downloaded
![[Pasted image 20250418181820.png]]
![[Pasted image 20250418181837.png]]
the next question is `How many API endpoints are there under /api/v1/admin?` and in our `burpsuite` we have `/api/v1/user/vpn/generate`
![[Pasted image 20250418183529.png]]
so we can send this to `repeater` and `prune` it to `/api/v1/` and can see 3 different `admin` endpoints
![[Pasted image 20250418184233.png]]

