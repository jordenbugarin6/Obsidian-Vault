
Token Store is the same as [[5. Token Impersonation]] but instead of utilizing the token immediately you are able to store it for later use.

run `ps` to list processes owned by users, in this case we want `DEV\jking`
![[Pasted image 20231128143919.png]]
use `token-store steal 760` to store the token of `DEV\jking` 
![[Pasted image 20231128144036.png]]
to show stored tokens use `token-store show`
![[Pasted image 20231128144310.png]]
to use the stored token `token-store use 0`
![[Pasted image 20231129121425.png]]


to remove a token use `token-store remove <id>`

to remove ALL tokens use `token-store remove-all`

The primary advantages of the token store are two-fold.  The first is that we don't have to carry out the stealing process multiple times, which is better OPSEC.  Since stealing a token requires opening a handle to the target process and process token, the fewer times you do that, the better.  The second is that maintaining an open handle to the duplicated token prevents Windows from disposing of the user's logon session if they were to logoff or terminate the process we stole from.