Windows operating system APIs (or _Win32 APIs_) are in dynamic link libraries and run as unmanaged code. We'll use the [_Declare_](https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/declare-statement) keyword to link to these APIs in VBA, providing the name of the function, the DLL it resides in, the argument types, and return value types. We will use a _Private Declare_, meaning that this function will only be used in our local code.

In this example, we'll use the [_GetUserName_](https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-getusernamea) API. We will build our _Declare_ function statement and display the username in a popup with _MsgBox_. We can reference the function prototype from the official MSDN documentation, which tells us the maximum size of the username, along with the DLL it resides in (**Advapi32.dll**). We can expand on that to declare the function we want.

```
BOOL GetUserNameA(
  LPSTR   lpBuffer,
  LPDWORD pcbBuffer
);
```

MSDN describes the function arguments as native C types, and we must translate these to their corresponding VBA data types. The first argument is an output buffer of C type _LPSTR_ which will contain the current username. It can be supplied as a _String_ in VBA.

***Working out the conversion between [C data types](https://docs.microsoft.com/en-us/windows/win32/winprog/windows-data-types) and [VBA data types](https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/data-types/) can be tricky. MSDN references some comparisons, but there's very little official documentation.***
  