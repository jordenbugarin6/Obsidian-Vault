This Learning Unit covers the following Learning Objectives:

- Understand the Repeater tool in Burp Suite
- Understand the Comparer tool in Burp Suite
- Understand the Intruder tool in Burp Suite
- Understand the Decoder tool in Burp Suite

When we perform web application assessments in Burp Suite, we're going to be making use of the tools discussed in the coming sections for the vast majority of our time. The primary purpose of these tools is to provide us with information about our target, whether it be through the ability to specially craft requests or decode encoded data.

The tools we discuss in this Learning Unit will be absolutely crucial to our success in web courses from Offensive Security.

--------------------------------------------------

#### 3.3.1 Repeater
The [Repeater](https://portswigger.net/burp/documentation/desktop/tools/repeater/using) acts as our primary Burp Suite tool during web assessments

The Repeater allows us to craft special requests, which we then send to the target server. Most of our testing will be intercepting requests from a target application and then modifying them to be sent along. The Repeater allows us to do this as much as we like. We're even able to review the result of our sent request in the _Response_ panel of the _Repeater_ tab.

We'll start by turning on intercept and then open Firefox and navigate to **http://offsecpwp/wp-login.php**, thus capturing the request. Within the Proxy tab request, we need to right-click and select _Send to Repeater_, then click on the _Repeater_ tab to view our captured request.
**Make sure that `/etc/hosts` is updated to the new IP for environment**
![[Pasted image 20240719181512.png]]
Our request is finally ready to be reviewed and modified, as shown below.
![[Pasted image 20240719181622.png]]

On the left side of the tab, we'll find the _Request_ panel. This panel contains our captured request for the **http://offsecwp/wp-login.php** endpoint. On the right, we'll notice the _Response_ panel. Currently, the response panel is empty as we have not sent any request to the target server yet.

The _Response_ panel works much like the _View Source_ functionality of a web browser, except it will include any response headers along with the raw body of the response. This panel will be populated with data after we click the _Send_ button on the top left.

Repeater allows us to perform targeted changes and manipulations to _any_ HTTP request, send it to a web server, and view the corresponding response. This is a particularly useful tab because it allows us to quickly and effectively test our ideas and payloads in the most minimal way possible.

For example, we will click _Send_ and take note of the response in the right-hand panel as shown in the figure below.

![[Pasted image 20240719181901.png]]

Next, let's take a moment to introduce the `C+Shift+u`hotkey combination in Burp Suite. We can use this hotkey after selecting any or all of the text from an encoded HTTP request to quickly decode it to a human-readable format.
![[Pasted image 20240719193042.png]]

When decoding text, we can also use the _Inspector_ tool. The _Inspector_ is located on the far right side of the Repeater tab and directly next to the response panel. Let's use the following encoded string to demonstrate how we can decode it to a human-readable format.
```
%2Fsearch.php%3Fquery%3Dsample+search+query+encoded
```
Copied and Pasted the URL encoded text into the `HTTP` Request and shows that the inspector decodes it.
![[Pasted image 20240719193438.png]]
We decoded the string fairly quickly by leveraging the Inspector within Repeater. This is a helpful alternative method for decoding a string inside Burp Suite using a keyboard shortcut.

Additionally, if we ever need to decode the contents of a request, we can make use of the _Decoder_ tab in Burp Suite.

##### Labs
![[Pasted image 20240719195017.png]]
When originally looking at the request by browsing to `http://offsecwp/?author=1` on line `60` it is showing that the 1st author is the `admin` user 
![[Pasted image 20240719194955.png]]
Changing the value to `2` shows that the `2nd` user is jerry
![[Pasted image 20240719195301.png]]

--------------------------------------------------

#### 3.3.2 Comparer
Often, when assessing different portions of web applications, we can be presented with two pages that appear the same but have differences in response size. A difference in response size can be indicative of either a change in header responses or response data. If we're uncertain about what the difference is between two requests, we can use Burp Suite's Comparer tool to assist us.

This can be done with **Comparer**
![[Pasted image 20240719195453.png]]
we have the Comparer tool open with two large boxes and some options on the right side of the tool. We have the ability to paste, load, remove, or clear information from the top box. The bottom box will update automatically depending on which item is selected for comparison.

To begin Comparer testing:
Navigate to `http://offsecwp/` and `http://offsecwp/wp-login.php` in two different tabs in a browser that is being proxied through Burp
![[Pasted image 20240719201143.png]]
Once in the `HTTP History` tab right click the `257` and select _Send to Comparer (Response)_ and select _Send to Comparer (Request)_ for `256`
Navigate to the `Comparer` tab and select `words` or `bytes` in the bottom right to see the differences between the two requests
- you can compare both `GET Requests` both `Responses` or in any other combination you want - below is a Response & Request
![[Pasted image 20240719201517.png]]
Comparing each `GET Request`
![[Pasted image 20240719202003.png]]
Comparing each `Response`
![[Pasted image 20240719202101.png]]


##### Labs
![[Pasted image 20240719202210.png]]

--------------------------------------------------

#### 3.3.3. Intruder

We can leverage our captured requests using the Intruder tab to position our manipulated text in payload wordlist form at a location of our choice.

Whenever we capture a request, every form of input, including GET data, POST data, and headers, can be manipulated with Intruder. We can modify our payload position by first clearing all instances of "§" characters, moving our cursor position to where we want the payloads inserted, and clicking _Add §_.

For now however, we'll load the `http://offsecwp/wp-login.php` endpoint, and enter some values into the username and password input fields. The reason for this is so that they'll be noticeable during the interception. We'll choose "admin" for the username. After clicking the _Login_ button, Burp Suite intercepts our request in the _Proxy_ tab.

navigate to the URL above and try to login with `admin:admin` to generate a post request
![[Pasted image 20240719213755.png]]
In `HTTP History` Send to intruder
![[Pasted image 20240719213734.png]]
Clicking on the _Intruder_ tab, we'll discover that Burp Suite has configured the request for a brute forcing type of attack, as shown below.

When you click `AUTO` Intruder has fillsalmost all input sources (with the exception of headers) and wrapped them in the section sign (§) character. Any wordlist payload we select will be inserted between these characters.
![[Pasted image 20240719220212.png]]
If we want to quickly clear all of the section sign characters at once and specify that we are only interested in one or two parameters, we can simply click _Clear §_ on the right-hand side. Once cleared, we can highlight the area we want and click _Add §_. This will place two payload position characters over and around our highlighted area.

Let's practice by targeting the _pwd_ parameter to attempt brute forcing the _admin_ account. Note that the _pwd_ parameter can be empty for the purposes of this lesson.

The type of Intruder attack we are carrying out in this section is known as a [_Sniper_](https://portswigger.net/burp/documentation/desktop/tools/intruder/configure-attack/attack-types) attack.

This is the first and default option selected when performing an Intruder attack. A sniper attack will place our wordlist payloads between the § characters. For example, if the wordlist contained the word "offsecSniper" and we were to start the attack, Burp Suite would place the word "offsecSniper" between the §§ characters.
![[Pasted image 20240719220532.png]]

The second type of Intruder attack type is known as the [_Battering Ram_](https://portswigger.net/burp/documentation/desktop/tools/intruder/configure-attack/attack-types). In our current example, we're just brute forcing the password (_pwd_) parameter. However, suppose that we also wanted to attempt to brute force the username or _log_ parameter as well but with the same wordlist. In that case, we would just place an additional set of § characters into the _log_ parameter, such as in the listing below, and start the attack. Both parameters would be tested with the same wordlist, and the same values would be used for both positions.

Uses 1 word list to ram two seperate fields = `Battering Ram` Attack
![[Pasted image 20240719220905.png]]

Thirdly, we have the [_Pitchfork_](https://portswigger.net/burp/documentation/desktop/tools/intruder/configure-attack/attack-types) attack option. This attack option is actually just like what we're currently doing by brute forcing the password field with a Sniper attack. However, a Sniper attack only uses a single payload wordlist and usually expects only a single position. The pitchfork attack option will allow us to test multiple parameters by providing separate wordlists or payload lists for each position. In other words, we could have a wordlist for the username and a separate wordlist for the password parameter.

The last attack option is known as a [_Cluster Bomb_](https://portswigger.net/burp/documentation/desktop/tools/intruder/configure-attack/attack-types) attack. Much like a Pitchfork attack, this payload option uses multiple payload wordlists to test multiple parameters. However, the core difference is that a Cluster Bomb attack will iterate through each of our wordlists for each of our testing parameters. In other words, we ensure that all tested parameters get the same treatment as far as a wordlist or payload list is concerned. Naturally, this will generate an exponential number of attack requests and network traffic due to each wordlist getting the same treatment. However, a Cluster Bomb attack ensures that all test positions are iterated through.

Back to Sniper Demonstration:

With our testing position well defined in the _pwd_ parameter shown in the previous figure, we're ready to select our payload wordlist. Let's click on the _Payloads_ tab.
![[Pasted image 20240719224004.png]]
![[Pasted image 20240719224055.png]]

We will create a file in our user's home directory called **wordlist-test.txt**.
```bash
echo -e 'somepassword \nthispasswordwontwork \nhackerelite9000 \nroses \nblueblue \ncolor \ngreengreen \npassword \nadmin \nroot \ntoor' > wordlist-test.txt
```

![[Pasted image 20240719224144.png]]
Now in the `Payloads` tab load the `wordlist-test.txt`
![[Pasted image 20240719224259.png]]
Start Attack
![[Pasted image 20240719224406.png]]
the error code `302` and differing size of `1226` indicates a positive password of `password` with the username `admin`
![[Pasted image 20240719224608.png]]
Proof that I was able to login
![[Pasted image 20240719224755.png]]

Before we conclude, let's discuss another brief example. This time, we'll be creating a wordlist that contains the numbers 1-10 and using it to discover which users are present on the target WordPress machine.
```bash
echo -e '0 \n1 \n2 \n3 \n4 \n5 \n6 \n7 \n8 \n9 \n10' > wordlist-numbers-test.txt
```
![[Pasted image 20240719230451.png]]


With the wordlist called **wordlist-numbers-test.txt** created and in our Kali home directory, we're ready to move forward. Similar to the work we did in the Repeater section of this Learning Unit, we will be targeting the _?author=_ parameter. Therefore, let's turn on the _Intercept_ functionality within Burp Suite and browse to `http://offsecwp/?author=1`. Upon doing so, we will be presented with the following GET request inside of Burp Suite.
![[Pasted image 20240719231056.png]]
send to intruder
![[Pasted image 20240719231128.png]]
put the `§§` in the author field
![[Pasted image 20240719231207.png]]
add the `wordlist-numbers-test.txt` payload
![[Pasted image 20240719231318.png]]
start attack
Here are the results from the `Response` : The server responded with four "200 OK" responses.

Admin User
![[Pasted image 20240719231454.png]]
Jerry User
![[Pasted image 20240719231530.png]]
Samantha User
![[Pasted image 20240719231604.png]]

--------------------------------------------------

#### 3.3.4 Decoder

When performing assessments, we might come across resources in an application that are [_encoded_](https://dev.to/favr/the-hitchhikers-guide-to-byte-to-text-encoding-2cm4). Reasons for encoding data are to prevent it from appearing in plain text format and also to compress the size of the information being sent. Specifically, we'll be working with _Binary-to-Text_ encoding.

These types of encodings are also commonly referred to as _ASCII Armor_, especially when working with [_base64_](https://base64.guru/).

Above, we have an input box that will take an encoded string. Next to it, located on the right side, is a set of options for both decoding, encoding, and hashing of strings.

We're going to need a test string to continue working with the Decoder.

```bash
V2VfUmVhbGx5X0RvX0xvdmVfQnVycF9TdWl0ZQo=
```
Copy & Paste in the encoder into the `Decoder`, select `base64`
![[Pasted image 20240719233144.png]]


##### Labs
![[Pasted image 20240719234031.png]]

Flag found at `http://offsecwp/?p=10` 
Throw the `base64` into the `Decoder`  
`T1N7b2Zmc2VjX2xlYWRzX3RoZV93YXl9Cg==`
![[Pasted image 20240719233839.png]]
Decode as `base64`
![[Pasted image 20240719233944.png]]
