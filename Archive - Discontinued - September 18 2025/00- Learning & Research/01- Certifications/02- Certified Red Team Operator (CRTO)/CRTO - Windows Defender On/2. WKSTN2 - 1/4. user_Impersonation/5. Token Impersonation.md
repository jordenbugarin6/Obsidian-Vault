`steal_token` was previously used in [[3. Passing the Ticket]] however if we already have `SYSTEM` we can simply run a `ps` to list processes identify who owns a process and `steal_token` of the process

- This technique works by obtaining a handle to the target process, opening and duplicating its primary access token, and then impersonating that token.  The downside is that if the user closes the process, our ability to abuse it goes away.  By taking the additional steps of extracting tickets or hashes, we provide ourselves a more guaranteed or "future-proof" way of leveraging the credential material.

`ps` to list the processes
- identify `mmc.exe` with a PID of 760
![[Pasted image 20231128142113.png]]
`steal_token 760` to become the owner of the process
![[Pasted image 20231128142203.png]]