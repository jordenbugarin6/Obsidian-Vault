## ADSearch
Used to search for all AD Users
```powershell
beacon> execute-assembly C:\Tools\ADSearch\ADSearch\bin\Release\ADSearch.exe --search "objectCategory=user"
```
![[Pasted image 20230828125022.png]]
Used to grab domain group names with the word Admin in it.
```powershell
execute-assembly C:\Tools\ADSearch\ADSearch\bin\Release\ADSearch.exe --search "(&(objectCategory=group)(cn=*Admins))"
```
![[Pasted image 20230828125354.png]]
## Powerview.ps1
Must import PowerView.ps1 before using cmdlets.
```powershell
beacon> powershell-import C:\Tools\PowerSploit\Recon\PowerView.ps1

 powershell-import C:\Tools\PowerSploit\Recon\PowerView.ps1
```
## Get-Domain
```powershell
powershell Get-Domain
powershell-import /usr/share/windows-resources/powersploit/Recon/PowerView.ps1
```
![[Pasted image 20230828130315.png]]
## Get-DomainController
Returns the domain controllers for the current or specified domain.
```powershell
beacon> powershell Get-DomainController | select Forest, Name, OSVersion | fl
```
![[Pasted image 20230828130826.png]]
## Get-ForestDomain
Shows all forests
```powershell
beacon> powershell Get-ForestDomain
```
![[Pasted image 20230828131452.png]]
## Get-DomainUser
Shows User Information - Shows that jking is apart of support engineers
```powershell
beacon> powershell Get-DomainUser -Identity jking -Properties DisplayName, MemberOf | fl
```
![[Pasted image 20230828132026.png]]
## Get-DomainComputer
Shows all computers in domain.
```powershell
beacon> powershell Get-DomainComputer -Properties DnsHostName | sort -Property DnsHostName
```
![[Pasted image 20230828132442.png]]
## Get-DomainOU
Search for all organization units (OUs) or specific OU objects.
```powershell
beacon> powershell Get-DomainOU -Properties Name | sort -Property Name
```
![[Pasted image 20230828132644.png]]
## Get-DomainGroup
Return all domain groups or specific domain group objects.
```
beacon> powershell Get-DomainGroup | where Name -like "*Admins*" | select SamAccountName
```
![[Pasted image 20230828133228.png]]
## Get-DomainGroupMember
Shows that Nina Lamb is a Domain Administrator
```powershell
powershell Get-DomainGroupMember -Identity "Domain Admins" | select MemberDistinguishedName
```
![[Pasted image 20230828133526.png]]
## Get-DomainGPO
Return all Group Policy Objects (GPOs) or specific GPO objects. To enumerate all GPOs that are applied to a particular machine, useÂ `-ComputerIdentity`.
```powershell
beacon> powershell Get-DomainGPO -Properties DisplayName | sort -Property DisplayName -ComputerIdentity
```

![[Pasted image 20230828133608.png]]
## Get-DomainGPOLocalGroup
Displays Local GPO's
```powershell
powershell Get-DomainGPOLocalGroup | select GPODisplayName, GroupName
```
![[Pasted image 20230828133827.png]]

## Get-DomainGPOUserLocalGroupMapping
SHows the admins of web/sql-2/fs/wkstn-1/wkstn-2 are in the Support Engineers Object.
Jking is apart of Support Engineers meaning he is a local adminisrator on everyone in this group
```powershell
powershell Get-DomainGPOUserLocalGroupMapping -LocalGroup Administrators | select ObjectName, GPODisplayName, ContainerName, ComputerName | fl
```

![[Pasted image 20230828134354.png]]
## Get-DomainTrust
Shows that within the forest of dev.cyberbotic.io trust is bi-directional so anything in the forest can talk to anything.
```powershell
beacon> powershell Get-DomainTrust
```


```powershell
powershell-import ~/offshore/ms01/powerview.ps1
```