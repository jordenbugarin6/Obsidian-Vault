

In this section we will describe a possible captive portal attack. We will split it in a few phases.

First, we will need to learn about the target AP. This includes the channel, encryption, clients, etc. While not absolutely necessary, if the network is WPA-PSK or WPA2-PSK, we should capture a handshake as well.

Second, we will need to prepare a captive portal. If the target network contains an existing portal, we can usually copy it, but will need to make sure we have all the resources locally. If there is no existing portal, as will be the case in the example we explore, we will create a convincing one. In the latter case, and if the network is PSK, we could even verify the handshake we got earlier with the provided credentials.

Finally, we will configure and create our rogue AP and run any necessary tools to help clients discover the captive portal, or try to force them to connect to us, which should allow us to capture user credentials.

Note that when this happens, the credentials will be sent in clear text. We need to be careful in this situation, and always consider the possibility that someone is eavesdropping on the traffic. To that end, Opportunistic Wireless Encryption (OWE), also sometimes called Enhanced Open, can encrypt the connection without requiring a passphrase. This would ensure that credentials sent to us are safe from interception, and while not _all_ devices support it, most modern operating systems do.