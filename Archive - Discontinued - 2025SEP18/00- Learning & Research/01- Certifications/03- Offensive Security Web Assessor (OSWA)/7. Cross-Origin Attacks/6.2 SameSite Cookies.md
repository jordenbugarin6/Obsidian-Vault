
This Learning Unit covers the following Learning Objectives:

1. Understand the concept of cross-origin requests
2. Understand the SameSite attribute and its three possible settings

Google Chrome was the first browser to support the _SameSite_[1](https://portal.offsec.com/courses/web-200-28380/learning/cross-origin-attacks-30961/samesite-cookies-31306/samesite-cookies-31399#fn-local_id_236-1) attribute when it was first introduced in 2016, but all major browsers now support it. This attribute instructs browsers on how to handle a cookie on cross-site, or cross-origin, requests. A cross-site request occurs when one site initiates a request to a different site. For example, if `megacorpone.com` were to load an image from kali.org, a browser would consider the request cross-site.

There are three valid settings for this attribute. The first setting is _None_. This instructs the browser to send the cookie on any relevant request, regardless of where or how that request originated. Some browsers will block a cookie with _SameSite=None_ if the _Secure_ flag is not also set.

The second setting is _Lax_. This value instructs the browser not to send the cookie on cross-site requests. However, the browser will send the cookie during navigation when a user manually enters the URL in the browser or clicks a link to the site.

The final setting is _Strict_. When this value is set, a browser will only include the cookie if the domain originating the request is the same as the cookie's domain. The key difference from _Lax_ is that browsers do not send _Strict_ cookies when following links from other domains.

If a web application does not set the _SameSite_ flag on a cookie, it is up to the browser to determine how to handle the cookie. Google Chrome treats any cookie without a valid _SameSite_ attribute as _SameSite=Lax_. While other browsers have indicated they will eventually follow suit, they have not done so yet.

---------------
(Mozilla, 2021), [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite) [↩︎](https://portal.offsec.com/courses/web-200-28380/learning/cross-origin-attacks-30961/samesite-cookies-31306/samesite-cookies-31399#fnref-local_id_236-1)


- To **prevent CSRF**, use either:
    - **`SameSite=Lax`** (recommended for most cases), or
    - **`SameSite=Strict`** (if no cross-site behavior is required).
- **Do not use `SameSite=None`** unless cross-origin functionality is explicitly needed (e.g., third-party login). In such cases, implement additional CSRF protection measures like tokens.